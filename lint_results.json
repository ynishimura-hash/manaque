[{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/admin/management/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":40,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1439,1442],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1439,1442],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":52,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":52,"endColumn":27},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":98,"column":45,"nodeType":"JSXOpeningElement","endLine":98,"endColumn":125},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":229,"column":29,"nodeType":"JSXOpeningElement","endLine":229,"endColumn":109}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState, Suspense } from 'react';\nimport { useAppStore } from '@/lib/appStore';\nimport {\n    Building2, Briefcase, GraduationCap,\n    Search, Edit3, Trash2, Eye,\n    Plus, ChevronLeft, Upload\n} from 'lucide-react';\nimport Link from 'next/link';\nimport { useSearchParams, useRouter } from 'next/navigation';\nimport { toast } from 'sonner';\n\nfunction AdminManagementContent() {\n    const searchParams = useSearchParams();\n    const router = useRouter();\n    const currentTab = searchParams.get('tab') || 'companies';\n    const { companies, jobs, activeRole, courses, fetchCourses, addCourses } = useAppStore();\n    const [searchQuery, setSearchQuery] = useState('');\n    const fileInputRef = React.useRef<HTMLInputElement>(null);\n\n    React.useEffect(() => {\n        if (courses.length === 0) {\n            fetchCourses();\n        }\n    }, [courses.length, fetchCourses]);\n\n    const handleCsvUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n        const file = event.target.files?.[0];\n        if (!file) return;\n\n        const reader = new FileReader();\n        reader.onload = async (e) => {\n            const text = e.target?.result as string;\n            const rows = text.split('\\n').filter(row => row.trim());\n            const headers = rows[0].split(',');\n\n            const data = rows.slice(1).map(row => {\n                const values = row.split(',');\n                const obj: any = {};\n                headers.forEach((header, i) => {\n                    const cleanHeader = header.trim().replace(/\"/g, '');\n                    const cleanValue = values[i]?.trim().replace(/\"/g, '');\n                    obj[cleanHeader] = cleanValue;\n                });\n                return obj;\n            });\n\n            try {\n                await addCourses(data);\n                toast.success(`${data.length}件のコースを登録しました`);\n            } catch (error) {\n                toast.error('登録に失敗しました');\n            }\n        };\n        reader.readAsText(file);\n    };\n\n    if (activeRole !== 'admin') {\n        return <div className=\"p-10 text-center font-black\">Authentication Required</div>;\n    }\n\n    const renderCompanies = () => (\n        <div className=\"space-y-4\">\n            <div className=\"flex items-center justify-between mb-6\">\n                <h2 className=\"text-2xl font-black text-slate-900\">企業管理一覧</h2>\n                <button className=\"bg-blue-600 text-white px-6 py-3 rounded-2xl font-black text-sm flex items-center gap-2 hover:bg-blue-500 transition-all\">\n                    <Plus size={18} /> 新規企業登録\n                </button>\n            </div>\n            <div className=\"mb-6 bg-white p-4 rounded-2xl border border-slate-200 flex items-center gap-3\">\n                <Search size={20} className=\"text-slate-400\" />\n                <input\n                    type=\"text\"\n                    placeholder=\"企業名または業界で検索...\"\n                    value={searchQuery}\n                    onChange={(e) => setSearchQuery(e.target.value)}\n                    className=\"flex-1 bg-transparent border-none outline-none font-bold text-sm\"\n                />\n            </div>\n            <div className=\"bg-white rounded-[2rem] border border-slate-200 overflow-hidden shadow-sm\">\n                <table className=\"w-full text-left border-collapse\">\n                    <thead className=\"bg-slate-50 border-b border-slate-200\">\n                        <tr>\n                            <th className=\"px-6 py-4 text-xs font-black text-slate-400 uppercase tracking-widest\">企業名</th>\n                            <th className=\"px-6 py-4 text-xs font-black text-slate-400 uppercase tracking-widest\">業界</th>\n                            <th className=\"px-6 py-4 text-xs font-black text-slate-400 uppercase tracking-widest\">ステータス</th>\n                            <th className=\"px-6 py-4 text-xs font-black text-slate-400 uppercase tracking-widest text-right\">アクション</th>\n                        </tr>\n                    </thead>\n                    <tbody className=\"divide-y divide-slate-100\">\n                        {companies\n                            .filter(c => c.name.toLowerCase().includes(searchQuery.toLowerCase()) || c.industry.toLowerCase().includes(searchQuery.toLowerCase()))\n                            .map(company => (\n                                <tr key={company.id} className=\"hover:bg-slate-50 transition-colors\">\n                                    <td className=\"px-6 py-4\">\n                                        <div className=\"flex items-center gap-3\">\n                                            <img src={company.image} className=\"w-10 h-10 rounded-xl object-cover\" alt=\"\" />\n                                            <span className=\"font-black text-slate-800\">{company.name}</span>\n                                        </div>\n                                    </td>\n                                    <td className=\"px-6 py-4 text-sm font-bold text-slate-500\">{company.industry}</td>\n                                    <td className=\"px-6 py-4\">\n                                        <span className=\"bg-emerald-50 text-emerald-600 px-3 py-1 rounded-full text-[10px] font-black border border-emerald-100\">\n                                            Active\n                                        </span>\n                                    </td>\n                                    <td className=\"px-6 py-4 text-right\">\n                                        <div className=\"flex items-center justify-end gap-2\">\n                                            <button\n                                                onClick={() => toast.info(`${company.name}の情報を編集します（モック）`)}\n                                                className=\"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all\"\n                                            >\n                                                <Edit3 size={18} />\n                                            </button>\n                                            <button\n                                                onClick={() => toast.error(`${company.name}を削除してよろしいですか？`)}\n                                                className=\"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all\"\n                                            >\n                                                <Trash2 size={18} />\n                                            </button>\n                                        </div>\n                                    </td>\n                                </tr>\n                            ))}\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    );\n\n    const renderJobs = () => (\n        <div className=\"space-y-4\">\n            <div className=\"flex items-center justify-between mb-6\">\n                <h2 className=\"text-2xl font-black text-slate-900\">求人・クエスト管理</h2>\n                <div className=\"flex gap-2\">\n                    <button className=\"bg-slate-100 text-slate-600 px-6 py-3 rounded-2xl font-black text-sm hover:bg-slate-200 transition-all\">一括公開停止</button>\n                    <button className=\"bg-blue-600 text-white px-6 py-3 rounded-2xl font-black text-sm flex items-center gap-2 hover:bg-blue-500 transition-all\">\n                        <Plus size={18} /> 新規追加\n                    </button>\n                </div>\n            </div>\n            <div className=\"mb-6 bg-white p-4 rounded-2xl border border-slate-200 flex items-center gap-3\">\n                <Search size={20} className=\"text-slate-400\" />\n                <input\n                    type=\"text\"\n                    placeholder=\"求人タイトルまたは企業名で検索...\"\n                    value={searchQuery}\n                    onChange={(e) => setSearchQuery(e.target.value)}\n                    className=\"flex-1 bg-transparent border-none outline-none font-bold text-sm\"\n                />\n            </div>\n            <div className=\"bg-white rounded-[2rem] border border-slate-200 overflow-hidden shadow-sm\">\n                <table className=\"w-full text-left border-collapse\">\n                    <thead className=\"bg-slate-50 border-b border-slate-200\">\n                        <tr>\n                            <th className=\"px-6 py-4 text-xs font-black text-slate-400 uppercase tracking-widest\">求人タイトル</th>\n                            <th className=\"px-6 py-4 text-xs font-black text-slate-400 uppercase tracking-widest\">タイプ</th>\n                            <th className=\"px-6 py-4 text-xs font-black text-slate-400 uppercase tracking-widest\">企業</th>\n                            <th className=\"px-6 py-4 text-xs font-black text-slate-400 uppercase tracking-widest text-right\">操作</th>\n                        </tr>\n                    </thead>\n                    <tbody className=\"divide-y divide-slate-100\">\n                        {jobs\n                            .filter(j =>\n                                j.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\n                                companies.find(c => c.id === j.companyId)?.name.toLowerCase().includes(searchQuery.toLowerCase())\n                            )\n                            .map(job => (\n                                <tr key={job.id} className=\"hover:bg-slate-50 transition-colors\">\n                                    <td className=\"px-6 py-4 font-black text-slate-800\">{job.title}</td>\n                                    <td className=\"px-6 py-4\">\n                                        <span className={`px-2 py-0.5 rounded text-[10px] font-black ${job.type === 'quest' ? 'bg-purple-100 text-purple-600' : 'bg-blue-100 text-blue-600'}`}>\n                                            {job.type.toUpperCase()}\n                                        </span>\n                                    </td>\n                                    <td className=\"px-6 py-4 text-sm font-bold text-slate-500\">{companies.find(c => c.id === job.companyId)?.name}</td>\n                                    <td className=\"px-6 py-4 text-right\">\n                                        <div className=\"flex items-center justify-end gap-2 text-slate-400\">\n                                            <button className=\"p-2 hover:text-blue-600\"><Eye size={18} /></button>\n                                        </div>\n                                    </td>\n                                </tr>\n                            ))}\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    );\n\n    const renderLearning = () => (\n        <div className=\"space-y-4\">\n            <div className=\"flex items-center justify-between mb-6\">\n                <h2 className=\"text-2xl font-black text-slate-900\">eラーニング・コース管理</h2>\n                <div className=\"flex gap-2\">\n                    <input\n                        type=\"file\"\n                        accept=\".csv\"\n                        className=\"hidden\"\n                        ref={fileInputRef}\n                        onChange={handleCsvUpload}\n                    />\n                    <button\n                        onClick={() => fileInputRef.current?.click()}\n                        className=\"bg-slate-100 text-slate-600 px-6 py-3 rounded-2xl font-black text-sm flex items-center gap-2 hover:bg-slate-200 transition-all\"\n                    >\n                        <Upload size={18} /> CSVから一括登録\n                    </button>\n                    <button className=\"bg-blue-600 text-white px-6 py-3 rounded-2xl font-black text-sm flex items-center gap-2 hover:bg-blue-500 transition-all\">\n                        <Plus size={18} /> 新規追加\n                    </button>\n                </div>\n            </div>\n            <div className=\"mb-8 bg-white p-4 rounded-2xl border border-slate-200 flex items-center gap-3\">\n                <Search size={20} className=\"text-slate-400\" />\n                <input\n                    type=\"text\"\n                    placeholder=\"コース名またはカテゴリーで検索...\"\n                    value={searchQuery}\n                    onChange={(e) => setSearchQuery(e.target.value)}\n                    className=\"flex-1 bg-transparent border-none outline-none font-bold text-sm\"\n                />\n            </div>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                {courses\n                    .filter(c => c.title.toLowerCase().includes(searchQuery.toLowerCase()) || c.category.toLowerCase().includes(searchQuery.toLowerCase()))\n                    .map(course => (\n                        <div key={course.id} className=\"bg-white p-6 rounded-[2.5rem] border border-slate-200 shadow-sm flex items-start gap-4\">\n                            <img src={course.image} className=\"w-24 h-24 rounded-3xl object-cover\" alt=\"\" />\n                            <div className=\"flex-1\">\n                                <h3 className=\"font-black text-slate-800 leading-tight\">{course.title}</h3>\n                                <p className=\"text-xs text-slate-400 font-bold mt-1\">{course.category} | {course.level}</p>\n                                <div className=\"flex items-center gap-4 mt-4\">\n                                    <button className=\"text-xs font-black text-blue-600 flex items-center gap-1 hover:underline\">\n                                        <Edit3 size={12} /> 編集\n                                    </button>\n                                    <button className=\"text-xs font-black text-slate-400 flex items-center gap-1 hover:underline\">\n                                        <Eye size={12} /> プレビュー\n                                    </button>\n                                </div>\n                            </div>\n                        </div>\n                    ))}\n            </div>\n        </div>\n    );\n\n    return (\n        <div className=\"min-h-screen bg-slate-50\">\n            <div className=\"max-w-7xl mx-auto px-6 py-10\">\n                <Link href=\"/admin\" className=\"inline-flex items-center gap-2 text-slate-400 hover:text-slate-900 font-black text-sm mb-8 transition-colors group\">\n                    <ChevronLeft size={18} className=\"group-hover:-translate-x-1 transition-transform\" /> Dashboardに戻る\n                </Link>\n\n                <main className=\"space-y-10\">\n                    <div className=\"flex gap-1 bg-slate-200 p-1.5 rounded-[2rem] self-start inline-flex\">\n                        <button\n                            onClick={() => router.push('?tab=companies')}\n                            className={`px-8 py-3.5 rounded-3xl text-sm font-black transition-all ${currentTab === 'companies' ? 'bg-white text-slate-900 shadow-lg' : 'text-slate-500 hover:bg-white/50'}`}\n                        >\n                            <Building2 size={16} className=\"inline mr-2\" /> 企業管理\n                        </button>\n                        <button\n                            onClick={() => router.push('?tab=jobs')}\n                            className={`px-8 py-3.5 rounded-3xl text-sm font-black transition-all ${currentTab === 'jobs' ? 'bg-white text-slate-900 shadow-lg' : 'text-slate-500 hover:bg-white/50'}`}\n                        >\n                            <Briefcase size={16} className=\"inline mr-2\" /> 求人・クエスト\n                        </button>\n                        <button\n                            onClick={() => router.push('?tab=learning')}\n                            className={`px-8 py-3.5 rounded-3xl text-sm font-black transition-all ${currentTab === 'learning' ? 'bg-white text-slate-900 shadow-lg' : 'text-slate-500 hover:bg-white/50'}`}\n                        >\n                            <GraduationCap size={16} className=\"inline mr-2\" /> Eラーニング\n                        </button>\n                    </div>\n\n                    <div className=\"animate-in fade-in slide-in-from-bottom-2 duration-500\">\n                        {currentTab === 'companies' && renderCompanies()}\n                        {currentTab === 'jobs' && renderJobs()}\n                        {currentTab === 'learning' && renderLearning()}\n                    </div>\n                </main>\n            </div>\n        </div>\n    );\n}\n\nexport default function AdminManagementPage() {\n    return (\n        <Suspense fallback={<div className=\"p-10 text-center font-black\">Loading...</div>}>\n            <AdminManagementContent />\n        </Suspense>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/admin/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/analysis/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowRight' is defined but never used.","line":7,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":22,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowRight"},"fix":{"range":[125,137],"text":""},"desc":"Remove unused variable \"ArrowRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Course' is defined but never used.","line":11,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":16,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Course"},"fix":{"range":[233,240],"text":""},"desc":"Remove unused variable \"Course\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Job' is defined but never used.","line":11,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":21,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Job"},"fix":{"range":[239,244],"text":""},"desc":"Remove unused variable \"Job\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Company' is defined but never used.","line":11,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":30,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Company"},"fix":{"range":[224,279],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState } from 'react';\nimport {\n    Sparkles, ArrowLeft,\n    Zap, Compass, Trophy,\n    Clock, ArrowRight, BookOpen,\n    MapPin, Building2\n} from 'lucide-react';\nimport Link from 'next/link';\nimport { Course, Job, Company } from '@/lib/dummyData';\nimport { useAppStore } from '@/lib/appStore';\nimport { getRecommendations } from '@/lib/recommendation';\nimport StrengthsDiscovery from '@/components/analysis/StrengthsDiscovery';\nimport FortuneAnalysis from '@/components/analysis/FortuneAnalysis';\n\nexport default function AnalysisPage() {\n    const { userAnalysis, jobs, courses, companies, fetchCourses } = useAppStore();\n    const [activeTab, setActiveTab] = useState<'strengths' | 'fortune'>('strengths');\n\n    React.useEffect(() => {\n        if (courses.length === 0) {\n            fetchCourses();\n        }\n    }, [courses.length, fetchCourses]);\n\n    const recommendations = getRecommendations(userAnalysis, jobs, courses, companies);\n    const hasAnalysis = userAnalysis.strengths || userAnalysis.fortune;\n\n    return (\n        <div className=\"min-h-screen bg-slate-50 pb-20\">\n            {/* Header */}\n            <div className=\"bg-white border-b border-slate-200 sticky top-0 z-30\">\n                <div className=\"max-w-4xl mx-auto px-6 py-6 flex items-center justify-between\">\n                    <Link href=\"/mypage\" className=\"flex items-center gap-2 text-slate-400 hover:text-slate-900 font-black text-sm transition-colors group\">\n                        <ArrowLeft size={18} className=\"group-hover:-translate-x-1 transition-transform\" /> マイページへ戻る\n                    </Link>\n                    <div className=\"flex items-center gap-2 bg-blue-50 text-blue-600 px-4 py-1.5 rounded-full text-[10px] font-black uppercase tracking-widest border border-blue-100\">\n                        <Sparkles size={14} /> Self Analysis Portal\n                    </div>\n                </div>\n            </div>\n\n            <main className=\"max-w-4xl mx-auto px-6 py-12 space-y-12\">\n                <div className=\"text-center space-y-4\">\n                    <h1 className=\"text-4xl md:text-5xl font-black text-slate-900 tracking-tight\">自己分析・資質診断</h1>\n                    <p className=\"text-slate-500 font-bold text-lg max-w-2xl mx-auto\">\n                        あなたの「強み」と「資質」を可視化し、<br className=\"hidden md:block\" />\n                        愛媛でのキャリアをより輝かせるためのヒントを見つけましょう。\n                    </p>\n                </div>\n\n                {/* Tab Switcher */}\n                <div className=\"flex p-1.5 bg-slate-200 rounded-[2rem] max-w-md mx-auto\">\n                    <button\n                        onClick={() => setActiveTab('strengths')}\n                        className={`flex-1 flex items-center justify-center gap-2 py-4 rounded-[1.8rem] text-sm font-black transition-all ${activeTab === 'strengths' ? 'bg-white text-slate-900 shadow-xl' : 'text-slate-500 hover:bg-white/50'}`}\n                    >\n                        <Zap size={18} /> 強み・魅力\n                    </button>\n                    <button\n                        onClick={() => setActiveTab('fortune')}\n                        className={`flex-1 flex items-center justify-center gap-2 py-4 rounded-[1.8rem] text-sm font-black transition-all ${activeTab === 'fortune' ? 'bg-white text-slate-900 shadow-xl' : 'text-slate-500 hover:bg-white/50'}`}\n                    >\n                        <Compass size={18} /> 本質・資質\n                    </button>\n                </div>\n\n                {/* Content Area */}\n                <div className=\"animate-in fade-in slide-in-from-bottom-5 duration-700\">\n                    {activeTab === 'strengths' ? <StrengthsDiscovery /> : <FortuneAnalysis />}\n                </div>\n\n                {/* Recommendation Teaser Section (Always visible for design consistency) */}\n                <div className=\"bg-slate-900 rounded-[3rem] p-10 md:p-16 relative overflow-hidden text-white shadow-2xl\">\n                    <div className=\"absolute right-[-5%] bottom-[-5%] text-white/5 rotate-12\">\n                        <Trophy size={300} />\n                    </div>\n                    <div className=\"relative z-10 max-w-xl\">\n                        <h2 className=\"text-3xl font-black mb-6 leading-tight\">\n                            診断結果から、<br /><span className=\"text-blue-400\">あなたにぴったりのキャリア</span>をご提案。\n                        </h2>\n                        <p className=\"text-slate-400 font-bold text-lg mb-8 leading-relaxed\">\n                            {hasAnalysis\n                                ? \"現在の診断結果に基づいた、あなたにぴったりの求人やクエスト、e-ラーニング講座を以下にご提案します。\"\n                                : \"診断を完了すると、あなたの特性にマッチした求人やクエスト、e-ラーニング講座が自動的にレコメンドされるようになります。\"\n                            }\n                        </p>\n                        <div className=\"flex gap-4\">\n                            {hasAnalysis ? (\n                                <div className=\"bg-blue-600/20 px-8 py-4 rounded-3xl font-black border border-blue-500/30 flex items-center gap-2\">\n                                    <Sparkles size={20} className=\"text-blue-400\" /> AIおすすめマッチング発動中\n                                </div>\n                            ) : (\n                                <div className=\"bg-blue-600 px-8 py-4 rounded-3xl font-black shadow-lg shadow-blue-500/20 flex items-center gap-2 transition-all hover:scale-105\">\n                                    <Sparkles size={20} /> AIおすすめマッチング機能\n                                </div>\n                            )}\n                        </div>\n                    </div>\n                </div>\n\n                {/* Recommendations Section */}\n                {hasAnalysis && (\n                    <div className=\"space-y-8 animate-in fade-in slide-in-from-bottom-5 duration-1000 scroll-mt-20\" id=\"recommendations\">\n                        <div className=\"flex items-center gap-3\">\n                            <div className=\"bg-blue-600 text-white p-2 rounded-xl\">\n                                <Sparkles size={20} />\n                            </div>\n                            <h2 className=\"text-2xl font-black text-slate-900\">あなたへのオススメ</h2>\n                        </div>\n\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\n                            {/* Jobs */}\n                            <div className=\"space-y-4\">\n                                <h3 className=\"text-sm font-black text-slate-400 uppercase tracking-widest pl-2\">おすすめの求人・クエスト</h3>\n                                <div className=\"space-y-4\">\n                                    {recommendations.jobs.map(job => (\n                                        <Link key={job.id} href={`/jobs/${job.id}`} className=\"block bg-white p-6 rounded-3xl border border-slate-200 hover:shadow-lg transition-all group\">\n                                            <div className=\"flex items-center justify-between mb-2\">\n                                                <span className={`px-2 py-0.5 rounded text-[10px] font-black ${job.type === 'quest' ? 'bg-purple-100 text-purple-600' : 'bg-blue-100 text-blue-600'}`}>\n                                                    {job.type.toUpperCase()}\n                                                </span>\n                                                <div className=\"flex items-center gap-1 text-[10px] font-black text-slate-400\">\n                                                    <MapPin size={12} /> {job.location?.split(' ')[0] || '愛媛県'}\n                                                </div>\n                                            </div>\n                                            <h4 className=\"font-black text-slate-800 group-hover:text-blue-600 transition-colors\">{job.title}</h4>\n                                            <div className=\"flex items-center gap-2 mt-4 text-xs font-bold text-slate-400\">\n                                                <Building2 size={14} /> {companies.find(c => c.id === job.companyId)?.name}\n                                            </div>\n                                        </Link>\n                                    ))}\n                                </div>\n                            </div>\n\n                            {/* Courses */}\n                            <div className=\"space-y-4\">\n                                <h3 className=\"text-sm font-black text-slate-400 uppercase tracking-widest pl-2\">おすすめのeラーニング</h3>\n                                <div className=\"space-y-4\">\n                                    {recommendations.courses.map(course => (\n                                        <Link key={course.id} href={`/reskill/course/${course.id}`} className=\"block bg-white p-6 rounded-3xl border border-slate-200 hover:shadow-lg transition-all group\">\n                                            <div className=\"flex items-center justify-between mb-2\">\n                                                <span className=\"bg-blue-50 text-blue-600 px-2 py-0.5 rounded text-[10px] font-black border border-blue-100\">\n                                                    {course.category}\n                                                </span>\n                                                <div className=\"flex items-center gap-1 text-[10px] font-black text-slate-400\">\n                                                    <Clock size={12} /> {course.duration}\n                                                </div>\n                                            </div>\n                                            <h4 className=\"font-black text-slate-800 group-hover:text-blue-600 transition-colors\">{course.title}</h4>\n                                            <div className=\"flex items-center gap-2 mt-4 text-xs font-bold text-slate-400\">\n                                                <BookOpen size={14} /> {course.level}\n                                            </div>\n                                        </Link>\n                                    ))}\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                )}\n\n            </main>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/api/ai/company-profile/route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":46,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":46,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1998,2001],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1998,2001],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":113,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":113,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5058,5061],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5058,5061],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\n\nconst MODEL_NAME = 'gemini-2.0-flash-001';\n\nexport async function POST(req: Request) {\n    try {\n        const apiKey = process.env.GEMINI_API_KEY;\n        if (!apiKey) {\n            return NextResponse.json({ error: 'API Key not configured' }, { status: 500 });\n        }\n\n        const { input } = await req.json();\n\n        if (!input) {\n            return NextResponse.json({ error: 'Input is required' }, { status: 400 });\n        }\n\n        let contentToProcess = input;\n\n        // If input is a URL, fetch the content\n        if (input.startsWith('http://') || input.startsWith('https://')) {\n            try {\n                console.log('Fetching URL:', input);\n                const siteRes = await fetch(input, {\n                    headers: {\n                        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'\n                    }\n                });\n                if (!siteRes.ok) throw new Error(`Failed to fetch site: ${siteRes.statusText}`);\n                const html = await siteRes.text();\n\n                // HTML text extraction\n                // 1. Remove noise strings (scripts, styles, nav, header, footer)\n                let text = html.replace(/<script\\b[^>]*>([\\s\\S]*?)<\\/script>/gm, \"\")\n                    .replace(/<style\\b[^>]*>([\\s\\S]*?)<\\/style>/gm, \"\")\n                    .replace(/<header\\b[^>]*>([\\s\\S]*?)<\\/header>/gm, \"\")\n                    .replace(/<footer\\b[^>]*>([\\s\\S]*?)<\\/footer>/gm, \"\")\n                    .replace(/<nav\\b[^>]*>([\\s\\S]*?)<\\/nav>/gm, \"\");\n\n                // 2. Remove tags\n                text = text.replace(/<[^>]+>/g, \"\\n\");\n\n                // 3. Clean whitespace\n                contentToProcess = text.replace(/\\s+/g, \" \").trim().substring(0, 20000); // Limit context size\n                console.log('Extracted text length:', contentToProcess.length);\n            } catch (fetchError: any) {\n                console.error('URL Fetch Error:', fetchError);\n                return NextResponse.json({ error: `URL fetch failed: ${fetchError.message}` }, { status: 400 });\n            }\n        }\n\n        const prompt = `\n        You are an AI assistant that extracts company information from text and formats it into a valid JSON object.\n        SOURCE TEXT: \"${contentToProcess.substring(0, 10000)}...\"\n        \n        Please generate a JSON object matching this schema:\n        {\n            \"name\": \"string\",\n            \"industry\": \"string\",\n            \"location\": \"string (city/prefecture)\",\n            \"description\": \"string (short summary, max 100 chars)\",\n            \"foundingYear\": number (or null),\n            \"capital\": \"string (e.g. 1000万円) or null\",\n            \"employeeCount\": \"string (e.g. 50名) or null\",\n            \"representative\": \"string (CEO name) or null\",\n            \"address\": \"string (full address) or null\",\n            \"phone\": \"string or null\",\n            \"website\": \"string or null\",\n            \"businessDetails\": \"string (detailed business activities)\",\n            \"philosophy\": \"string (mission/vision) or null\",\n            \"benefits\": \"string (welfare/benefits summary) or null\",\n            \"rjpNegatives\": \"string (realistic job preview: potential negative aspects/challenges)\",\n            \"rjpPositives\": \"string (realistic job preview: rewarding aspects)\"\n        }\n\n        If specific values are not found in the source text, use reasonable inferences based on the company type or return null.\n        For RJP (Realistic Job Preview), generate honest comments about potential hardships based on the industry if not explicit in the text.\n        Return ONLY valid JSON.\n        `;\n\n        const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${MODEL_NAME}:generateContent?key=${apiKey}`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n                contents: [{ parts: [{ text: prompt }] }]\n            })\n        });\n\n        const data = await response.json();\n\n        if (data.error) {\n            console.error('Gemini API Error:', data.error);\n            if (data.error.code === 429 || data.error.message.includes('Quota')) {\n                throw new Error('AI service quota exceeded. Please try again later.');\n            }\n            throw new Error(data.error.message);\n        }\n\n        const textResult = data.candidates?.[0]?.content?.parts?.[0]?.text;\n        if (!textResult) throw new Error('No content generated');\n\n        // Clean markdown code blocks if present\n        const jsonStr = textResult.replace(/```json\\n?|\\n?```/g, '').trim();\n\n        try {\n            const profile = JSON.parse(jsonStr);\n            return NextResponse.json(profile);\n        } catch (e) {\n            console.error('JSON Parse Error:', e, jsonStr);\n            return NextResponse.json({ error: 'Failed to parse AI response' }, { status: 500 });\n        }\n\n    } catch (error: any) {\n        console.error('AI Generation Error:', error);\n        const status = error.message.includes('quota') || error.message.includes('Quota') ? 429 : 500;\n        return NextResponse.json({ error: error.message || 'Failed to generate profile' }, { status: status });\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/api/ai/job-generate/route.ts","messages":[{"ruleId":"prefer-const","severity":2,"message":"'geminiParts' is never reassigned. Use 'const' instead.","line":21,"column":13,"nodeType":"Identifier","messageId":"useConst","endLine":21,"endColumn":31,"fix":{"range":[697,725],"text":"const geminiParts: any[] = [];"}},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":21,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[714,717],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[714,717],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":66,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":66,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2868,2871],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2868,2871],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":126,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":126,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5376,5379],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5376,5379],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\n\nconst MODEL_NAME = 'gemini-2.0-flash-001';\n\nexport async function POST(req: Request) {\n    try {\n        const apiKey = process.env.GEMINI_API_KEY;\n        if (!apiKey) {\n            return NextResponse.json({ error: 'API Key not configured' }, { status: 500 });\n        }\n\n        const body = await req.json();\n        const { input, base64Data, mimeType } = body;\n\n        // Validation: Either input (URL/Text) or base64Data (File) is required\n        if (!input && !base64Data) {\n            return NextResponse.json({ error: 'Input text/URL or File is required' }, { status: 400 });\n        }\n\n        let contentToProcess = input || '';\n        let geminiParts: any[] = [];\n\n        // CASE 1: File Upload (PDF/Image)\n        if (base64Data && mimeType) {\n            geminiParts.push({\n                inline_data: {\n                    mime_type: mimeType,\n                    data: base64Data\n                }\n            });\n            console.log(`Processed uploaded file: ${mimeType}, Length: ${base64Data.length}`);\n        }\n        // CASE 2: URL Input\n        else if (input && (input.startsWith('http://') || input.startsWith('https://'))) {\n            try {\n                console.log('Fetching Job URL:', input);\n                const siteRes = await fetch(input, {\n                    headers: {\n                        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'\n                    }\n                });\n\n                if (!siteRes.ok) throw new Error(`Failed to fetch site: ${siteRes.statusText}`);\n\n                const contentType = siteRes.headers.get('content-type');\n\n                if (contentType && contentType.includes('application/pdf')) {\n                    const arrayBuffer = await siteRes.arrayBuffer();\n                    const base64 = Buffer.from(arrayBuffer).toString('base64');\n                    geminiParts.push({\n                        inline_data: {\n                            mime_type: 'application/pdf',\n                            data: base64\n                        }\n                    });\n                } else {\n                    const html = await siteRes.text();\n                    let text = html.replace(/<script\\b[^>]*>([\\s\\S]*?)<\\/script>/gm, \"\")\n                        .replace(/<style\\b[^>]*>([\\s\\S]*?)<\\/style>/gm, \"\")\n                        .replace(/<header\\b[^>]*>([\\s\\S]*?)<\\/header>/gm, \"\")\n                        .replace(/<footer\\b[^>]*>([\\s\\S]*?)<\\/footer>/gm, \"\")\n                        .replace(/<nav\\b[^>]*>([\\s\\S]*?)<\\/nav>/gm, \"\");\n                    text = text.replace(/<[^>]+>/g, \"\\n\");\n                    contentToProcess = text.replace(/\\s+/g, \" \").trim().substring(0, 20000);\n                }\n            } catch (fetchError: any) {\n                console.error('URL Fetch Error:', fetchError);\n                return NextResponse.json({ error: `URL fetch failed: ${fetchError.message}` }, { status: 400 });\n            }\n        }\n\n        const prompt = `\n        You are an HR specialist. Extract job posting details from the provided document (PDF or text) and format it into a valid JSON object.\n        ${!base64Data && geminiParts.length === 0 ? `SOURCE TEXT: \"${contentToProcess.substring(0, 15000)}...\"` : ''}\n\n        Please generate a JSON object matching this schema:\n        {\n            \"title\": \"string (attractive job title)\",\n            \"category\": \"string (choose from: 新卒, 中途, アルバイト, 体験JOB, インターンシップ)\",\n            \"description\": \"string (job summary and responsibilities)\",\n            \"requirements\": \"string (skills and experience required)\",\n            \"workingHours\": \"string\",\n            \"holidays\": \"string\",\n            \"welfare\": \"string (benefits)\",\n            \"selectionProcess\": \"string\",\n            \"reward\": \"string (salary range)\"\n        }\n\n        If specific values are not found, infer reasonable professional defaults based on the context.\n        Return ONLY valid JSON.\n        `;\n\n        geminiParts.push({ text: prompt });\n\n        const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${MODEL_NAME}:generateContent?key=${apiKey}`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n                contents: [{ parts: geminiParts }]\n            })\n        });\n\n        const data = await response.json();\n\n        if (data.error) {\n            console.error('Gemini API Error:', data.error);\n            if (data.error.code === 429 || data.error.message.includes('Quota')) {\n                throw new Error('AI service quota exceeded. Please try again later.');\n            }\n            throw new Error(data.error.message);\n        }\n\n        const textResult = data.candidates?.[0]?.content?.parts?.[0]?.text;\n        if (!textResult) throw new Error('No content generated');\n\n        const jsonStr = textResult.replace(/```json\\n?|\\n?```/g, '').trim();\n\n        try {\n            const result = JSON.parse(jsonStr);\n            return NextResponse.json(result);\n        } catch (e) {\n            console.error('JSON Parse Error:', e, jsonStr);\n            return NextResponse.json({ error: 'Failed to parse AI response' }, { status: 500 });\n        }\n\n    } catch (error: any) {\n        console.error('AI Generation Error:', error);\n        const status = error.message.includes('quota') || error.message.includes('Quota') ? 429 : 500;\n        return NextResponse.json({ error: error.message || 'Failed to generate job' }, { status: status });\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/api/elearning/route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":22,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[561,564],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[561,564],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":45,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1194,1197],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1194,1197],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":73,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":73,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2551,2554],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2551,2554],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\nimport fs from 'fs';\nimport path from 'path';\n\nconst DATA_PATH = path.join(process.cwd(), 'src/data/courses.json');\n\n// Helper to read data\nconst readData = () => {\n    try {\n        if (!fs.existsSync(DATA_PATH)) {\n            return [];\n        }\n        const fileContent = fs.readFileSync(DATA_PATH, 'utf8');\n        return JSON.parse(fileContent);\n    } catch (error) {\n        console.error('Error reading e-learning data:', error);\n        return [];\n    }\n};\n\n// Helper to write data\nconst writeData = (data: any) => {\n    try {\n        fs.writeFileSync(DATA_PATH, JSON.stringify(data, null, 2), 'utf8');\n    } catch (error) {\n        console.error('Error writing e-learning data:', error);\n    }\n};\n\nexport async function GET() {\n    const data = readData();\n    return NextResponse.json(data);\n}\n\nexport async function POST(request: Request) {\n    try {\n        const body = await request.json();\n        const currentData = readData();\n\n        // Handle both single and multiple registrations\n        const newItems = Array.isArray(body) ? body : [body];\n\n        const updatedData = [...currentData];\n\n        newItems.forEach((newItem: any) => {\n            // Basic validation and formatting\n            const course = {\n                id: newItem.id || `course_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n                title: newItem.title || '無題のコース',\n                description: newItem.description || '',\n                instructor: newItem.instructor || {\n                    name: '講師未設定',\n                    role: 'Expert',\n                    image: 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?auto=format&fit=facearea&facepad=2&w=256&h=256&q=80'\n                },\n                category: newItem.category || '未分類',\n                level: newItem.level || '初級',\n                duration: newItem.duration || '不明',\n                image: newItem.image || 'https://images.unsplash.com/photo-1454165833767-02486835bcd4?auto=format&fit=crop&q=80&w=800',\n                curriculums: newItem.curriculums || [\n                    {\n                        id: `curr_${Date.now()}`,\n                        courseId: '', // Will be set after\n                        title: '第1章',\n                        description: '',\n                        lessons: [],\n                        order: 1\n                    }\n                ]\n            };\n\n            // Set courseId in curriculums\n            course.curriculums = course.curriculums.map((c: any) => ({\n                ...c,\n                courseId: course.id\n            }));\n\n            updatedData.unshift(course);\n        });\n\n        writeData(updatedData);\n\n        return NextResponse.json({ success: true, count: newItems.length });\n    } catch (error) {\n        console.error('Error processing registration:', error);\n        return NextResponse.json({ success: false, error: 'Internal Server Error' }, { status: 500 });\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/companies/[id]/page.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":86,"column":25,"nodeType":"JSXOpeningElement","endLine":86,"endColumn":110}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { use, useState } from 'react';\nimport { JOBS, COMPANIES } from '@/lib/dummyData';\nimport { useAppStore } from '@/lib/appStore';\nimport {\n    MapPin,\n    ChevronLeft, ArrowRight, Zap, Info,\n    Share2, Heart, Lock\n} from 'lucide-react';\nimport Link from 'next/link';\nimport { toast } from 'sonner';\nimport { LoginPromptModal } from '@/components/auth/LoginPromptModal';\n\nexport default function CompanyDetailPage({ params }: { params: Promise<{ id: string }> }) {\n    const { id } = use(params);\n    const { authStatus, currentUserId, interactions, toggleInteraction } = useAppStore();\n    const company = COMPANIES.find(c => c.id === id);\n    const companyJobs = JOBS.filter(j => j.companyId === id);\n\n    const [isLoginModalOpen, setIsLoginModalOpen] = useState(false);\n    const [loginModalMessage, setLoginModalMessage] = useState('');\n\n    const isLiked = interactions.some(i => i.type === 'like_company' && i.fromId === currentUserId && i.toId === id);\n\n    const handleAction = (action: () => void, message: string) => {\n        if (authStatus !== 'authenticated') {\n            setLoginModalMessage(message);\n            setIsLoginModalOpen(true);\n            return;\n        }\n        action();\n    };\n\n    const toggleLike = () => {\n        toggleInteraction('like_company', currentUserId, id);\n        toast.success(isLiked ? '「気になる」を解除しました' : '企業を「気になる」リストに保存しました');\n    };\n\n    const handleShare = () => {\n        const url = window.location.href;\n        navigator.clipboard.writeText(url).then(() => {\n            toast.success('共有リンクをクリップボードにコピーしました');\n        }).catch(() => {\n            toast.error('リンクのコピーに失敗しました');\n        });\n    };\n\n    if (!company) {\n        return (\n            <div className=\"flex flex-col items-center justify-center min-h-[60vh] p-8 text-center\">\n                <h2 className=\"text-2xl font-bold text-zinc-800\">企業が見つかりませんでした</h2>\n                <Link href=\"/companies\" className=\"mt-4 text-blue-500 font-bold underline\">企業一覧に戻る</Link>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"min-h-screen bg-white md:bg-zinc-50\">\n            {/* Header */}\n            <nav className=\"sticky top-0 z-40 bg-white/80 backdrop-blur-md border-b border-zinc-100 flex items-center justify-between px-6 py-4 md:px-12\">\n                <Link href=\"/companies\" className=\"p-2 hover:bg-zinc-100 rounded-full transition-colors text-zinc-600\">\n                    <ChevronLeft size={24} />\n                </Link>\n                <span className=\"text-sm font-black text-zinc-800 uppercase tracking-tighter\">企業詳細</span>\n                <div className=\"flex items-center gap-2\">\n                    <button\n                        onClick={toggleLike}\n                        className={`p-2 rounded-full transition-colors ${isLiked ? 'bg-red-50 text-red-500' : 'hover:bg-zinc-100 text-zinc-400'}`}\n                    >\n                        <Heart size={20} fill={isLiked ? \"currentColor\" : \"none\"} />\n                    </button>\n                    <button\n                        onClick={handleShare}\n                        className=\"p-2 hover:bg-zinc-100 rounded-full transition-colors text-zinc-600\"\n                    >\n                        <Share2 size={20} />\n                    </button>\n                </div>\n            </nav>\n\n            <main className=\"max-w-5xl mx-auto md:py-12 md:px-6 space-y-12\">\n                {/* Profile Card */}\n                <section className=\"bg-white md:rounded-[3rem] md:shadow-2xl md:border border-zinc-50 overflow-hidden\">\n                    <div className=\"h-64 md:h-96 relative\">\n                        <img src={company.image} alt={company.name} className=\"w-full h-full object-cover\" />\n                        <div className=\"absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent\" />\n                        <div className=\"absolute bottom-10 left-10 text-white\">\n                            <div className=\"flex items-center gap-2 mb-2\">\n                                <span className={`w-4 h-4 rounded-full ${company.logoColor}`} />\n                                <span className=\"text-sm font-bold uppercase tracking-widest opacity-80\">{company.industry}</span>\n                            </div>\n                            <h2 className=\"text-4xl md:text-5xl font-black italic tracking-tight\">{company.name}</h2>\n                            <div className=\"flex items-center gap-2 mt-4 text-zinc-300 text-sm font-bold\">\n                                <MapPin size={16} />\n                                {company.location}\n                            </div>\n                        </div>\n                    </div>\n\n                    <div className=\"p-10 space-y-12\">\n                        {/* About Section */}\n                        <div className=\"max-w-3xl space-y-4\">\n                            <h3 className=\"text-2xl font-black text-zinc-800\">愛媛の土地で、私たちが目指すこと</h3>\n                            <p className=\"text-zinc-600 leading-relaxed font-medium\">\n                                {company.description}\n                                私たちは単なる企業ではなく、愛媛の未来を共に創る冒険者の集まりです。\n                                一歩踏み出すあなたの「歪み」を、私たちの組織はレバレッジ（力）に変える準備ができています。\n                            </p>\n                        </div>\n\n                        {/* RJP Section */}\n                        <div\n                            className={`bg-orange-50 border border-orange-100 rounded-[2.5rem] p-8 md:p-12 relative overflow-hidden transition-all ${authStatus !== 'authenticated' ? 'cursor-pointer hover:bg-orange-100' : ''}`}\n                            onClick={() => {\n                                if (authStatus !== 'authenticated') {\n                                    handleAction(() => { }, '企業の「本音（RJP）」を閲覧するにはログインが必要です。');\n                                }\n                            }}\n                        >\n                            <div className=\"absolute top-0 right-0 p-8 text-orange-200/50\">\n                                <Info size={120} strokeWidth={3} />\n                            </div>\n                            <div className=\"relative z-10 space-y-6\">\n                                <h3 className=\"text-2xl font-black text-orange-900 flex items-center gap-3\">\n                                    <Zap className=\"text-orange-500\" />\n                                    本音でお話しします（RJP）\n                                </h3>\n\n                                {authStatus === 'authenticated' ? (\n                                    <>\n                                        <p className=\"text-orange-900/80 text-lg font-bold italic leading-relaxed max-w-2xl\">\n                                            「{company.rjpNegatives}」\n                                        </p>\n                                        <p className=\"text-orange-700/60 text-xs font-bold uppercase tracking-widest\">\n                                            完璧な会社はありません。この不完全さに、あなたの力が加わることを期待しています。\n                                        </p>\n                                    </>\n                                ) : (\n                                    <div className=\"py-8 flex flex-col items-center justify-center space-y-4 bg-white/40 backdrop-blur-sm rounded-2xl border border-orange-200/50 relative\">\n                                        <div className=\"absolute inset-0 flex items-center justify-center opacity-10 pointer-events-none overflow-hidden\">\n                                            <p className=\"text-orange-900 font-bold blur-[2px] leading-relaxed italic p-12\">\n                                                {company.rjpNegatives} {company.rjpNegatives}\n                                            </p>\n                                        </div>\n                                        <div className=\"relative z-20 flex flex-col items-center\">\n                                            <div className=\"bg-orange-500 text-white p-3 rounded-full mb-4 shadow-lg shadow-orange-500/20\">\n                                                <Lock size={24} />\n                                            </div>\n                                            <p className=\"text-orange-900 font-black text-lg\">会員限定公開</p>\n                                            <p className=\"text-orange-700/70 text-sm font-bold mt-1\">ログインして企業の「本音」を見る</p>\n                                            <div className=\"mt-6 px-8 py-3 bg-orange-900 text-white rounded-full font-black text-sm shadow-xl flex items-center gap-2\">\n                                                内容をチェック <ArrowRight size={16} />\n                                            </div>\n                                        </div>\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                        {/* Corporate Profile Table */}\n                        <div className=\"bg-white border border-slate-100 rounded-[2.5rem] p-8 md:p-12 shadow-sm\">\n                            <h3 className=\"text-2xl font-black text-zinc-800 mb-8 border-l-4 border-blue-600 pl-4\">\n                                会社概要\n                            </h3>\n                            <dl className=\"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6\">\n                                <div className=\"border-b border-slate-100 pb-4\">\n                                    <dt className=\"text-xs font-bold text-slate-400 uppercase tracking-wider mb-1\">設立</dt>\n                                    <dd className=\"text-base font-bold text-slate-800\">{company.foundingYear}年</dd>\n                                </div>\n                                <div className=\"border-b border-slate-100 pb-4\">\n                                    <dt className=\"text-xs font-bold text-slate-400 uppercase tracking-wider mb-1\">資本金</dt>\n                                    <dd className=\"text-base font-bold text-slate-800\">{company.capital || '-'}</dd>\n                                </div>\n                                <div className=\"border-b border-slate-100 pb-4\">\n                                    <dt className=\"text-xs font-bold text-slate-400 uppercase tracking-wider mb-1\">従業員数</dt>\n                                    <dd className=\"text-base font-bold text-slate-800\">{company.employeeCount || '-'}</dd>\n                                </div>\n                                <div className=\"border-b border-slate-100 pb-4\">\n                                    <dt className=\"text-xs font-bold text-slate-400 uppercase tracking-wider mb-1\">代表者</dt>\n                                    <dd className=\"text-base font-bold text-slate-800\">{company.representative || '-'}</dd>\n                                </div>\n                                <div className=\"border-b border-slate-100 pb-4 md:col-span-2\">\n                                    <dt className=\"text-xs font-bold text-slate-400 uppercase tracking-wider mb-1\">所在地</dt>\n                                    <dd className=\"text-base font-bold text-slate-800\">{company.address || '-'}</dd>\n                                </div>\n                                <div className=\"border-b border-slate-100 pb-4 md:col-span-2\">\n                                    <dt className=\"text-xs font-bold text-slate-400 uppercase tracking-wider mb-1\">福利厚生</dt>\n                                    <dd className=\"text-base font-medium text-slate-700\">{company.benefits || '-'}</dd>\n                                </div>\n                                <div className=\"pt-2 md:col-span-2\">\n                                    <dt className=\"text-xs font-bold text-slate-400 uppercase tracking-wider mb-1\">Webサイト</dt>\n                                    <dd>\n                                        <a href={company.website} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-600 font-bold hover:underline flex items-center gap-1\">\n                                            {company.website || '-'} <ArrowRight size={14} />\n                                        </a>\n                                    </dd>\n                                </div>\n                            </dl>\n                        </div>\n\n                        {/* Jobs from this company */}\n                        <div className=\"space-y-8\">\n                            <div className=\"flex items-center justify-between\">\n                                <h3 className=\"text-2xl font-black text-zinc-800 italic\">掲載中のクエスト</h3>\n                                <span className=\"text-zinc-400 font-bold text-sm tracking-widest\">{companyJobs.length} Quests Available</span>\n                            </div>\n\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                                {companyJobs.map((job) => (\n                                    <Link key={job.id} href={`/jobs/${job.id}`}>\n                                        <div className=\"bg-zinc-50 hover:bg-white hover:shadow-xl hover:-translate-y-1 p-6 rounded-[2rem] border border-zinc-100 transition-all flex justify-between items-center group\">\n                                            <div>\n                                                <span className=\"text-[10px] font-black text-blue-500 uppercase tracking-widest\">{job.category}</span>\n                                                <h4 className=\"text-lg font-bold text-zinc-800 mt-1\">{job.title}</h4>\n                                            </div>\n                                            <div className=\"w-10 h-10 rounded-full bg-white flex items-center justify-center text-zinc-300 group-hover:bg-blue-600 group-hover:text-white transition-all shadow-sm\">\n                                                <ArrowRight size={20} />\n                                            </div>\n                                        </div>\n                                    </Link>\n                                ))}\n                            </div>\n                        </div>\n                    </div>\n                </section>\n            </main>\n\n            {/* Footer Contact (Simulated) */}\n            <footer className=\"bg-zinc-900 py-16 px-8 text-center mt-12\">\n                <h4 className=\"text-white text-3xl font-black italic mb-8\">この企業に興味がありますか？</h4>\n                <div className=\"flex flex-col md:flex-row justify-center gap-4\">\n                    <button\n                        onClick={() => toast.success('公式SNSをフォローしました')}\n                        className=\"bg- eis-yellow text-zinc-900 px-12 py-4 rounded-full font-black hover:bg-yellow-400 transition-all\"\n                    >\n                        公式SNSをフォローする\n                    </button>\n                    <button\n                        onClick={() => {\n                            toast.info('採用サイトへ遷移します');\n                            window.open('https://eis-reach.com', '_blank');\n                        }}\n                        className=\"bg-white/10 text-white border border-white/20 px-12 py-4 rounded-full font-black hover:bg-white/20 transition-all\"\n                    >\n                        採用HPを見る\n                    </button>\n                </div>\n            </footer>\n\n            <LoginPromptModal\n                isOpen={isLoginModalOpen}\n                onClose={() => setIsLoginModalOpen(false)}\n                message={loginModalMessage}\n            />\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/companies/page.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":227,"column":37,"nodeType":"JSXOpeningElement","endLine":231,"endColumn":39}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React from 'react';\nimport Link from 'next/link';\nimport { useAppStore } from '@/lib/appStore';\nimport { Building2, MapPin, Users, ArrowRight, ShieldCheck, Eye, Briefcase, Search, X, Filter, ChevronUp, ChevronDown } from 'lucide-react';\nimport { JOBS, Reel } from '@/lib/dummyData';\nimport { ReelIcon } from '@/components/reels/ReelIcon';\nimport { ReelModal } from '@/components/reels/ReelModal';\n\nexport default function CompaniesPage() {\n    const { companies } = useAppStore();\n    const [searchQuery, setSearchQuery] = React.useState('');\n    const [selectedIndustry, setSelectedIndustry] = React.useState<string | null>(null);\n    const [selectedFeatures, setSelectedFeatures] = React.useState<string[]>([]);\n    const [isFilterOpen, setIsFilterOpen] = React.useState(false);\n\n    // Reel State\n    const [isReelModalOpen, setIsReelModalOpen] = React.useState(false);\n    const [activeReels, setActiveReels] = React.useState<Reel[]>([]);\n    const [activeEntity, setActiveEntity] = React.useState<{ name: string, id: string }>({ name: '', id: '' });\n\n    // Derived Data\n    const industries = Array.from(new Set(companies.map(c => c.industry)));\n\n    // Filtering\n    const filteredCompanies = companies.filter(c => {\n        const query = searchQuery.toLowerCase();\n\n        // 1. Keyword Search\n        const matchesSearch = !query ||\n            c.name.toLowerCase().includes(query) ||\n            c.description.toLowerCase().includes(query) ||\n            c.location.toLowerCase().includes(query);\n\n        // 2. Industry Filter\n        const matchesIndustry = !selectedIndustry || c.industry === selectedIndustry;\n\n        // 3. Feature Filter\n        let matchesFeatures = true;\n        if (selectedFeatures.length > 0) {\n            // AND logic: must match ALL selected features\n            if (selectedFeatures.includes('premium') && !c.isPremium) matchesFeatures = false;\n\n            if (selectedFeatures.includes('transparent')) {\n                // \"Transparent\" = Has RJP negatives (Reality Check)\n                if (!c.rjpNegatives) matchesFeatures = false;\n            }\n\n            if (selectedFeatures.includes('hiring')) {\n                const hasJobs = JOBS.some(j => j.companyId === c.id);\n                if (!hasJobs) matchesFeatures = false;\n            }\n        }\n\n        return matchesSearch && matchesIndustry && matchesFeatures;\n    });\n\n    const toggleFeature = (feature: string) => {\n        if (selectedFeatures.includes(feature)) {\n            setSelectedFeatures(selectedFeatures.filter(f => f !== feature));\n        }\n    };\n\n    const clearFilters = () => {\n        setSearchQuery('');\n        setSelectedIndustry(null);\n        setSelectedFeatures([]);\n    };\n\n    const activeFilterCount = (selectedIndustry ? 1 : 0) + selectedFeatures.length;\n\n    return (\n        <div className=\"min-h-screen bg-slate-50 pb-24 md:pb-0\">\n            {/* Unified Header Section */}\n            <div className=\"bg-white border-b border-slate-100 shadow-sm sticky top-0 z-20\">\n                <div className=\"max-w-7xl mx-auto p-4 md:p-6\">\n                    <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-4\">\n                        <div>\n                            <h1 className=\"text-2xl md:text-3xl font-black text-slate-800 flex items-center gap-3 tracking-tighter\">\n                                <Building2 size={32} className=\"text-blue-600\" />\n                                企業を探す\n                            </h1>\n                            <p className=\"text-slate-500 font-bold mt-1 text-xs md:text-sm pl-11\">\n                                愛媛県の魅力的な企業独自の強みや文化を発見。\n                            </p>\n                        </div>\n                    </div>\n\n                    {/* Unified Search & Filter Bar */}\n                    <div className=\"bg-slate-50 p-2 rounded-2xl border border-slate-200 shadow-inner\">\n                        <div className=\"relative flex items-center\">\n                            <div className=\"absolute left-4 text-slate-400 pointer-events-none\">\n                                <Search size={20} />\n                            </div>\n                            <input\n                                type=\"text\"\n                                placeholder=\"キーワード検索 (企業名, 事業内容, 地域など)\"\n                                value={searchQuery}\n                                onChange={(e) => setSearchQuery(e.target.value)}\n                                className=\"w-full pl-12 pr-4 py-3.5 rounded-xl bg-slate-50 border-none focus:ring-0 font-bold text-slate-700 text-base placeholder:font-medium placeholder:text-slate-400\"\n                            />\n                            <div className=\"flex items-center gap-2 pr-2\">\n                                {(activeFilterCount > 0 || searchQuery) && (\n                                    <button\n                                        onClick={clearFilters}\n                                        className=\"p-2 hover:bg-slate-200 rounded-full text-slate-400 transition-colors\"\n                                        title=\"検索条件をクリア\"\n                                    >\n                                        <X size={20} />\n                                    </button>\n                                )}\n                                <button\n                                    onClick={() => setIsFilterOpen(!isFilterOpen)}\n                                    className={`flex items-center gap-2 px-5 py-2.5 rounded-xl font-bold transition-all whitespace-nowrap shadow-sm border ${isFilterOpen || activeFilterCount > 0\n                                        ? 'bg-slate-800 text-white border-slate-800 shadow-md transform scale-105'\n                                        : 'bg-white text-slate-600 border-slate-200 hover:bg-slate-100'\n                                        }`}\n                                >\n                                    <Filter size={18} />\n                                    <span className=\"hidden md:inline\">絞り込み</span>\n                                    {activeFilterCount > 0 && (\n                                        <span className=\"bg-blue-500 text-white text-[10px] px-1.5 py-0.5 rounded-full ml-1 min-w-[18px] text-center font-bold\">\n                                            {activeFilterCount}\n                                        </span>\n                                    )}\n                                    {isFilterOpen ? <ChevronUp size={16} /> : <ChevronDown size={16} />}\n                                </button>\n                            </div>\n                        </div>\n\n                        {/* Collapsible Detailed Filters */}\n                        <div\n                            className={`overflow-hidden transition-all duration-300 ease-in-out ${isFilterOpen ? 'max-h-[800px] opacity-100' : 'max-h-0 opacity-0'\n                                }`}\n                        >\n                            <div className=\"p-4 md:p-6 border-t border-slate-200 bg-white/50 rounded-b-xl space-y-6 mt-2\">\n                                <div className=\"flex flex-col md:flex-row gap-6\">\n                                    {/* Feature Filter */}\n                                    <div className=\"flex-1\">\n                                        <div className=\"flex items-center gap-2 mb-3\">\n                                            <span className=\"text-sm font-black text-slate-700\">特徴・こだわり</span>\n                                        </div>\n                                        <div className=\"flex flex-wrap gap-2\">\n                                            <button\n                                                onClick={() => toggleFeature('premium')}\n                                                className={`flex items-center gap-1.5 px-4 py-2.5 rounded-full text-sm font-bold transition-all border shadow-sm hover:-translate-y-0.5 ${selectedFeatures.includes('premium') ? 'bg-yellow-50 border-yellow-400 text-yellow-700 ring-2 ring-yellow-100' : 'bg-white border-slate-200 text-slate-600 hover:border-slate-300 hover:shadow-md'}`}\n                                            >\n                                                <ShieldCheck size={14} className={selectedFeatures.includes('premium') ? 'text-yellow-500' : 'text-slate-400'} />\n                                                認定企業\n                                            </button>\n                                            <button\n                                                onClick={() => toggleFeature('transparent')}\n                                                className={`flex items-center gap-1.5 px-4 py-2.5 rounded-full text-sm font-bold transition-all border shadow-sm hover:-translate-y-0.5 ${selectedFeatures.includes('transparent') ? 'bg-amber-50 border-amber-400 text-amber-800 ring-2 ring-amber-100' : 'bg-white border-slate-200 text-slate-600 hover:border-slate-300 hover:shadow-md'}`}\n                                            >\n                                                <Eye size={14} className={selectedFeatures.includes('transparent') ? 'text-amber-500' : 'text-slate-400'} />\n                                                リアルな情報あり\n                                            </button>\n                                            <button\n                                                onClick={() => toggleFeature('hiring')}\n                                                className={`flex items-center gap-1.5 px-4 py-2.5 rounded-full text-sm font-bold transition-all border shadow-sm hover:-translate-y-0.5 ${selectedFeatures.includes('hiring') ? 'bg-blue-50 border-blue-400 text-blue-700 ring-2 ring-blue-100' : 'bg-white border-slate-200 text-slate-600 hover:border-slate-300 hover:shadow-md'}`}\n                                            >\n                                                <Briefcase size={14} className={selectedFeatures.includes('hiring') ? 'text-blue-500' : 'text-slate-400'} />\n                                                募集中\n                                            </button>\n                                        </div>\n                                    </div>\n\n                                    {/* Industry Filter */}\n                                    <div className=\"flex-1 md:border-l md:border-slate-100 md:pl-6\">\n                                        <div className=\"flex items-center gap-2 mb-3\">\n                                            <span className=\"text-sm font-black text-slate-700\">業界ジャンル</span>\n                                        </div>\n                                        <div className=\"flex flex-wrap gap-2\">\n                                            <button\n                                                onClick={() => setSelectedIndustry(null)}\n                                                className={`px-4 py-2 text-xs font-bold rounded-full transition-all border shadow-sm hover:-translate-y-0.5 ${!selectedIndustry ? 'bg-slate-800 text-white border-slate-800 ring-2 ring-slate-200' : 'bg-white text-slate-600 border-slate-200 hover:border-slate-300 hover:bg-slate-50'}`}\n                                            >\n                                                すべて\n                                            </button>\n                                            {industries.map(ind => (\n                                                <button\n                                                    key={ind}\n                                                    onClick={() => setSelectedIndustry(ind)}\n                                                    className={`px-4 py-2 text-xs font-bold rounded-full transition-all border shadow-sm hover:-translate-y-0.5 ${selectedIndustry === ind ? 'bg-blue-600 text-white border-blue-600 ring-2 ring-blue-200' : 'bg-white text-slate-600 border-slate-200 hover:border-slate-300 hover:bg-slate-50'}`}\n                                                >\n                                                    {ind}\n                                                </button>\n                                            ))}\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <div className=\"p-4 md:p-8 max-w-7xl mx-auto\">\n                {/* Header & Controls removed (moved to sticky) */}\n\n                {/* Grid */}\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8\">\n                    {/* Count */}\n                    <div className=\"col-span-1 md:col-span-3 flex items-center justify-between px-2 mb-2\">\n                        <span className=\"text-sm font-bold text-slate-500\">{filteredCompanies.length}社の企業</span>\n                    </div>\n                    {filteredCompanies.length > 0 ? (\n                        filteredCompanies.map(company => (\n                            <Link\n                                href={`/companies/${company.id}`}\n                                key={company.id}\n                                className=\"block bg-white rounded-3xl overflow-hidden shadow-sm hover:shadow-xl hover:-translate-y-1 transition-all border border-slate-100 group flex flex-col h-full relative\"\n                            >\n                                <div className=\"absolute top-4 left-4 z-10 text-white drop-shadow-md\">\n                                    <ReelIcon\n                                        reels={company.reels || []}\n                                        onClick={() => {\n                                            setActiveReels(company.reels || []);\n                                            setActiveEntity({ name: company.name, id: company.id });\n                                            setIsReelModalOpen(true);\n                                        }}\n                                    />\n                                </div>\n                                {/* Larger Image Area */}\n                                <div className=\"relative h-56 bg-slate-200 overflow-hidden\">\n                                    <img\n                                        src={company.image}\n                                        alt={company.name}\n                                        className=\"w-full h-full object-cover transition-transform duration-700 group-hover:scale-105\"\n                                    />\n                                    {company.isPremium && (\n                                        <div className=\"absolute top-4 right-4 bg-yellow-400 text-white text-[10px] font-black px-3 py-1 rounded-full shadow-lg backdrop-blur-sm\">\n                                            ★ PREMIUM\n                                        </div>\n                                    )}\n                                </div>\n\n                                <div className=\"p-6 flex-1 flex flex-col\">\n                                    <div className=\"mb-4\">\n                                        <h3 className=\"text-xl font-black text-slate-800 mb-2 group-hover:text-blue-600 transition-colors line-clamp-1\">\n                                            {company.name}\n                                        </h3>\n                                        <div className=\"flex items-center gap-2 flex-wrap\">\n                                            <span className=\"text-[10px] font-bold text-blue-600 bg-blue-50 px-2.5 py-1 rounded-md\">\n                                                {company.industry}\n                                            </span>\n                                            <span className=\"text-[10px] font-bold text-slate-500 bg-slate-100 px-2.5 py-1 rounded-md flex items-center gap-1\">\n                                                <MapPin size={10} />\n                                                {company.location}\n                                            </span>\n                                        </div>\n                                    </div>\n\n                                    <p className=\"text-sm font-medium text-slate-600 mb-6 line-clamp-3 leading-relaxed flex-1\">\n                                        {company.description}\n                                    </p>\n\n                                    <div className=\"pt-4 border-t border-slate-100 flex items-center justify-between text-xs font-bold text-slate-400\">\n                                        <span className=\"group-hover:text-blue-600 transition-colors flex items-center gap-1\">\n                                            詳細を見る <ArrowRight size={12} />\n                                        </span>\n                                        {company.employeeCount && (\n                                            <div className=\"flex items-center gap-1\">\n                                                <Users size={12} />\n                                                {company.employeeCount}\n                                            </div>\n                                        )}\n                                    </div>\n                                </div>\n                            </Link>\n                        ))\n                    ) : (\n                        <div className=\"col-span-1 md:col-span-3 text-center py-20\">\n                            <p className=\"text-slate-400 font-bold\">条件に一致する企業が見つかりませんでした。</p>\n                            <button\n                                onClick={() => { setSearchQuery(''); setSelectedIndustry(null); }}\n                                className=\"mt-4 text-blue-600 font-bold hover:underline\"\n                            >\n                                検索条件をクリア\n                            </button>\n                        </div>\n                    )}\n                </div>\n            </div>\n\n            <ReelModal\n                isOpen={isReelModalOpen}\n                onClose={() => setIsReelModalOpen(false)}\n                reels={activeReels}\n                entityName={activeEntity.name}\n                entityId={activeEntity.id}\n                entityType=\"company\"\n            />\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/dashboard/company/jobs/new/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":78,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":78,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2441,2444],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2441,2444],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":86,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":86,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2647,2650],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2647,2650],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState } from 'react';\nimport { Save, Sparkles, Globe, FileText, Upload, RefreshCcw } from 'lucide-react';\nimport { toast } from 'sonner';\n\nexport default function JobCreatorPage() {\n    const [isLoading, setIsLoading] = useState(false);\n    const [importSource, setImportSource] = useState<'url' | 'pdf'>('url');\n    const [url, setUrl] = useState('');\n    const [fileData, setFileData] = useState<{ base64: string, mimeType: string } | null>(null);\n\n    // Form States\n    const [formData, setFormData] = useState({\n        title: '',\n        category: '中途',\n        description: '',\n        requirements: '',\n        reward: '',\n        workingHours: '',\n        holidays: '',\n        welfare: '',\n        selectionProcess: '',\n    });\n\n    const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const file = e.target.files?.[0];\n        if (!file) return;\n\n        const reader = new FileReader();\n        reader.onloadend = () => {\n            const base64String = reader.result as string;\n            // Remove prefix \"data:application/pdf;base64,\"\n            const base64Content = base64String.split(',')[1];\n            setFileData({\n                base64: base64Content,\n                mimeType: file.type\n            });\n        };\n        reader.readAsDataURL(file);\n    };\n\n    // AI Auto-fill Handler\n    const handleAutoFill = async () => {\n        if (importSource === 'url' && !url) {\n            toast.error('URLを入力してください');\n            return;\n        }\n        if (importSource === 'pdf' && !fileData) {\n            toast.error('PDFファイルをアップロードしてください');\n            return;\n        }\n\n        setIsLoading(true);\n\n        try {\n            const payload = importSource === 'url'\n                ? { input: url }\n                : { base64Data: fileData?.base64, mimeType: fileData?.mimeType };\n\n            const response = await fetch('/api/ai/job-generate', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify(payload)\n            });\n\n            if (!response.ok) throw new Error('Generation failed');\n            const data = await response.json();\n\n            setFormData(prev => ({\n                ...prev,\n                ...data,\n                category: data.category || prev.category\n            }));\n\n            toast.success('求人情報を生成しました！');\n\n        } catch (e: any) {\n            console.error(e);\n            toast.error(`生成に失敗しました: ${e.message}`);\n        } finally {\n            setIsLoading(false);\n        }\n    };\n\n    const handleChange = (key: string, value: any) => {\n        setFormData(prev => ({ ...prev, [key]: value }));\n    };\n\n    return (\n        <div className=\"max-w-3xl mx-auto space-y-8 pb-20\">\n            <div className=\"flex items-center justify-between\">\n                <div>\n                    <h2 className=\"text-2xl font-black text-slate-800\">新規求人・クエスト作成</h2>\n                    <p className=\"text-slate-500 text-sm mt-1\">既存の求人票やWEBページから一瞬で作成できます</p>\n                </div>\n                <div className=\"flex gap-3\">\n                    <button\n                        onClick={() => toast.success('下書きを保存しました')}\n                        className=\"bg-white border border-slate-200 text-slate-600 px-6 py-2.5 rounded-full font-bold text-sm hover:bg-slate-50 flex items-center gap-2\"\n                    >\n                        <FileText size={18} />\n                        下書き保存\n                    </button>\n                    <button\n                        onClick={() => toast.success('求人を公開しました')}\n                        className=\"bg-slate-900 text-white px-6 py-2.5 rounded-full font-bold text-sm hover:bg-slate-800 flex items-center gap-2\"\n                    >\n                        <Save size={18} />\n                        公開する\n                    </button>\n                </div>\n            </div>\n\n            {/* AI Auto-fill Section */}\n            <div className=\"bg-gradient-to-br from-indigo-50 to-purple-50 border border-indigo-100 p-6 rounded-3xl space-y-6\">\n                <div className=\"flex items-center gap-2 text-indigo-700 font-black\">\n                    <Sparkles size={20} />\n                    <h3>AI 求人作成アシスタント (Gemini 2.0 Flash)</h3>\n                </div>\n\n                {/* Source Toggle */}\n                <div className=\"flex bg-white/60 p-1 rounded-xl w-fit border border-indigo-100\">\n                    <button\n                        onClick={() => setImportSource('url')}\n                        className={`px-4 py-2 rounded-lg text-xs font-bold transition-all ${importSource === 'url' ? 'bg-white shadow-sm text-indigo-600' : 'text-slate-400 hover:text-slate-600'}`}\n                    >\n                        WEBサイト(URL)から\n                    </button>\n                    <button\n                        onClick={() => setImportSource('pdf')}\n                        className={`px-4 py-2 rounded-lg text-xs font-bold transition-all ${importSource === 'pdf' ? 'bg-white shadow-sm text-indigo-600' : 'text-slate-400 hover:text-slate-600'}`}\n                    >\n                        求人票(PDF)から\n                    </button>\n                </div>\n\n                {importSource === 'url' ? (\n                    <div className=\"flex gap-2\">\n                        <div className=\"relative flex-1\">\n                            <Globe className=\"absolute left-3 top-1/2 -translate-y-1/2 text-indigo-300\" size={18} />\n                            <input\n                                type=\"url\"\n                                placeholder=\"https://wantedly.com/projects/...\"\n                                value={url}\n                                onChange={(e) => setUrl(e.target.value)}\n                                className=\"w-full pl-10 pr-4 py-3 rounded-xl border border-indigo-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white text-slate-900 placeholder:text-slate-400\"\n                            />\n                        </div>\n                        <button\n                            onClick={handleAutoFill}\n                            disabled={isLoading}\n                            className=\"bg-indigo-600 text-white px-6 rounded-xl font-bold text-sm hover:bg-indigo-700 disabled:opacity-50 flex items-center gap-2 min-w-[140px] justify-center\"\n                        >\n                            {isLoading ? <RefreshCcw className=\"animate-spin\" size={18} /> : <Sparkles size={18} />}\n                            {isLoading ? '解析中...' : '自動生成'}\n                        </button>\n                    </div>\n                ) : (\n                    <div className=\"flex gap-2\">\n                        <div className=\"relative flex-1\">\n                            <Upload className=\"absolute left-3 top-1/2 -translate-y-1/2 text-indigo-300\" size={18} />\n                            <input\n                                type=\"file\"\n                                accept=\".pdf,image/*\"\n                                onChange={handleFileChange}\n                                className=\"w-full pl-10 pr-4 py-2.5 rounded-xl border border-indigo-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white text-slate-900 file:mr-4 file:py-1 file:px-4 file:rounded-full file:border-0 file:text-xs file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100\"\n                            />\n                        </div>\n                        <button\n                            onClick={handleAutoFill}\n                            disabled={isLoading}\n                            className=\"bg-indigo-600 text-white px-6 rounded-xl font-bold text-sm hover:bg-indigo-700 disabled:opacity-50 flex items-center gap-2 min-w-[140px] justify-center\"\n                        >\n                            {isLoading ? <RefreshCcw className=\"animate-spin\" size={18} /> : <Sparkles size={18} />}\n                            {isLoading ? '解析中...' : '自動生成'}\n                        </button>\n                    </div>\n                )}\n            </div>\n\n            {/* Editor Forms */}\n            <div className=\"space-y-6\">\n                <div className=\"bg-white p-6 rounded-3xl border border-slate-100 shadow-sm space-y-4\">\n                    <label className=\"block text-sm font-black text-slate-700\">募集タイトル</label>\n                    <input\n                        type=\"text\"\n                        value={formData.title}\n                        onChange={(e) => handleChange('title', e.target.value)}\n                        className=\"w-full p-4 rounded-xl border border-slate-200 bg-slate-50 font-bold focus:bg-white transition-colors text-slate-900\"\n                        placeholder=\"（例）未経験歓迎！SaaS営業のスターティングメンバー\"\n                    />\n                </div>\n\n                <div className=\"bg-white p-6 rounded-3xl border border-slate-100 shadow-sm space-y-4\">\n                    <label className=\"block text-sm font-black text-slate-700\">カテゴリー</label>\n                    <div className=\"flex flex-wrap gap-2\">\n                        {['新卒', '中途', 'アルバイト', '体験JOB', 'インターンシップ'].map(cat => (\n                            <button\n                                key={cat}\n                                onClick={() => handleChange('category', cat)}\n                                className={`px-4 py-2 rounded-lg text-sm font-bold border transition-all ${formData.category === cat ? 'bg-slate-900 text-white border-slate-900' : 'bg-white text-slate-500 border-slate-200 hover:border-slate-400'}`}\n                            >\n                                {cat}\n                            </button>\n                        ))}\n                    </div>\n                </div>\n\n                <div className=\"bg-white p-6 rounded-3xl border border-slate-100 shadow-sm space-y-4\">\n                    <label className=\"block text-sm font-black text-slate-700 flex items-center gap-2\">\n                        募集詳細\n                        <span className=\"text-xs bg-indigo-100 text-indigo-700 px-2 py-0.5 rounded-md font-normal\">AI生成推奨</span>\n                    </label>\n                    <textarea\n                        rows={8}\n                        value={formData.description}\n                        onChange={(e) => handleChange('description', e.target.value)}\n                        className=\"w-full p-4 rounded-xl border border-slate-200 bg-slate-50 font-medium focus:bg-white transition-colors leading-relaxed text-slate-900\"\n                    />\n                </div>\n                <div className=\"bg-white p-6 rounded-3xl border border-slate-100 shadow-sm space-y-4\">\n                    <label className=\"block text-sm font-black text-slate-700\">応募要件</label>\n                    <textarea\n                        rows={5}\n                        value={formData.requirements}\n                        onChange={(e) => handleChange('requirements', e.target.value)}\n                        className=\"w-full p-4 rounded-xl border border-slate-200 bg-slate-50 font-medium focus:bg-white transition-colors leading-relaxed text-slate-900\"\n                    />\n                </div>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                    <div className=\"bg-white p-6 rounded-3xl border border-slate-100 shadow-sm space-y-4\">\n                        <label className=\"block text-sm font-black text-slate-700\">勤務時間</label>\n                        <input\n                            type=\"text\"\n                            value={formData.workingHours}\n                            onChange={(e) => handleChange('workingHours', e.target.value)}\n                            className=\"w-full p-4 rounded-xl border border-slate-200 bg-slate-50 font-medium text-slate-900\"\n                        />\n                    </div>\n                    <div className=\"bg-white p-6 rounded-3xl border border-slate-100 shadow-sm space-y-4\">\n                        <label className=\"block text-sm font-black text-slate-700\">休日・休暇</label>\n                        <input\n                            type=\"text\"\n                            value={formData.holidays}\n                            onChange={(e) => handleChange('holidays', e.target.value)}\n                            className=\"w-full p-4 rounded-xl border border-slate-200 bg-slate-50 font-medium text-slate-900\"\n                        />\n                    </div>\n                </div>\n                <div className=\"bg-white p-6 rounded-3xl border border-slate-100 shadow-sm space-y-4\">\n                    <label className=\"block text-sm font-black text-slate-700\">給与・報酬</label>\n                    <input\n                        type=\"text\"\n                        value={formData.reward}\n                        onChange={(e) => handleChange('reward', e.target.value)}\n                        className=\"w-full p-4 rounded-xl border border-slate-200 bg-slate-50 font-medium text-slate-900\"\n                        placeholder=\"（例）月給 25万円〜\"\n                    />\n                </div>\n                <div className=\"bg-white p-6 rounded-3xl border border-slate-100 shadow-sm space-y-4\">\n                    <label className=\"block text-sm font-black text-slate-700\">選考フロー</label>\n                    <textarea\n                        rows={3}\n                        value={formData.selectionProcess}\n                        onChange={(e) => handleChange('selectionProcess', e.target.value)}\n                        className=\"w-full p-4 rounded-xl border border-slate-200 bg-slate-50 font-medium focus:bg-white transition-colors leading-relaxed text-slate-900\"\n                    />\n                </div>\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/dashboard/company/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/dashboard/company/messages/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/dashboard/company/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendingUp' is defined but never used.","line":4,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":54,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"TrendingUp"},"fix":{"range":[83,95],"text":""},"desc":"Remove unused variable \"TrendingUp\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React from 'react';\nimport { Users, Heart, Eye, MessageSquare, TrendingUp, Zap } from 'lucide-react';\nimport { useAppStore } from '@/lib/appStore';\n\nexport default function CompanyDashboardOverview() {\n    const { interactions, getCompanyChats, currentCompanyId } = useAppStore();\n\n    // Calculate Real Stats\n    const likeCount = interactions.filter(i => i.type === 'like_company' && i.toId === currentCompanyId).length;\n    const scoutCount = interactions.filter(i => i.type === 'scout' && i.fromId === currentCompanyId).length;\n    const unreadMessages = getCompanyChats(currentCompanyId).reduce((acc, chat) => {\n        return acc + chat.messages.filter(m => m.senderId !== currentCompanyId && !m.isRead).length;\n    }, 0);\n\n    const stats = [\n        { label: '総閲覧数', value: '1,234', change: '+12%', icon: Eye, color: 'text-blue-500', bg: 'bg-blue-50' }, // Still mock for views\n        { label: '気になる', value: likeCount.toString(), change: 'Real-time', icon: Heart, color: 'text-red-500', bg: 'bg-red-50' },\n        { label: 'スカウト送信', value: scoutCount.toString(), change: 'Real-time', icon: Zap, color: 'text-yellow-600', bg: 'bg-yellow-50' },\n        { label: 'メッセージ', value: unreadMessages > 0 ? `未読 ${unreadMessages}` : '既読', change: 'Check now', icon: MessageSquare, color: 'text-green-500', bg: 'bg-green-50' },\n    ];\n\n    return (\n        <div className=\"space-y-8\">\n            <div>\n                <h2 className=\"text-2xl font-black text-slate-800\">ダッシュボード</h2>\n                <p className=\"text-slate-500 text-sm mt-1\">現在の募集状況とパフォーマンス概要</p>\n            </div>\n\n            {/* Stats Grid */}\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                {stats.map((stat, i) => (\n                    <div key={i} className=\"bg-white p-6 rounded-2xl border border-slate-100 shadow-sm flex flex-col justify-between h-32 md:h-40\">\n                        <div className=\"flex justify-between items-start\">\n                            <div className={`p-2 rounded-xl ${stat.bg} ${stat.color}`}>\n                                <stat.icon size={20} />\n                            </div>\n                            <span className={`text-xs font-bold px-2 py-1 rounded-full ${stat.change.includes('+') ? 'bg-green-100 text-green-700' : 'bg-slate-100 text-slate-500'}`}>\n                                {stat.change}\n                            </span>\n                        </div>\n                        <div>\n                            <p className=\"text-slate-400 text-xs font-bold mb-1\">{stat.label}</p>\n                            <p className=\"text-2xl md:text-3xl font-black text-slate-800\">{stat.value}</p>\n                        </div>\n                    </div>\n                ))}\n            </div>\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\n                {/* Recent Interactions Placeholder */}\n                <div className=\"bg-white p-6 rounded-3xl border border-slate-100 shadow-sm\">\n                    <div className=\"flex items-center justify-between mb-6\">\n                        <h3 className=\"text-lg font-black text-slate-800 flex items-center gap-2\">\n                            <Users size={20} className=\"text-slate-400\" />\n                            最近のアクティビティ\n                        </h3>\n                    </div>\n                    {interactions.length > 0 ? (\n                        <div className=\"space-y-4\">\n                            {[...interactions].reverse().slice(0, 5).map((action, i) => (\n                                <div key={i} className=\"flex items-center gap-4 p-3 hover:bg-slate-50 rounded-2xl transition-colors\">\n                                    <div className=\"w-10 h-10 rounded-full bg-slate-200 flex items-center justify-center\">\n                                        {action.type === 'scout' ? '⚡️' : '❤️'}\n                                    </div>\n                                    <div>\n                                        <p className=\"text-sm font-bold text-slate-800\">\n                                            {action.type === 'scout' ? 'スカウトを送信しました' : '「気になる」されました'}\n                                        </p>\n                                        <p className=\"text-xs text-slate-400\">\n                                            {new Date(action.timestamp).toLocaleString()}\n                                        </p>\n                                    </div>\n                                </div>\n                            ))}\n                        </div>\n                    ) : (\n                        <p className=\"text-slate-400 text-sm\">まだアクティビティはありません</p>\n                    )}\n                </div>\n\n                {/* AI Recommendations */}\n                <div className=\"bg-gradient-to-br from-slate-900 to-slate-800 p-6 rounded-3xl text-white shadow-xl relative overflow-hidden\">\n                    <div className=\"absolute top-0 right-0 p-8 opacity-10\">\n                        <Zap size={100} />\n                    </div>\n                    <div className=\"relative z-10 space-y-6\">\n                        <div>\n                            <span className=\"bg-white/10 text-white text-[10px] font-bold px-2 py-1 rounded-md border border-white/10\">AI ADVISOR</span>\n                            <h3 className=\"text-xl font-black mt-2\">プロフィールの改善提案</h3>\n                        </div>\n                        <p className=\"text-slate-300 text-sm leading-relaxed\">\n                            閲覧数が先週より12%増加していますが、応募率がやや横ばいです。「RJP（ぶっちゃけ情報）」をもう少し具体的に記述することで、ミスマッチを恐れない熱意ある層の反応率が上がると予測されます。\n                        </p>\n                        <button className=\"w-full bg-white text-slate-900 py-3 rounded-xl font-black text-sm hover:bg-eis-yellow transition-colors\">\n                            プロフィールをAI修正する\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/dashboard/company/profile/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Phone' is defined but never used.","line":4,"column":61,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":66,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Phone"},"fix":{"range":[114,121],"text":""},"desc":"Remove unused variable \"Phone\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MapPin' is defined but never used.","line":4,"column":68,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":74,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"MapPin"},"fix":{"range":[121,129],"text":""},"desc":"Remove unused variable \"MapPin\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":72,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":72,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2175,2178],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2175,2178],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState } from 'react';\nimport { Save, Sparkles, Globe, RefreshCcw, Zap, Building2, Phone, MapPin, Briefcase, FileText } from 'lucide-react';\nimport { toast } from 'sonner';\n\nexport default function CompanyProfileEditor() {\n    const [isLoading, setIsLoading] = useState(false);\n    const [url, setUrl] = useState('');\n\n    // Form States\n    const [formData, setFormData] = useState({\n        name: '株式会社サンプル',\n        industry: 'IT・通信',\n        location: '愛媛県松山市',\n        description: '',\n        url: '',\n        // Expanded Fields\n        foundingYear: undefined as number | undefined,\n        capital: '',\n        employeeCount: '',\n        representative: '',\n        address: '',\n        phone: '',\n        website: '',\n        businessDetails: '',\n        philosophy: '',\n        benefits: '',\n        // RJP\n        rjpNegatives: '',\n        rjpPositives: '',\n    });\n\n    // AI Auto-fill Handler\n    const handleAutoFill = async () => {\n        if (!url && !formData.description) {\n            toast.error('URLまたは説明文を入力してください');\n            return;\n        }\n\n        setIsLoading(true);\n        try {\n            const response = await fetch('/api/ai/company-profile', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ input: url || formData.description })\n            });\n\n            if (!response.ok) throw new Error('Generation failed');\n\n            const profile = await response.json();\n\n            // Merge with existing data\n            setFormData(prev => ({\n                ...prev,\n                ...profile,\n                name: profile.name || prev.name,\n                industry: profile.industry || prev.industry,\n                location: profile.location || prev.location,\n                website: url || profile.website || prev.website,\n            }));\n\n            toast.success('AIが企業情報を自動生成しました！');\n        } catch (error) {\n            console.error(error);\n            toast.error('情報の生成に失敗しました');\n        } finally {\n            setIsLoading(false);\n        }\n    };\n\n    const handleChange = (key: string, value: any) => {\n        setFormData(prev => ({ ...prev, [key]: value }));\n    };\n\n    return (\n        <div className=\"max-w-4xl mx-auto space-y-8 pb-20\">\n            <div className=\"flex items-center justify-between\">\n                <div>\n                    <h2 className=\"text-2xl font-black text-slate-800\">企業情報編集</h2>\n                    <p className=\"text-slate-500 text-sm mt-1\">AIを活用して、入力コストを最小限に抑えましょう</p>\n                </div>\n                <div className=\"flex gap-3\">\n                    <button\n                        onClick={() => toast.success('下書きを保存しました')}\n                        className=\"bg-white border border-slate-200 text-slate-600 px-6 py-2.5 rounded-full font-bold text-sm hover:bg-slate-50 flex items-center gap-2\"\n                    >\n                        <FileText size={18} />\n                        下書き保存\n                    </button>\n                    <button\n                        onClick={() => toast.success('公開しました')}\n                        className=\"bg-slate-900 text-white px-6 py-2.5 rounded-full font-bold text-sm hover:bg-slate-800 flex items-center gap-2\"\n                    >\n                        <Save size={18} />\n                        公開する\n                    </button>\n                </div>\n            </div>\n\n            {/* AI Auto-fill Section */}\n            <div className=\"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-100 p-6 rounded-3xl space-y-4 shadow-sm\">\n                <div className=\"flex items-center gap-2 text-blue-700 font-black\">\n                    <Sparkles size={20} />\n                    <h3>AI 自動入力アシスタント (Gemini 2.0 Flash)</h3>\n                </div>\n                <p className=\"text-sm text-blue-600/80 font-bold\">\n                    URLや会社の特徴を入力するだけで、基本情報から「魅力・RJP」まで一括生成します。\n                </p>\n                <div className=\"flex flex-col md:flex-row gap-2\">\n                    <div className=\"relative flex-1\">\n                        <Globe className=\"absolute left-3 top-1/2 -translate-y-1/2 text-blue-300\" size={18} />\n                        <input\n                            type=\"url\"\n                            placeholder=\"https://company-site.com (URLまたは会社名・特徴を入力)\"\n                            value={url}\n                            onChange={(e) => setUrl(e.target.value)}\n                            className=\"w-full pl-10 pr-4 py-3 rounded-xl border border-blue-200 focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white text-slate-900 placeholder:text-slate-400\"\n                        />\n                    </div>\n                    <button\n                        onClick={handleAutoFill}\n                        disabled={isLoading}\n                        className=\"bg-blue-600 text-white px-6 rounded-xl font-bold text-sm hover:bg-blue-700 disabled:opacity-50 flex items-center gap-2 min-w-[140px] justify-center shadow-lg shadow-blue-200\"\n                    >\n                        {isLoading ? <RefreshCcw className=\"animate-spin\" size={18} /> : <Sparkles size={18} />}\n                        {isLoading ? '解析中...' : 'AI自動生成'}\n                    </button>\n                </div>\n            </div>\n\n            <div className=\"space-y-6\">\n                {/* Basic Info */}\n                <section className=\"bg-white p-6 rounded-3xl border border-slate-100 shadow-sm space-y-6\">\n                    <h3 className=\"font-bold text-slate-800 flex items-center gap-2 border-b border-slate-100 pb-3\">\n                        <Building2 className=\"text-slate-400\" /> 基本情報\n                    </h3>\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                        <div>\n                            <label className=\"block text-xs font-bold text-slate-500 mb-1\">企業名</label>\n                            <input\n                                type=\"text\"\n                                value={formData.name}\n                                onChange={(e) => handleChange('name', e.target.value)}\n                                className=\"w-full p-3 rounded-xl border border-slate-200 bg-slate-50 font-bold text-slate-900\"\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-xs font-bold text-slate-500 mb-1\">代表者名</label>\n                            <input\n                                type=\"text\"\n                                value={formData.representative}\n                                onChange={(e) => handleChange('representative', e.target.value)}\n                                className=\"w-full p-3 rounded-xl border border-slate-200 bg-slate-50 font-medium text-slate-900\"\n                                placeholder=\"代表取締役...\"\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-xs font-bold text-slate-500 mb-1\">設立年</label>\n                            <input\n                                type=\"number\"\n                                value={formData.foundingYear || ''}\n                                onChange={(e) => handleChange('foundingYear', Number(e.target.value))}\n                                className=\"w-full p-3 rounded-xl border border-slate-200 bg-slate-50 font-medium text-slate-900\"\n                                placeholder=\"西暦\"\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-xs font-bold text-slate-500 mb-1\">資本金</label>\n                            <input\n                                type=\"text\"\n                                value={formData.capital}\n                                onChange={(e) => handleChange('capital', e.target.value)}\n                                className=\"w-full p-3 rounded-xl border border-slate-200 bg-slate-50 font-medium text-slate-900\"\n                                placeholder=\"1,000万円\"\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-xs font-bold text-slate-500 mb-1\">従業員数</label>\n                            <input\n                                type=\"text\"\n                                value={formData.employeeCount}\n                                onChange={(e) => handleChange('employeeCount', e.target.value)}\n                                className=\"w-full p-3 rounded-xl border border-slate-200 bg-slate-50 font-medium text-slate-900\"\n                                placeholder=\"50名\"\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-xs font-bold text-slate-500 mb-1\">電話番号</label>\n                            <input\n                                type=\"text\"\n                                value={formData.phone}\n                                onChange={(e) => handleChange('phone', e.target.value)}\n                                className=\"w-full p-3 rounded-xl border border-slate-200 bg-slate-50 font-medium text-slate-900\"\n                            />\n                        </div>\n                        <div className=\"md:col-span-2\">\n                            <label className=\"block text-xs font-bold text-slate-500 mb-1\">所在地</label>\n                            <input\n                                type=\"text\"\n                                value={formData.address || formData.location}\n                                onChange={(e) => handleChange('address', e.target.value)}\n                                className=\"w-full p-3 rounded-xl border border-slate-200 bg-slate-50 font-medium text-slate-900\"\n                                placeholder=\"詳細な住所\"\n                            />\n                        </div>\n                        <div className=\"md:col-span-2\">\n                            <label className=\"block text-xs font-bold text-slate-500 mb-1\">Webサイト</label>\n                            <input\n                                type=\"text\"\n                                value={formData.website}\n                                onChange={(e) => handleChange('website', e.target.value)}\n                                className=\"w-full p-3 rounded-xl border border-slate-200 bg-slate-50 font-medium text-slate-900\"\n                                placeholder=\"https://...\"\n                            />\n                        </div>\n                    </div>\n                </section>\n\n                {/* Business Info */}\n                <section className=\"bg-white p-6 rounded-3xl border border-slate-100 shadow-sm space-y-6\">\n                    <h3 className=\"font-bold text-slate-800 flex items-center gap-2 border-b border-slate-100 pb-3\">\n                        <Briefcase className=\"text-slate-400\" /> 事業・理念\n                    </h3>\n                    <div className=\"space-y-4\">\n                        <div>\n                            <label className=\"block text-xs font-bold text-slate-500 mb-1\">企業理念・ビジョン</label>\n                            <textarea\n                                rows={3}\n                                value={formData.philosophy}\n                                onChange={(e) => handleChange('philosophy', e.target.value)}\n                                className=\"w-full p-3 rounded-xl border border-slate-200 bg-slate-50 font-medium text-slate-900\"\n                                placeholder=\"私たちは...\"\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-xs font-bold text-slate-500 mb-1\">事業詳細</label>\n                            <textarea\n                                rows={4}\n                                value={formData.businessDetails}\n                                onChange={(e) => handleChange('businessDetails', e.target.value)}\n                                className=\"w-full p-3 rounded-xl border border-slate-200 bg-slate-50 font-medium text-slate-900\"\n                                placeholder=\"具体的な事業内容...\"\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-xs font-bold text-slate-500 mb-1\">キャッチコピー・概要</label>\n                            <textarea\n                                rows={2}\n                                value={formData.description}\n                                onChange={(e) => handleChange('description', e.target.value)}\n                                className=\"w-full p-3 rounded-xl border border-slate-200 bg-slate-50 font-medium text-slate-900\"\n                                placeholder=\"一言で言うと...\"\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-xs font-bold text-slate-500 mb-1\">福利厚生</label>\n                            <textarea\n                                rows={3}\n                                value={formData.benefits}\n                                onChange={(e) => handleChange('benefits', e.target.value)}\n                                className=\"w-full p-3 rounded-xl border border-slate-200 bg-slate-50 font-medium text-slate-900\"\n                                placeholder=\"各種保険、手当など...\"\n                            />\n                        </div>\n                    </div>\n                </section>\n\n                {/* RJP Section */}\n                <section className=\"bg-orange-50 p-6 rounded-3xl border border-orange-100 shadow-sm space-y-6\">\n                    <h3 className=\"font-black text-orange-900 flex items-center gap-2 border-b border-orange-200/50 pb-3\">\n                        <Zap className=\"text-orange-500\" /> RJP (Realistic Job Preview)\n                    </h3>\n                    <p className=\"text-xs text-orange-800/70 font-bold\">\n                        AIが業界特性から推測した内容が入力されます。実態に合わせて修正してください。正直な開示がミスマッチを防ぎます。\n                    </p>\n                    <div className=\"space-y-4\">\n                        <div>\n                            <label className=\"block text-xs font-bold text-orange-800 mb-1\">ポジティブな側面・やりがい</label>\n                            <textarea\n                                rows={3}\n                                value={formData.rjpPositives}\n                                onChange={(e) => handleChange('rjpPositives', e.target.value)}\n                                className=\"w-full p-3 rounded-xl border border-orange-200 bg-white font-medium focus:ring-2 focus:ring-orange-200 text-slate-900\"\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-xs font-bold text-orange-800 mb-1\">ネガティブな側面・覚悟が必要な点</label>\n                            <textarea\n                                rows={3}\n                                value={formData.rjpNegatives}\n                                onChange={(e) => handleChange('rjpNegatives', e.target.value)}\n                                className=\"w-full p-3 rounded-xl border border-orange-200 bg-white font-medium focus:ring-2 focus:ring-orange-200 text-slate-900\"\n                            />\n                        </div>\n                    </div>\n                </section>\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/dashboard/company/scout/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MapPin' is defined but never used.","line":4,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":24,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"MapPin"},"fix":{"range":[71,79],"text":""},"desc":"Remove unused variable \"MapPin\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Briefcase' is defined but never used.","line":4,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":35,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Briefcase"},"fix":{"range":[79,90],"text":""},"desc":"Remove unused variable \"Briefcase\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronDown' is defined but never used.","line":4,"column":67,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":78,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ChevronDown"},"fix":{"range":[120,133],"text":""},"desc":"Remove unused variable \"ChevronDown\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Filter' is defined but never used.","line":4,"column":80,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":86,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Filter"},"fix":{"range":[133,141],"text":""},"desc":"Remove unused variable \"Filter\"."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":75,"column":45,"nodeType":"JSXOpeningElement","endLine":75,"endColumn":157}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState } from 'react';\nimport { Search, MapPin, Briefcase, GraduationCap, MessageSquare, ChevronDown, Filter, CheckCircle } from 'lucide-react';\nimport { toast } from 'sonner';\nimport { useAppStore } from '@/lib/appStore';\n\nexport default function ScoutPage() {\n    const { users, currentCompanyId, interactions, addInteraction, createChat } = useAppStore();\n    const [scoutedIds, setScoutedIds] = useState<string[]>([]);\n\n    const handleScout = (userId: string, userName: string) => {\n        // 1. Record interaction\n        addInteraction({\n            type: 'scout',\n            fromId: currentCompanyId,\n            toId: userId,\n            metadata: { message: 'スカウトを送りました' }\n        });\n\n        // 2. Create Chat Thread (Mock sending a message)\n        createChat(currentCompanyId, userId, 'はじめまして！プロフィールの「愛媛を面白くする」という言葉に惹かれました。ぜひ一度お話ししませんか？');\n\n        setScoutedIds(prev => [...prev, userId]);\n        toast.success(`${userName}さんにスカウトを送りました`);\n    };\n\n    const handleLike = (userId: string, userName: string) => {\n        addInteraction({\n            type: 'like_user',\n            fromId: currentCompanyId,\n            toId: userId,\n        });\n        toast.success(`${userName}さんを「気になる」リストに追加しました`);\n    };\n\n    return (\n        <div className=\"space-y-8 pb-20\">\n            <div>\n                <h2 className=\"text-2xl font-black text-slate-800\">スカウト</h2>\n                <p className=\"text-slate-500 text-sm mt-1\">あなたの会社に興味を持っている、または条件に合う人材を探しましょう</p>\n            </div>\n\n            {/* Search & Filter */}\n            <div className=\"bg-white p-4 rounded-2xl shadow-sm border border-slate-100 flex flex-col md:flex-row gap-4\">\n                <div className=\"flex-1 relative\">\n                    <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400\" size={20} />\n                    <input\n                        type=\"text\"\n                        placeholder=\"キーワードで検索（例：エンジニア、営業、Uターンなど）\"\n                        className=\"w-full pl-10 pr-4 py-3 rounded-xl border border-slate-200 bg-slate-50 focus:bg-white focus:ring-2 focus:ring-blue-500 transition-all font-bold text-slate-900 placeholder:text-slate-400\"\n                    />\n                </div>\n                {/* ... existing filter buttons ... */}\n            </div>\n\n            {/* Candidates Grid */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                {users.map((user) => {\n                    const isScouted = scoutedIds.includes(user.id) || interactions.some(i => i.type === 'scout' && i.fromId === currentCompanyId && i.toId === user.id);\n                    const isLiked = interactions.some(i => i.type === 'like_user' && i.fromId === currentCompanyId && i.toId === user.id);\n\n                    return (\n                        <div key={user.id} className=\"bg-white rounded-3xl border border-slate-100 shadow-sm overflow-hidden hover:shadow-md transition-shadow group relative flex flex-col h-full\">\n                            {isScouted && (\n                                <div className=\"absolute top-0 right-0 bg-blue-600 text-white text-xs font-bold px-3 py-1 rounded-bl-xl z-10 flex items-center gap-1\">\n                                    <CheckCircle size={12} /> スカウト済\n                                </div>\n                            )}\n\n                            <div className=\"p-6 flex-1\">\n                                <div className=\"flex items-start justify-between mb-4\">\n                                    <div className=\"flex items-center gap-3\">\n                                        <div className=\"relative\">\n                                            <img src={user.image} alt={user.name} className=\"w-12 h-12 rounded-full object-cover border border-slate-100\" />\n                                            {user.isOnline && (\n                                                <span className=\"absolute bottom-0 right-0 w-3 h-3 bg-green-500 border-2 border-white rounded-full\"></span>\n                                            )}\n                                        </div>\n                                        <div>\n                                            <h3 className=\"font-black text-slate-800 text-lg flex items-center gap-2\">\n                                                {user.name}\n                                                {user.id === 'u_yuji' && <span className=\"text-[10px] bg-red-100 text-red-600 px-1.5 py-0.5 rounded-md\">YOU</span>}\n                                            </h3>\n                                            <p className=\"text-xs font-bold text-slate-500\">{user.university}</p>\n                                        </div>\n                                    </div>\n                                </div>\n\n                                <div className=\"space-y-4\">\n                                    <div className=\"flex flex-wrap gap-2\">\n                                        {user.tags.map(tag => (\n                                            <span key={tag} className=\"px-2 py-1 bg-slate-100 text-slate-600 text-[10px] font-bold rounded-md\">\n                                                {tag}\n                                            </span>\n                                        ))}\n                                    </div>\n\n                                    <div className=\"space-y-2\">\n                                        <div className=\"flex items-center gap-2 text-xs text-slate-500 font-medium\">\n                                            <GraduationCap size={14} />\n                                            {user.faculty}\n                                        </div>\n                                        <p className=\"text-sm text-slate-600 font-medium line-clamp-3 leading-relaxed\">\n                                            {user.bio}\n                                        </p>\n                                    </div>\n                                </div>\n                            </div>\n\n                            <div className=\"p-4 bg-slate-50 border-t border-slate-100 flex gap-2\">\n                                <button\n                                    onClick={() => handleLike(user.id, user.name)}\n                                    disabled={isLiked}\n                                    className={`flex-1 py-2.5 rounded-xl border font-bold text-sm transition-colors ${isLiked\n                                        ? 'bg-pink-50 border-pink-200 text-pink-500'\n                                        : 'bg-white border-slate-200 text-slate-600 hover:bg-slate-100'\n                                        }`}\n                                >\n                                    {isLiked ? '保存済み' : '気になる'}\n                                </button>\n                                <button\n                                    onClick={() => handleScout(user.id, user.name)}\n                                    disabled={isScouted}\n                                    className={`flex-[2] py-2.5 rounded-xl font-bold text-sm transition-colors flex items-center justify-center gap-2 ${isScouted\n                                        ? 'bg-slate-200 text-slate-400 cursor-not-allowed'\n                                        : 'bg-blue-600 text-white hover:bg-blue-700'\n                                        }`}\n                                >\n                                    <MessageSquare size={16} />\n                                    {isScouted ? '送信済み' : 'スカウトを送る'}\n                                </button>\n                            </div>\n                        </div>\n                    )\n                })}\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/elearning/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/game/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useState' is defined but never used.","line":3,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":25,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useState"},"fix":{"range":[27,41],"text":""},"desc":"Remove unused variable \"useState\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AnimatePresence' is defined but never used.","line":4,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":33,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"AnimatePresence"},"fix":{"range":[71,88],"text":""},"desc":"Remove unused variable \"AnimatePresence\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'GameStats' is defined but never used.","line":5,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":38,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"GameStats"},"fix":{"range":[134,150],"text":""},"desc":"Remove unused variable \"GameStats\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { useGameStore, type GameStats } from '@/lib/gameStore';\nimport Link from 'next/link';\nimport {\n    Trophy, ArrowRight, Calendar, CircleDollarSign,\n    Briefcase, Coffee, LayoutDashboard, Sparkles, Zap, AlertCircle,\n    Clock, Star, Wrench, Play, Smile, UserCircle, Search, Swords, Book,\n    Users, Handshake, ShoppingBag, Backpack, Target\n} from 'lucide-react';\nimport { toast } from 'sonner';\nimport NovelPart from '@/components/game/NovelPart';\nimport QuizPart from '@/components/game/QuizPart';\nimport ActionGame from '@/components/game/ActionGame';\nimport ActionMenuPart from '@/components/game/ActionMenuPart';\nimport Image from 'next/image';\n\nexport default function GameDashboard() {\n    const {\n        stats, calendar, playerName, isInitialized, gameMode,\n        initGame, setGameMode, setActionType\n    } = useGameStore();\n\n    // If not initialized, show intro/naming screen\n    if (!isInitialized) {\n        return (\n            <div className=\"min-h-screen bg-slate-950 flex items-center justify-center p-6 relative overflow-hidden\">\n                {/* Decorative background glow */}\n                <div className=\"absolute w-[500px] h-[500px] bg-blue-600/20 rounded-full blur-[120px] -top-48 -left-48\" />\n                <div className=\"absolute w-[500px] h-[500px] bg-purple-600/20 rounded-full blur-[120px] -bottom-48 -right-48\" />\n\n                <motion.div\n                    initial={{ opacity: 0, scale: 0.9 }}\n                    animate={{ opacity: 1, scale: 1 }}\n                    className=\"bg-slate-900/50 backdrop-blur-3xl border border-white/10 rounded-[4rem] p-10 md:p-16 max-w-xl w-full text-center space-y-10 shadow-2xl relative z-10\"\n                >\n                    <div className=\"w-28 h-28 bg-gradient-to-tr from-blue-600 to-indigo-600 text-white rounded-[2.5rem] flex items-center justify-center mx-auto shadow-2xl shadow-blue-500/30\">\n                        <Trophy size={56} />\n                    </div>\n\n                    <div className=\"space-y-4\">\n                        <h1 className=\"text-5xl font-black text-white tracking-tighter leading-tight\">\n                            就活RPG <br /><span className=\"bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-purple-400\">Ehime Edition</span>\n                        </h1>\n                        <p className=\"text-slate-300 font-bold text-lg\">\n                            あなたの就活ストーリーが今、始まります。<br />\n                            14ヶ月の道のりを、自分らしく駆け抜けよう。\n                        </p>\n                    </div>\n\n                    <div className=\"space-y-6\">\n                        <div className=\"text-left space-y-3\">\n                            <label className=\"text-[10px] font-black text-blue-400 uppercase tracking-[0.3em] ml-6 block\">\n                                プレイヤー名\n                            </label>\n                            <input\n                                type=\"text\"\n                                placeholder=\"名前を入力してください\"\n                                className=\"w-full px-10 py-6 bg-white/10 border-2 border-white/20 focus:border-blue-400 rounded-[2.5rem] font-black text-2xl text-white transition-all outline-none placeholder:text-white/40 focus:bg-white/20\"\n                                id=\"playerNameInput\"\n                                defaultValue=\"まさる\"\n                            />\n                        </div>\n\n                        <button\n                            onClick={() => {\n                                const val = (document.getElementById('playerNameInput') as HTMLInputElement).value;\n                                initGame(val || 'まさる');\n                                toast.success('物語が始まりました！', {\n                                    style: {\n                                        background: '#1e293b',\n                                        color: '#fff',\n                                        border: '1px solid rgba(255,255,255,0.1)'\n                                    }\n                                });\n                            }}\n                            className=\"w-full bg-blue-600 text-white font-black py-6 rounded-[2.5rem] flex items-center justify-center gap-3 hover:bg-blue-500 transition-all active:scale-95 shadow-2xl shadow-blue-600/20 text-xl\"\n                        >\n                            冒険を始める <ArrowRight size={24} />\n                        </button>\n                    </div>\n                </motion.div>\n            </div>\n        );\n    }\n\n    if (gameMode === 'novel') return <NovelPart />;\n    if (gameMode === 'quiz') return <QuizPart />;\n    if (gameMode === 'action') return <ActionGame />;\n    if (gameMode === 'action_menu') return <ActionMenuPart />;\n\n    const handleAction = (type: string) => {\n        if (stats.stamina < 20 && type !== 'rest') {\n            toast.error('体力が足りません！休養しましょう。');\n            return;\n        }\n\n        setActionType(type);\n\n        switch (type) {\n            case 'study':\n            case 'work':\n                setGameMode('quiz');\n                break;\n            case 'play':\n                setGameMode('action');\n                break;\n            default:\n                setGameMode('action_menu');\n                break;\n        }\n    };\n\n    return (\n        <div className=\"min-h-screen bg-slate-950 text-white relative overflow-hidden font-sans\">\n            {/* Background Image for Strategy Part */}\n            <div className=\"absolute inset-0 z-0\">\n                <Image\n                    src=\"/game/bg/room_strategy.png\"\n                    alt=\"room\"\n                    fill\n                    className=\"object-cover opacity-30 blur-[2px]\"\n                />\n                <div className=\"absolute inset-0 bg-gradient-to-b from-slate-950/90 via-slate-950/20 to-slate-950/90\" />\n            </div>\n\n            {/* Top Bar - HUD */}\n            <header className=\"fixed top-0 left-0 w-full z-50 p-6\">\n                <div className=\"max-w-5xl mx-auto flex items-center justify-between gap-4\">\n                    <div className=\"flex items-center gap-4 bg-slate-900/60 backdrop-blur-3xl border border-white/10 px-6 py-4 rounded-[2rem] shadow-2xl\">\n                        <div className=\"bg-blue-600 p-2.5 rounded-xl shadow-lg shadow-blue-500/30\">\n                            <Calendar size={22} className=\"text-white\" />\n                        </div>\n                        <div className=\"flex items-baseline gap-1.5\">\n                            <span className=\"text-2xl font-black text-white\">{calendar.year}</span>\n                            <span className=\"text-[10px] font-black uppercase text-blue-400 tracking-wider\">Year</span>\n                            <span className=\"text-2xl font-black text-white ml-2\">{calendar.month}</span>\n                            <span className=\"text-[10px] font-black uppercase text-blue-400 tracking-wider\">Month</span>\n                            <span className=\"text-2xl font-black text-white ml-2\">{calendar.week}</span>\n                            <span className=\"text-[10px] font-black uppercase text-blue-400 tracking-wider\">Week</span>\n                        </div>\n                    </div>\n\n                    <div className=\"flex-1 max-w-xs bg-slate-900/40 border border-white/10 rounded-full h-12 overflow-hidden relative\">\n                        <div className=\"absolute inset-y-0 left-0 bg-blue-500/20 border-r border-blue-500/20 flex items-center px-4\">\n                            <span className=\"text-[10px] font-black text-blue-400 uppercase\">Mental</span>\n                        </div>\n                        <motion.div\n                            className=\"h-full bg-gradient-to-r from-blue-600 to-indigo-600\"\n                            initial={{ width: 0 }}\n                            animate={{ width: `${(stats.stamina / stats.maxStamina) * 100}%` }}\n                        />\n                    </div>\n\n                    <div className=\"flex items-center gap-4 bg-slate-900/60 backdrop-blur-3xl border border-white/10 px-6 py-4 rounded-[2rem] shadow-2xl\">\n                        <div className=\"bg-emerald-600 p-2.5 rounded-xl shadow-lg shadow-emerald-500/30\">\n                            <CircleDollarSign size={22} className=\"text-white\" />\n                        </div>\n                        <span className=\"text-2xl font-black tracking-tighter text-white\">{stats.money.toLocaleString()}</span>\n                        <span className=\"text-[10px] font-black uppercase text-emerald-400 tracking-wider\">Yen</span>\n                    </div>\n                </div>\n            </header>\n\n            <main className=\"max-w-6xl mx-auto pt-28 pb-32 px-6 grid grid-cols-1 lg:grid-cols-12 gap-10 items-start\">\n                {/* Left: Character Visual */}\n                <section className=\"lg:col-span-5 relative aspect-[3/4] lg:aspect-auto lg:h-[calc(100vh-240px)] rounded-[4rem] overflow-hidden group shadow-2xl border border-white/10 bg-slate-900/40\">\n                    <div className=\"absolute inset-x-0 bottom-0 h-1/2 bg-gradient-to-t from-slate-950 via-slate-950/40 to-transparent z-10\" />\n                    <Image\n                        src={`/game/chara/mc/male.png`}\n                        alt=\"Character\"\n                        fill\n                        className=\"object-contain object-bottom drop-shadow-[0_20px_50px_rgba(0,0,0,0.8)] z-20 transition-transform duration-700 group-hover:scale-105\"\n                    />\n\n                    {/* Character Guide Avatar (Mikan) */}\n                    <div className=\"absolute bottom-8 left-8 z-40 bg-slate-900/60 backdrop-blur-2xl border border-white/10 rounded-3xl p-4 flex items-center gap-4 shadow-2xl\">\n                        <div className=\"relative w-16 h-16 rounded-2xl overflow-hidden border border-white/10 shadow-lg\">\n                            <Image src=\"/game/chara/mikan/normal.png\" alt=\"Guide\" fill className=\"object-cover object-top\" />\n                        </div>\n                        <div>\n                            <div className=\"text-[10px] font-black text-blue-400 uppercase tracking-widest mb-0.5\">Guide</div>\n                            <div className=\"text-lg font-black text-white\">みかん先輩</div>\n                        </div>\n                    </div>\n\n                    <div className=\"absolute top-10 left-10 z-30 space-y-3\">\n                        <div className=\"flex items-center gap-3\">\n                            <div className=\"bg-blue-600 px-4 py-1.5 rounded-full text-[11px] font-black uppercase tracking-[0.2em] shadow-lg shadow-blue-500/40 border border-white/10\">Lv.{stats.level}</div>\n                            <h2 className=\"text-4xl font-black text-white drop-shadow-2xl\">{playerName}</h2>\n                        </div>\n                        <div className=\"w-64 h-2.5 bg-white/10 rounded-full overflow-hidden backdrop-blur-sm border border-white/5\">\n                            <motion.div\n                                className=\"h-full bg-gradient-to-r from-blue-400 via-indigo-400 to-purple-400 shadow-[0_0_15px_rgba(129,140,248,0.5)]\"\n                                initial={{ width: 0 }}\n                                animate={{ width: `${(stats.experience / (stats.level * 100)) * 100}%` }}\n                            />\n                        </div>\n                    </div>\n                </section>\n\n                {/* Right: Actions & Stats */}\n                <section className=\"lg:col-span-7 space-y-10\">\n                    {/* Essential Stats */}\n                    <div className=\"grid grid-cols-2 gap-5\">\n                        <StatCard icon={<Zap size={18} />} label=\"体力\" value={stats.stamina} max={stats.maxStamina} color=\"bg-emerald-500\" />\n                        <StatCard icon={<AlertCircle size={18} />} label=\"ストレス\" value={stats.stress} max={stats.maxStress} color=\"bg-amber-500\" />\n                    </div>\n\n                    {/* Param Grid */}\n                    <div className=\"bg-slate-900/40 backdrop-blur-3xl rounded-[3rem] border border-white/10 p-8 grid grid-cols-3 gap-6 shadow-xl\">\n                        <SmallStat icon={<Book size={16} />} label=\"知識\" value={stats.knowledge} color=\"text-blue-400\" />\n                        <SmallStat icon={<Clock size={16} />} label=\"忍耐\" value={stats.patience} color=\"text-emerald-400\" />\n                        <SmallStat icon={<Handshake size={16} />} label=\"対応\" value={stats.adaptability} color=\"text-amber-400\" />\n                        <SmallStat icon={<Star size={16} />} label=\"魅力\" value={stats.charm} color=\"text-pink-400\" />\n                        <SmallStat icon={<Wrench size={16} />} label=\"技術\" value={stats.skill} color=\"text-purple-400\" />\n                        <SmallStat icon={<Trophy size={16} />} label=\"総合\" value={Math.floor((stats.knowledge + stats.patience + stats.adaptability + stats.charm + stats.skill) / 5)} color=\"text-white\" />\n                    </div>\n\n                    {/* Action Grid (Expanded) */}\n                    <div className=\"space-y-4\">\n                        <div className=\"flex items-center gap-3 ml-2 mb-4\">\n                            <LayoutDashboard size={20} className=\"text-blue-500\" />\n                            <h3 className=\"text-xl font-black text-white tracking-tight uppercase italic text-blue-500\">Main Strategy</h3>\n                        </div>\n                        <div className=\"grid grid-cols-2 gap-4\">\n                            <ActionButton icon={<Play size={22} />} label=\"本を読む\" desc=\"知識+5 / 経験+10\" onClick={() => handleAction('study')} color=\"bg-blue-600\" />\n                            <ActionButton icon={<CircleDollarSign size={22} />} label=\"バイト\" desc=\"報酬+資金 / 経験+15\" onClick={() => handleAction('work')} color=\"bg-emerald-600\" />\n                            <ActionButton icon={<Search size={22} />} label=\"企業研究\" desc=\"スキル+5 / 知識+2\" onClick={() => handleAction('research')} color=\"bg-indigo-600\" />\n                            <ActionButton icon={<Sparkles size={22} />} label=\"自己分析\" desc=\"適応+3 / 技+2 / ストレス減\" onClick={() => handleAction('analyze')} color=\"bg-orange-400\" />\n                            <ActionButton icon={<Users size={22} />} label=\"模擬面接\" desc=\"応対+5 / 魅力+2\" onClick={() => handleAction('interview')} color=\"bg-orange-600\" />\n                            <ActionButton icon={<Briefcase size={22} />} label=\"インターン\" desc=\"大幅Skill+ / 体力減\" onClick={() => handleAction('intern')} color=\"bg-purple-600\" />\n                            <ActionButton icon={<Smile size={22} />} label=\"遊び\" desc=\"ストレス解消 / 魅力+\" onClick={() => handleAction('play')} color=\"bg-pink-600\" />\n                            <ActionButton icon={<Coffee size={22} />} label=\"休養\" desc=\"体力回復 / ストレス減\" onClick={() => handleAction('rest')} color=\"bg-white text-slate-950\" />\n                        </div>\n                        <div className=\"mt-6\">\n                            <Link href=\"/game\" className=\"block\">\n                                <button\n                                    onClick={() => toast.info('選考試験（バトル）は近日公開！')}\n                                    className=\"w-full bg-gradient-to-r from-red-600 to-rose-600 hover:from-red-500 hover:to-rose-500 text-white font-black py-8 rounded-[2.5rem] flex items-center justify-center gap-4 transition-all active:scale-95 shadow-2xl shadow-red-600/30 text-2xl italic tracking-tighter\"\n                                >\n                                    <Swords size={32} /> 選考試験へ進む\n                                </button>\n                            </Link>\n                        </div>\n                    </div>\n\n                    <div className=\"pt-4 flex gap-4\">\n                        <Link href=\"/mypage\" className=\"flex-1 bg-white/5 hover:bg-white/10 border border-white/10 py-6 rounded-[2.5rem] font-black text-center transition-all flex items-center justify-center gap-3 text-lg\">\n                            <LayoutDashboard size={20} className=\"text-blue-400\" />\n                            ポータルに戻る\n                        </Link>\n                    </div>\n                </section>\n            </main>\n\n            {/* Floating Navigation (Enhanced) */}\n            <nav className=\"fixed bottom-8 left-1/2 -translate-x-1/2 bg-slate-900/60 backdrop-blur-3xl border border-white/20 p-2.5 rounded-[2.5rem] flex items-center gap-1.5 z-50 shadow-[0_20px_50px_rgba(0,0,0,0.5)]\">\n                <NavButton active icon={<UserCircle size={22} />} label=\"ステータス\" />\n                <NavButton icon={<Search size={22} />} label=\"分析\" onClick={() => window.location.href = '/analysis'} />\n                <NavButton icon={<ShoppingBag size={22} />} label=\"ショップ\" onClick={() => toast.info('ショップ機能は近日公開！')} />\n                <NavButton icon={<Backpack size={22} />} label=\"持ち物\" onClick={() => toast.info('アイテム画面は近日公開！')} />\n                <NavButton icon={<Target size={22} />} label=\"ミッション\" onClick={() => toast.info('ミッションボードは近日公開！')} />\n            </nav>\n        </div>\n    );\n}\n\ninterface StatCardProps {\n    icon: React.ReactNode;\n    label: string;\n    value: number;\n    max: number;\n    color: string;\n}\n\nfunction StatCard({ icon, label, value, max, color }: StatCardProps) {\n    const percentage = Math.min(100, (value / max) * 100);\n    return (\n        <div className=\"bg-slate-900/60 backdrop-blur-md rounded-[2rem] p-6 border border-white/10 shadow-lg\">\n            <div className=\"flex items-center justify-between mb-4\">\n                <div className=\"flex items-center gap-2.5\">\n                    <div className={`${color} p-1.5 rounded-lg text-white shadow-lg`}>\n                        {icon}\n                    </div>\n                    <span className=\"text-xs font-black uppercase tracking-widest text-white/80\">{label}</span>\n                </div>\n                <span className=\"text-sm font-black text-white\">{value} <span className=\"text-white/30\">/ {max}</span></span>\n            </div>\n            <div className=\"h-2.5 bg-white/5 rounded-full overflow-hidden\">\n                <motion.div\n                    className={`h-full ${color} shadow-[0_0_15px_rgba(255,255,255,0.2)]`}\n                    initial={{ width: 0 }}\n                    animate={{ width: `${percentage}%` }}\n                />\n            </div>\n        </div>\n    );\n}\n\ninterface SmallStatProps {\n    icon: React.ReactNode;\n    label: string;\n    value: number;\n    color: string;\n}\n\nfunction SmallStat({ icon, label, value, color }: SmallStatProps) {\n    return (\n        <div className=\"text-center space-y-1.5 p-2 px-1\">\n            <div className=\"flex items-center justify-center gap-1.5 mb-1 bg-white/10 py-2 rounded-xl border border-white/10 shadow-sm\">\n                <span className={`${color} scale-100`}>{icon}</span>\n                <span className=\"text-[10px] font-black uppercase tracking-widest text-white/80\">{label}</span>\n            </div>\n            <div className={`text-2xl font-black ${color} tracking-tighter drop-shadow-sm`}>{value}</div>\n        </div>\n    );\n}\n\ninterface ActionButtonProps {\n    icon: React.ReactNode;\n    label: string;\n    desc: string;\n    onClick: () => void;\n    color: string;\n}\n\nfunction ActionButton({ icon, label, desc, onClick, color }: ActionButtonProps) {\n    const isWhite = color.includes('bg-white');\n    return (\n        <button\n            onClick={onClick}\n            className={`group p-6 rounded-[2rem] text-left transition-all active:scale-95 border border-white/10 hover:border-white/20 relative overflow-hidden shadow-xl ${isWhite ? color : 'bg-slate-900/80 hover:bg-slate-800'}`}\n        >\n            <div className={`w-12 h-12 rounded-2xl flex items-center justify-center mb-4 shadow-2xl transition-transform group-hover:scale-110 ${isWhite ? 'bg-slate-100 text-slate-900' : color + ' text-white'}`}>\n                {icon}\n            </div>\n            <div className={`text-lg font-black tracking-tight ${isWhite ? 'text-slate-900' : 'text-white'}`}>{label}</div>\n            <div className={`text-[11px] font-bold mt-1.5 ${isWhite ? 'text-slate-500' : 'text-white/60'}`}>{desc}</div>\n        </button>\n    );\n}\n\ninterface NavButtonProps {\n    icon: React.ReactNode;\n    label: string;\n    active?: boolean;\n    onClick?: () => void;\n}\n\nfunction NavButton({ icon, label, active = false, onClick }: NavButtonProps) {\n    return (\n        <button\n            onClick={onClick}\n            className={`flex items-center gap-2 px-6 py-3 rounded-2xl transition-all ${active ? 'bg-blue-500 text-white font-black shadow-lg shadow-blue-500/20' : 'text-white/70 hover:text-white font-bold'}`}\n        >\n            {icon}\n            <span className=\"text-xs\">{label}</span>\n        </button>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/jobs/[id]/page.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":132,"column":25,"nodeType":"JSXOpeningElement","endLine":136,"endColumn":27}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { use, useState } from 'react';\nimport { JOBS, COMPANIES } from '@/lib/dummyData';\nimport {\n    Heart, MessageCircle,\n    Zap, Info, CheckCircle2,\n    ChevronLeft, Share2\n} from 'lucide-react';\nimport Link from 'next/link';\nimport { toast } from 'sonner';\nimport { useAppStore } from '@/lib/appStore';\nimport { useRouter } from 'next/navigation';\nimport { ConsultModal } from '@/components/modals/ConsultModal';\nimport { LoginPromptModal } from '@/components/auth/LoginPromptModal';\nimport { ReelIcon } from '@/components/reels/ReelIcon';\nimport { ReelModal } from '@/components/reels/ReelModal';\nimport { Reel } from '@/lib/dummyData';\n\nexport default function JobDetailPage({ params }: { params: Promise<{ id: string }> }) {\n    const { id } = use(params);\n    const router = useRouter();\n    const job = JOBS.find(j => j.id === id);\n    const company = job ? COMPANIES.find(c => c.id === job.companyId) : null;\n    const [isConsultModalOpen, setIsConsultModalOpen] = useState(false);\n    const [isLoginPromptOpen, setIsLoginPromptOpen] = useState(false);\n    const [loginPromptMessage, setLoginPromptMessage] = useState('');\n\n    // Reel State\n    const [isReelModalOpen, setIsReelModalOpen] = useState(false);\n    const [activeReels, setActiveReels] = useState<Reel[]>([]);\n    const [activeEntity, setActiveEntity] = useState<{ name: string, id: string, companyId?: string }>({ name: '', id: '' });\n\n    const handleShare = () => {\n        const url = window.location.href;\n        navigator.clipboard.writeText(url).then(() => {\n            toast.success('共有リンクをクリップボードにコピーしました');\n        }).catch(() => {\n            toast.error('リンクのコピーに失敗しました');\n        });\n    };\n\n    // Use unified AppStore\n    const {\n        authStatus,\n        currentUserId,\n        addInteraction,\n        removeInteraction,\n        hasInteraction,\n        createChat\n    } = useAppStore();\n\n    // Prevent hydration mismatch by handling state carefully or assuming client-side rendering is fine for this demo\n    // Check interactions from the store\n    const isLiked = hasInteraction('like_job', currentUserId, id);\n    const isApplied = hasInteraction('apply', currentUserId, id);\n\n    if (!job || !company) {\n        return (\n            <div className=\"flex flex-col items-center justify-center min-h-[60vh] p-8 text-center\">\n                <h2 className=\"text-2xl font-bold text-zinc-800\">クエストが見つかりませんでした</h2>\n                <Link href=\"/jobs\" className=\"mt-4 text-blue-500 font-bold underline\">求人一覧に戻る</Link>\n            </div>\n        );\n    }\n\n    const handleApply = () => {\n        if (authStatus !== 'authenticated') {\n            setLoginPromptMessage('クエストへの参加申請にはログインが必要です');\n            setIsLoginPromptOpen(true);\n            return;\n        }\n        if (isApplied) return;\n        addInteraction({ type: 'apply', fromId: currentUserId, toId: id });\n        toast.success('クエストへの参加を申請しました！\\n企業からの連絡をお待ちください');\n    };\n\n    const handleConsultClick = () => {\n        if (authStatus !== 'authenticated') {\n            setLoginPromptMessage('カジュアル面談の申し込みにはログインが必要です');\n            setIsLoginPromptOpen(true);\n            return;\n        }\n        setIsConsultModalOpen(true);\n    };\n\n    const handleConsultConfirm = () => {\n        setIsConsultModalOpen(false);\n        // Create chat in the unified store\n        const chatId = createChat(company.id, currentUserId, `「${job.title}」について相談がしたいです。`);\n        toast.success('カジュアル面談の希望を送信しました');\n        router.push(`/messages/${chatId}`);\n    };\n\n    const toggleLike = () => {\n        if (authStatus !== 'authenticated') {\n            setLoginPromptMessage('気になるリストへの保存にはログインが必要です');\n            setIsLoginPromptOpen(true);\n            return;\n        }\n        if (isLiked) {\n            removeInteraction('like_job', currentUserId, id);\n            toast.success('「気になる」を解除しました');\n        } else {\n            addInteraction({ type: 'like_job', fromId: currentUserId, toId: id });\n            toast.success('「気になる」リストに保存しました');\n        }\n    };\n\n    return (\n        <div className=\"min-h-screen bg-white md:bg-zinc-50 pb-24\">\n            {/* Header / Nav */}\n            <nav className=\"sticky top-0 md:top-0 z-40 bg-white/80 backdrop-blur-md border-b border-zinc-100 flex items-center justify-between px-6 py-4 md:px-12\">\n                <Link href=\"/jobs\" className=\"p-2 hover:bg-zinc-100 rounded-full transition-colors text-zinc-600\">\n                    <ChevronLeft size={24} />\n                </Link>\n                <h1 className=\"text-sm font-black tracking-tight text-zinc-800 uppercase\">求人詳細</h1>\n                <div className=\"flex items-center gap-2\">\n                    <button\n                        onClick={handleShare}\n                        className=\"p-2 hover:bg-zinc-100 rounded-full transition-colors text-zinc-600\"\n                    >\n                        <Share2 size={20} />\n                    </button>\n                </div>\n            </nav>\n\n            <main className=\"max-w-4xl mx-auto md:py-8 md:px-6 space-y-6\">\n                {/* Main Info Card */}\n                <section className=\"bg-white md:rounded-[2.5rem] md:shadow-xl md:border border-zinc-100 overflow-hidden\">\n                    <div className=\"relative h-48 md:h-64 overflow-hidden\">\n                        <img\n                            src={company.image}\n                            alt={company.name}\n                            className=\"w-full h-full object-cover\"\n                        />\n                        <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent\" />\n\n                        <div className=\"absolute bottom-6 left-6 text-white px-2 pr-32\">\n                            <span className=\"text-[10px] font-black uppercase tracking-widest opacity-80\">{company.industry}</span>\n                            <h2 className=\"text-2xl md:text-3xl font-black mt-1 leading-tight\">{job.title}</h2>\n                        </div>\n\n                        <div className=\"absolute top-6 right-6 flex flex-col gap-4 items-end\">\n                            <button\n                                onClick={() => {\n                                    toggleLike();\n                                }}\n                                className={`w-12 h-12 backdrop-blur-md rounded-2xl flex items-center justify-center transition-all ${isLiked ? 'bg-red-500 text-white' : 'bg-white/20 text-white hover:bg-white/30'}`}\n                            >\n                                <Heart size={20} fill={isLiked ? \"currentColor\" : \"none\"} />\n                            </button>\n\n                            {(company.reels && company.reels.length > 0) && (\n                                <div className=\"transition-transform hover:scale-110\">\n                                    <ReelIcon\n                                        reels={company.reels}\n                                        fallbackImage={company.image}\n                                        onClick={() => {\n                                            setActiveReels(company.reels || []);\n                                            setActiveEntity({ name: job.title, id: job.id, companyId: company.id });\n                                            setIsReelModalOpen(true);\n                                        }}\n                                    />\n                                </div>\n                            )}\n                        </div>\n                    </div>\n\n                    <div className=\"p-8 space-y-8\">\n                        {/* Recommended Points */}\n                        <div className=\"bg-zinc-50 rounded-[2rem] p-6 border border-zinc-100\">\n                            <div className=\"flex items-center gap-2 mb-4 text-zinc-800\">\n                                <CheckCircle2 className=\"text-eis-yellow\" />\n                                <h3 className=\"text-lg font-black\">このクエストのおすすめポイント</h3>\n                            </div>\n                            <ul className=\"space-y-3\">\n                                <li className=\"flex items-start gap-3\">\n                                    <CheckCircle2 size={18} className=\"text-blue-500 shrink-0 mt-0.5\" />\n                                    <p className=\"text-sm font-bold text-zinc-600\">未経験からでも「愛媛のプロ」を目指せる伴走型の指導体制。</p>\n                                </li>\n                                <li className=\"flex items-start gap-3\">\n                                    <CheckCircle2 size={18} className=\"text-blue-500 shrink-0 mt-0.5\" />\n                                    <p className=\"text-sm font-bold text-zinc-600\">地元愛媛に根付いた、やりがいと確かな技術力が手に入ります。</p>\n                                </li>\n                            </ul>\n                        </div>\n\n                        {/* RJP Section - Login Required */}\n                        <div>\n                            <div className=\"flex items-center gap-2 mb-4\">\n                                <div className=\"bg-orange-100 p-2 rounded-lg text-orange-600\"><Info size={20} /></div>\n                                <h3 className=\"text-lg font-black text-zinc-800 italic\">正直な不完全さ（RJP）</h3>\n                            </div>\n                            {authStatus === 'authenticated' ? (\n                                <p className=\"bg-orange-50/50 border border-orange-100 p-6 rounded-2xl text-zinc-600 text-sm leading-relaxed italic\">\n                                    「{company.rjpNegatives}」\n                                </p>\n                            ) : (\n                                <div\n                                    onClick={() => {\n                                        setLoginPromptMessage('企業の本音トークを見るにはログインが必要です');\n                                        setIsLoginPromptOpen(true);\n                                    }}\n                                    className=\"bg-orange-50/50 border-2 border-orange-200 border-dashed p-6 rounded-2xl cursor-pointer hover:bg-orange-100/50 transition-all group\"\n                                >\n                                    <div className=\"text-center\">\n                                        <div className=\"text-orange-600 mb-2 font-black text-lg\">🔒 ログインして本音を見る</div>\n                                        <p className=\"text-sm text-zinc-600\">Ehime Baseならではの、企業の「正直な不完全さ」を知ることができます</p>\n                                    </div>\n                                </div>\n                            )}\n                        </div>\n\n                        {/* Basic Info Table */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-black text-zinc-800 border-l-4 border-eis-navy pl-4\">募集要項</h3>\n                            <div className=\"grid grid-cols-1 gap-6\">\n                                <div className=\"bg-zinc-50 rounded-2xl p-6 border border-zinc-100\">\n                                    <span className=\"block text-xs text-zinc-400 font-black uppercase mb-1\">給与・報酬</span>\n                                    <p className=\"text-lg font-bold text-zinc-900\">{job.salary || job.reward || '経験・能力を考慮の上決定'}</p>\n                                </div>\n\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                                    <div className=\"border-b md:border-b-0 md:border-r border-zinc-100 pb-4 md:pb-0 md:pr-6\">\n                                        <span className=\"block text-xs text-zinc-400 font-black uppercase mb-1\">勤務時間</span>\n                                        <p className=\"text-base font-bold text-zinc-700\">{job.workingHours || '-'}</p>\n                                    </div>\n                                    <div className=\"pb-4 md:pb-0\">\n                                        <span className=\"block text-xs text-zinc-400 font-black uppercase mb-1\">休日・休暇</span>\n                                        <p className=\"text-base font-bold text-zinc-700\">{job.holidays || '-'}</p>\n                                    </div>\n                                </div>\n\n                                <div className=\"bg-zinc-50 rounded-2xl p-6 border border-zinc-100\">\n                                    <span className=\"block text-xs text-zinc-400 font-black uppercase mb-1\">待遇・福利厚生</span>\n                                    <p className=\"text-sm font-medium text-zinc-700 leading-relaxed whitespace-pre-wrap\">{job.welfare || company.benefits || '-'}</p>\n                                </div>\n\n                                <div className=\"bg-zinc-50 rounded-2xl p-6 border border-zinc-100\">\n                                    <span className=\"block text-xs text-zinc-400 font-black uppercase mb-1\">選考フロー</span>\n                                    <p className=\"text-sm font-bold text-zinc-700\">{job.selectionProcess || '-'}</p>\n                                </div>\n\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 pt-4 border-t border-zinc-100\">\n                                    <div>\n                                        <span className=\"block text-xs text-zinc-400 font-black uppercase mb-1\">勤務地</span>\n                                        <p className=\"text-sm font-bold text-zinc-700\">{company.location}</p>\n                                    </div>\n                                    <div>\n                                        <span className=\"block text-xs text-zinc-400 font-black uppercase mb-1\">雇用形態</span>\n                                        <p className=\"text-sm font-bold text-zinc-700\">{job.category}</p>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </section>\n            </main>\n\n            {/* Floating Action Bar (Mobile Only Style or Shared) */}\n            <div className=\"fixed bottom-0 left-0 right-0 p-4 md:p-6 bg-white/80 backdrop-blur-xl border-t border-zinc-100 z-50\">\n                <div className=\"max-w-4xl mx-auto flex items-center gap-4\">\n                    <button\n                        onClick={() => {\n                            toggleLike();\n                        }}\n                        className={`hidden md:flex flex-col items-center justify-center p-2 hover:text-zinc-600 ${isLiked ? 'text-red-500' : 'text-zinc-400'}`}\n                    >\n                        <Heart size={24} fill={isLiked ? \"currentColor\" : \"none\"} />\n                        <span className=\"text-[10px] font-black\">{isLiked ? '保存済み' : '気になる'}</span>\n                    </button>\n\n                    <button\n                        onClick={handleApply}\n                        disabled={isApplied}\n                        className={`flex-1 font-black py-4 rounded-2xl md:rounded-3xl transition-all flex items-center justify-center gap-2 shadow-xl ${isApplied ? 'bg-zinc-200 text-zinc-500 cursor-not-allowed' : 'bg-zinc-900 text-white hover:bg-zinc-800 shadow-zinc-200'}`}\n                    >\n                        {isApplied ? (\n                            <>\n                                <CheckCircle2 size={20} />\n                                申し込み済み\n                            </>\n                        ) : (\n                            <>\n                                <Zap size={20} className=\"text-eis-yellow\" />\n                                クエストに参加する\n                            </>\n                        )}\n                    </button>\n\n                    <button\n                        onClick={handleConsultClick}\n                        className=\"w-14 h-14 md:w-auto md:px-8 bg-eis-yellow text-zinc-900 font-black rounded-2xl md:rounded-3xl flex items-center justify-center gap-2 hover:bg-yellow-400 transition-all shadow-xl shadow-yellow-100\"\n                    >\n                        <MessageCircle size={24} />\n                        <span className=\"hidden md:block\">カジュアル面談を希望する</span>\n                    </button>\n                </div>\n            </div>\n\n            <ConsultModal\n                isOpen={isConsultModalOpen}\n                onClose={() => setIsConsultModalOpen(false)}\n                onConfirm={handleConsultConfirm}\n                companyName={company.name}\n            />\n\n            <LoginPromptModal\n                isOpen={isLoginPromptOpen}\n                onClose={() => setIsLoginPromptOpen(false)}\n                message={loginPromptMessage}\n            />\n\n            <ReelModal\n                isOpen={isReelModalOpen}\n                onClose={() => setIsReelModalOpen(false)}\n                reels={activeReels}\n                entityName={activeEntity.name}\n                entityId={activeEntity.id}\n                entityType=\"job\"\n                companyId={activeEntity.companyId}\n            />\n        </div >\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/jobs/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowRight' is defined but never used.","line":8,"column":110,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":120,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowRight"},"fix":{"range":[351,363],"text":""},"desc":"Remove unused variable \"ArrowRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'activeRole' is assigned a value but never used.","line":15,"column":46,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":56},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":400,"column":57,"nodeType":"JSXOpeningElement","endLine":400,"endColumn":191},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":414,"column":65,"nodeType":"JSXOpeningElement","endLine":414,"endColumn":128}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState, Suspense } from 'react';\nimport Link from 'next/link';\nimport { useAppStore } from '@/lib/appStore';\nimport { JOBS, COMPANIES } from '@/lib/dummyData';\nimport { useSearchParams } from 'next/navigation';\nimport { Building2, Heart, Search, Filter, X, ChevronDown, ChevronUp, MapPin, Briefcase, JapaneseYen, Clock, ArrowRight } from 'lucide-react';\nimport { ReelIcon } from '@/components/reels/ReelIcon';\nimport { ReelModal } from '@/components/reels/ReelModal';\nimport { Reel } from '@/lib/dummyData';\n\nfunction JobsContent() {\n    const searchParams = useSearchParams();\n    const { interactions, toggleInteraction, activeRole, currentUserId } = useAppStore();\n\n    // Mapping area parameter to regional keywords\n    const areaMap: Record<string, string> = {\n        'chuyo': '中予',\n        'toyo': '東予',\n        'nanyo': '南予',\n    };\n\n    const initialQ = searchParams.get('q') || '';\n    const initialAreaParam = searchParams.get('area') || '';\n    const initialIndustry = searchParams.get('industry') || '';\n    const initialArea = areaMap[initialAreaParam] || '';\n\n    // State\n    const [searchQuery, setSearchQuery] = useState(initialQ);\n    const [selectedArea, setSelectedArea] = useState(initialArea);\n    const [selectedIndustry, setSelectedIndustry] = useState(initialIndustry);\n    const [selectedTags, setSelectedTags] = useState<string[]>([]);\n    const [selectedConditions, setSelectedConditions] = useState<string[]>([]);\n    const [isFilterOpen, setIsFilterOpen] = useState(false);\n\n    // Filter sync (optional: if you want to update when URL changes without full reload)\n    // For now, let's keep it simple with initial state.\n\n    // Reel State\n    const [isReelModalOpen, setIsReelModalOpen] = useState(false);\n    const [activeReels, setActiveReels] = useState<Reel[]>([]);\n    const [activeEntity, setActiveEntity] = useState<{ name: string, id: string, companyId?: string }>({ name: '', id: '' });\n\n    // Data Extraction\n    const allJobItems = JOBS.filter(j => j.type === 'job');\n    const allTags = Array.from(new Set(allJobItems.flatMap(j => j.tags)));\n\n    // Filtering Logic\n    const filteredJobs = allJobItems.filter(job => {\n        const company = COMPANIES.find(c => c.id === job.companyId);\n        const query = searchQuery.toLowerCase();\n\n        // 1. Keyword Search\n        const matchesSearch = !query ||\n            job.title.toLowerCase().includes(query) ||\n            company?.name.toLowerCase().includes(query) ||\n            job.location?.toLowerCase().includes(query) ||\n            job.tags.some(t => t.toLowerCase().includes(query));\n\n        // 2. Area Filter\n        const regionCities: Record<string, string[]> = {\n            '中予': ['松山', '伊予', '東温', '久万高原', '松前', '砥部'],\n            '東予': ['今治', '新居浜', '西条', '四国中央', '上島'],\n            '南予': ['宇和島', '八幡浜', '大洲', '西予', '内子', '伊方', '松野', '鬼北', '愛南']\n        };\n        const cities = regionCities[selectedArea] || [];\n        const matchesArea = !selectedArea ||\n            job.location?.includes(selectedArea) ||\n            company?.location?.includes(selectedArea) ||\n            cities.some(city => job.location?.includes(city) || company?.location?.includes(city));\n\n        // 3. Industry Filter\n        const matchesIndustry = !selectedIndustry || company?.industry === selectedIndustry;\n\n        // 4. Tag Filter\n        const matchesTags = selectedTags.length === 0 || selectedTags.some(t => job.tags.includes(t));\n\n        // 4. Condition Filter (Ehime Base Style)\n        let matchesConditions = true;\n        if (selectedConditions.length > 0) {\n            // AND logic: all selected conditions must be met\n            if (selectedConditions.includes('unexperienced')) {\n                const isUnexperienced = !job.isExperience || job.tags.some(t => ['未経験OK', '新卒', '未経験'].includes(t));\n                if (!isUnexperienced) matchesConditions = false;\n            }\n            if (selectedConditions.includes('remote')) {\n                const isRemote = job.tags.some(t => ['リモート', 'テレワーク', '在宅'].includes(t)) || job.welfare?.includes('リモート');\n                if (!isRemote) matchesConditions = false;\n            }\n            if (selectedConditions.includes('weekend')) {\n                const isWeekend = job.tags.includes('土日祝休み') || job.holidays?.includes('土日');\n                if (!isWeekend) matchesConditions = false;\n            }\n        }\n\n        return matchesSearch && matchesArea && matchesIndustry && matchesTags && matchesConditions;\n    });\n\n    const isLiked = (jobId: string) => {\n        return interactions.some(i => i.type === 'like_job' && i.fromId === currentUserId && i.toId === jobId);\n    };\n\n    const toggleLike = (jobId: string, e: React.MouseEvent) => {\n        e.preventDefault();\n        e.stopPropagation();\n        toggleInteraction('like_job', currentUserId, jobId);\n    };\n\n    const toggleTag = (tag: string) => {\n        if (selectedTags.includes(tag)) {\n            setSelectedTags(selectedTags.filter(t => t !== tag));\n        } else {\n            setSelectedTags([...selectedTags, tag]);\n        }\n    };\n\n    const toggleCondition = (condition: string) => {\n        if (selectedConditions.includes(condition)) {\n            setSelectedConditions(selectedConditions.filter(c => c !== condition));\n        } else {\n            setSelectedConditions([...selectedConditions, condition]);\n        }\n    };\n\n    const clearFilters = () => {\n        setSearchQuery('');\n        setSelectedArea('');\n        setSelectedIndustry('');\n        setSelectedTags([]);\n        setSelectedConditions([]);\n    };\n\n    const activeFilterCount = selectedTags.length + selectedConditions.length + (selectedArea ? 1 : 0) + (selectedIndustry ? 1 : 0);\n\n    return (\n        <div className=\"min-h-screen bg-slate-50 pb-24 md:pb-0 text-slate-900\">\n            {/* Unified Header Section */}\n            <div className=\"bg-white border-b border-slate-100 shadow-sm sticky top-0 z-20\">\n                <div className=\"max-w-7xl mx-auto p-4 md:p-6\">\n                    <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-4\">\n                        <div>\n                            <h1 className=\"text-2xl md:text-3xl font-black text-slate-800 flex items-center gap-3 tracking-tighter\">\n                                <Briefcase size={32} className=\"text-blue-600\" />\n                                求人情報一覧\n                            </h1>\n                            <p className=\"text-slate-500 font-bold mt-1 text-xs md:text-sm pl-11\">\n                                愛媛県内の魅力的な企業の求人情報。\n                            </p>\n                        </div>\n                    </div>\n\n                    {/* Unified Search & Filter Bar */}\n                    <div className=\"bg-slate-50 p-2 rounded-2xl border border-slate-200 shadow-inner\">\n                        <div className=\"relative flex items-center\">\n                            <div className=\"absolute left-4 text-slate-400 pointer-events-none\">\n                                <Search size={20} />\n                            </div>\n                            <input\n                                type=\"text\"\n                                placeholder=\"キーワード検索 (職種, 企業名, 地域など)\"\n                                value={searchQuery}\n                                onChange={(e) => setSearchQuery(e.target.value)}\n                                className=\"w-full pl-12 pr-4 py-3.5 rounded-xl bg-slate-50 border-none focus:ring-0 font-bold text-slate-700 text-base placeholder:font-medium placeholder:text-slate-400\"\n                            />\n                            <div className=\"flex items-center gap-2 pr-2\">\n                                {(activeFilterCount > 0 || searchQuery) && (\n                                    <button\n                                        onClick={clearFilters}\n                                        className=\"p-2 hover:bg-slate-200 rounded-full text-slate-400 transition-colors\"\n                                        title=\"検索条件をクリア\"\n                                    >\n                                        <X size={20} />\n                                    </button>\n                                )}\n                                <button\n                                    onClick={() => setIsFilterOpen(!isFilterOpen)}\n                                    className={`flex items-center gap-2 px-5 py-2.5 rounded-xl font-bold transition-all whitespace-nowrap shadow-sm border ${isFilterOpen || activeFilterCount > 0\n                                        ? 'bg-slate-800 text-white border-slate-800 shadow-md transform scale-105'\n                                        : 'bg-white text-slate-600 border-slate-200 hover:bg-slate-100'\n                                        }`}\n                                >\n                                    <Filter size={18} />\n                                    <span className=\"hidden md:inline\">絞り込み</span>\n                                    {activeFilterCount > 0 && (\n                                        <span className=\"bg-blue-500 text-white text-[10px] px-1.5 py-0.5 rounded-full ml-1 min-w-[18px] text-center font-bold\">\n                                            {activeFilterCount}\n                                        </span>\n                                    )}\n                                    {isFilterOpen ? <ChevronUp size={16} /> : <ChevronDown size={16} />}\n                                </button>\n                            </div>\n                        </div>\n\n                        {/* Applied Filters Tags */}\n                        {(searchQuery || activeFilterCount > 0) && (\n                            <div className=\"flex flex-wrap items-center gap-2 px-4 py-2 bg-white/40 border-t border-slate-100/50\">\n                                <span className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest mr-1\">適用中:</span>\n                                {searchQuery && (\n                                    <span className=\"flex items-center gap-1 px-2 py-0.5 bg-blue-50 text-blue-700 text-[10px] font-black rounded-md border border-blue-100\">\n                                        キーワード: {searchQuery}\n                                        <X size={10} className=\"cursor-pointer\" onClick={() => setSearchQuery('')} />\n                                    </span>\n                                )}\n                                {selectedArea && (\n                                    <span className=\"flex items-center gap-1 px-2 py-0.5 bg-amber-50 text-amber-700 text-[10px] font-black rounded-md border border-amber-100\">\n                                        エリア: {selectedArea}\n                                        <X size={10} className=\"cursor-pointer\" onClick={() => setSelectedArea('')} />\n                                    </span>\n                                )}\n                                {selectedIndustry && (\n                                    <span className=\"flex items-center gap-1 px-2 py-0.5 bg-indigo-50 text-indigo-700 text-[10px] font-black rounded-md border border-indigo-100\">\n                                        業種: {selectedIndustry}\n                                        <X size={10} className=\"cursor-pointer\" onClick={() => setSelectedIndustry('')} />\n                                    </span>\n                                )}\n                                {selectedConditions.includes('unexperienced') && (\n                                    <span className=\"flex items-center gap-1 px-2 py-0.5 bg-green-50 text-green-700 text-[10px] font-black rounded-md border border-green-100\">\n                                        未経験歓迎\n                                        <X size={10} className=\"cursor-pointer\" onClick={() => toggleCondition('unexperienced')} />\n                                    </span>\n                                )}\n                                {selectedConditions.includes('remote') && (\n                                    <span className=\"flex items-center gap-1 px-2 py-0.5 bg-purple-50 text-purple-700 text-[10px] font-black rounded-md border border-purple-100\">\n                                        リモート\n                                        <X size={10} className=\"cursor-pointer\" onClick={() => toggleCondition('remote')} />\n                                    </span>\n                                )}\n                                {selectedConditions.includes('weekend') && (\n                                    <span className=\"flex items-center gap-1 px-2 py-0.5 bg-orange-50 text-orange-700 text-[10px] font-black rounded-md border border-orange-100\">\n                                        土日祝休み\n                                        <X size={10} className=\"cursor-pointer\" onClick={() => toggleCondition('weekend')} />\n                                    </span>\n                                )}\n                                {selectedTags.map(tag => (\n                                    <span key={tag} className=\"flex items-center gap-1 px-2 py-0.5 bg-slate-100 text-slate-700 text-[10px] font-black rounded-md border border-slate-200\">\n                                        #{tag}\n                                        <X size={10} className=\"cursor-pointer\" onClick={() => toggleTag(tag)} />\n                                    </span>\n                                ))}\n                            </div>\n                        )}\n\n                        {/* Collapsible Detailed Filters */}\n                        <div\n                            className={`overflow-hidden transition-all duration-300 ease-in-out ${isFilterOpen ? 'max-h-[800px] opacity-100' : 'max-h-0 opacity-0'\n                                }`}\n                        >\n                            <div className=\"p-4 md:p-6 border-t border-slate-200 bg-white/50 rounded-b-xl space-y-6 mt-2\">\n                                {/* Area Filter */}\n                                <div>\n                                    <div className=\"flex items-center gap-2 mb-3\">\n                                        <span className=\"text-sm font-black text-slate-700\">エリア</span>\n                                    </div>\n                                    <div className=\"flex flex-wrap gap-2\">\n                                        {['中予', '東予', '南予'].map(area => (\n                                            <button\n                                                key={area}\n                                                onClick={() => setSelectedArea(selectedArea === area ? '' : area)}\n                                                className={`px-4 py-2.5 rounded-full text-sm font-bold transition-all border shadow-sm hover:-translate-y-0.5 ${selectedArea === area\n                                                    ? 'bg-amber-500 text-white border-amber-500 ring-2 ring-amber-200'\n                                                    : 'bg-white text-slate-600 border-slate-200 hover:border-slate-300 hover:shadow-md'\n                                                    }`}\n                                            >\n                                                {area}\n                                            </button>\n                                        ))}\n                                    </div>\n                                </div>\n\n                                {/* Industry Filter */}\n                                <div>\n                                    <div className=\"flex items-center gap-2 mb-3\">\n                                        <span className=\"text-sm font-black text-slate-700\">業種</span>\n                                    </div>\n                                    <div className=\"flex flex-wrap gap-2\">\n                                        {[\n                                            'IT・システム開発',\n                                            '製造・エンジニアリング',\n                                            'サービス・観光・飲食店',\n                                            '農業・一次産業',\n                                            '物流・運送',\n                                            '医療・福祉',\n                                            'その他'\n                                        ].map(industry => (\n                                            <button\n                                                key={industry}\n                                                onClick={() => setSelectedIndustry(selectedIndustry === industry ? '' : industry)}\n                                                className={`px-4 py-2.5 rounded-full text-sm font-bold transition-all border shadow-sm hover:-translate-y-0.5 ${selectedIndustry === industry\n                                                    ? 'bg-indigo-600 text-white border-indigo-600 ring-2 ring-indigo-200'\n                                                    : 'bg-white text-slate-600 border-slate-200 hover:border-slate-300 hover:shadow-md'\n                                                    }`}\n                                            >\n                                                {industry}\n                                            </button>\n                                        ))}\n                                    </div>\n                                </div>\n\n                                {/* Conditions */}\n                                <div>\n                                    <div className=\"flex items-center gap-2 mb-3\">\n                                        <span className=\"text-sm font-black text-slate-700\">こだわり条件</span>\n                                    </div>\n                                    <div className=\"flex flex-wrap gap-3\">\n                                        <button\n                                            onClick={() => toggleCondition('unexperienced')}\n                                            className={`px-5 py-2.5 rounded-full text-sm font-bold transition-all border shadow-sm hover:-translate-y-0.5 ${selectedConditions.includes('unexperienced') ? 'bg-green-50 border-green-400 text-green-700 ring-2 ring-green-100' : 'bg-white border-slate-200 text-slate-600 hover:border-slate-300 hover:shadow-md'}`}\n                                        >\n                                            🔰 未経験歓迎\n                                        </button>\n                                        <button\n                                            onClick={() => toggleCondition('remote')}\n                                            className={`px-5 py-2.5 rounded-full text-sm font-bold transition-all border shadow-sm hover:-translate-y-0.5 ${selectedConditions.includes('remote') ? 'bg-purple-50 border-purple-400 text-purple-700 ring-2 ring-purple-100' : 'bg-white border-slate-200 text-slate-600 hover:border-slate-300 hover:shadow-md'}`}\n                                        >\n                                            🏠 リモート・在宅\n                                        </button>\n                                        <button\n                                            onClick={() => toggleCondition('weekend')}\n                                            className={`px-5 py-2.5 rounded-full text-sm font-bold transition-all border shadow-sm hover:-translate-y-0.5 ${selectedConditions.includes('weekend') ? 'bg-orange-50 border-orange-400 text-orange-700 ring-2 ring-orange-100' : 'bg-white border-slate-200 text-slate-600 hover:border-slate-300 hover:shadow-md'}`}\n                                        >\n                                            📅 土日祝休み\n                                        </button>\n                                    </div>\n                                </div>\n\n                                {/* Tags */}\n                                <div>\n                                    <div className=\"flex items-center gap-2 mb-3\">\n                                        <span className=\"text-sm font-black text-slate-700\">人気タグ</span>\n                                    </div>\n                                    <div className=\"flex flex-wrap gap-2\">\n                                        {allTags.map(tag => (\n                                            <button\n                                                key={tag}\n                                                onClick={() => toggleTag(tag)}\n                                                className={`px-4 py-2 text-xs font-bold rounded-full transition-all border shadow-sm hover:-translate-y-0.5 ${selectedTags.includes(tag)\n                                                    ? 'bg-blue-600 text-white border-blue-600 ring-2 ring-blue-200'\n                                                    : 'bg-white text-slate-600 border-slate-200 hover:border-slate-300 hover:bg-slate-50'\n                                                    }`}\n                                            >\n                                                #{tag}\n                                            </button>\n                                        ))}\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            {/* Content List */}\n            <div className=\"max-w-7xl mx-auto p-4 md:p-8\">\n                <div className=\"flex items-center justify-between px-2 mb-4\">\n                    <span className=\"text-sm font-bold text-slate-500\">{filteredJobs.length}件の求人</span>\n                </div>\n\n                <div className=\"space-y-4\">\n                    {filteredJobs.length > 0 ? (\n                        filteredJobs.map(job => {\n                            const company = COMPANIES.find(c => c.id === job.companyId)!;\n                            // Ensure images exist (fallback for dummy data)\n                            const mainImage = company.image;\n                            const subImages = company.images && company.images.length >= 3 ? company.images : [company.image, company.image, company.image];\n\n                            return (\n                                <Link href={`/jobs/${job.id}`} key={job.id} className=\"block group\">\n                                    <div className=\"bg-white rounded-[2rem] p-4 md:p-6 shadow-sm border border-slate-100 transition-all hover:shadow-lg hover:-translate-y-1 relative\">\n\n                                        <div className=\"absolute right-6 top-1/2 -translate-y-1/2 z-20 transition-transform group-hover:scale-110\">\n                                            <ReelIcon\n                                                reels={company.reels || []}\n                                                fallbackImage={company.image}\n                                                onClick={() => {\n                                                    setActiveReels(company.reels || []);\n                                                    setActiveEntity({ name: job.title, id: job.id, companyId: company.id });\n                                                    setIsReelModalOpen(true);\n                                                }}\n                                            />\n                                        </div>\n\n                                        {/* Like Button */}\n                                        <button\n                                            onClick={(e) => toggleLike(job.id, e)}\n                                            className=\"absolute top-6 right-6 z-10 bg-white/80 backdrop-blur-sm p-3 rounded-full shadow-sm hover:bg-red-50 hover:scale-110 transition-all group/heart\"\n                                        >\n                                            <Heart\n                                                size={24}\n                                                className={`transition-colors ${isLiked(job.id) ? 'text-red-500 fill-red-500' : 'text-slate-300 group-hover/heart:text-red-500'}`}\n                                            />\n                                        </button>\n\n                                        <div className=\"flex flex-col md:flex-row gap-6\">\n                                            {/* Images Column (Left) fixed width on desktop */}\n                                            <div className=\"w-full md:w-80 shrink-0\">\n                                                <div className=\"space-y-2\">\n                                                    {/* Main Image */}\n                                                    <div className=\"aspect-video w-full rounded-2xl overflow-hidden bg-slate-100 relative\">\n                                                        <img src={mainImage} alt={job.title} className=\"w-full h-full object-cover transition-transform group-hover:scale-105 duration-500\" />\n                                                        <span className=\"absolute top-2 left-2 px-2 py-0.5 bg-blue-600/90 text-white text-[10px] font-bold rounded shadow-sm\">\n                                                            {job.category}\n                                                        </span>\n                                                        {company.isPremium && (\n                                                            <span className=\"absolute top-2 right-2 bg-yellow-400 text-white text-[10px] font-black px-2 py-0.5 rounded shadow-sm\">\n                                                                ★ PREMIUM\n                                                            </span>\n                                                        )}\n                                                    </div>\n                                                    {/* Sub Images (3 cols) */}\n                                                    <div className=\"grid grid-cols-3 gap-2\">\n                                                        {subImages.slice(0, 3).map((img, idx) => (\n                                                            <div key={idx} className=\"aspect-video rounded-xl overflow-hidden bg-slate-100\">\n                                                                <img src={img} alt=\"\" className=\"w-full h-full object-cover\" />\n                                                            </div>\n                                                        ))}\n                                                    </div>\n                                                </div>\n                                            </div>\n\n                                            {/* Content Column (Right) */}\n                                            <div className=\"flex-1 min-w-0 flex flex-col pr-24 md:pr-36\">\n                                                <div className=\"mb-1\">\n                                                    <div className=\"text-xs font-bold text-slate-500 flex items-center gap-1.5 mb-1.5\">\n                                                        <Building2 size={12} />\n                                                        {company.name}\n                                                    </div>\n                                                    <h2 className=\"text-xl md:text-2xl font-black text-slate-900 leading-tight mb-2 group-hover:text-blue-600 transition-colors\">\n                                                        {job.title}\n                                                    </h2>\n                                                </div>\n\n                                                <div className=\"flex flex-wrap gap-2 mb-4\">\n                                                    {job.tags.slice(0, 4).map(tag => (\n                                                        <span key={tag} className=\"px-2.5 py-1 bg-slate-100 text-slate-600 text-[10px] font-bold rounded-lg border border-slate-200\">\n                                                            #{tag}\n                                                        </span>\n                                                    ))}\n                                                </div>\n\n                                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2 mb-4 text-xs font-bold text-slate-600 bg-slate-50 p-4 rounded-xl border border-slate-100\">\n                                                    <div className=\"flex items-center gap-2\">\n                                                        <MapPin size={14} className=\"text-slate-400 shrink-0\" />\n                                                        <span className=\"truncate\">{job.location || company.location}</span>\n                                                    </div>\n                                                    <div className=\"flex items-center gap-2 text-blue-600\">\n                                                        <JapaneseYen size={14} className=\"text-blue-400 shrink-0\" />\n                                                        <span className=\"truncate text-base\">{job.reward || job.salary || '要相談'}</span>\n                                                    </div>\n                                                    <div className=\"flex items-center gap-2 text-slate-600 md:col-span-2\">\n                                                        <Clock size={14} className=\"text-slate-400 shrink-0\" />\n                                                        <span className=\"truncate\">{job.workingHours || '9:00 - 18:00'}</span>\n                                                    </div>\n                                                </div>\n\n                                                {/* Reality Check */}\n                                                {(company.rjpNegatives) && (\n                                                    <div className=\"mt-auto bg-amber-50 border border-amber-200 rounded-xl p-3 flex gap-3 relative overflow-hidden\">\n                                                        <div className=\"absolute -right-2 -top-2 text-amber-100 transform rotate-12\">\n                                                            <Building2 size={80} />\n                                                        </div>\n                                                        <div className=\"shrink-0 bg-amber-400 text-white text-[10px] font-black px-1.5 py-3 rounded writing-vertical-rl flex items-center justify-center tracking-widest h-full shadow-sm\">\n                                                            REALITY\n                                                        </div>\n                                                        <div className=\"relative z-10 flex-1\">\n                                                            <p className=\"text-[10px] font-bold text-amber-800/70 mb-0.5 flex items-center gap-1\">\n                                                                <span className=\"w-1.5 h-1.5 bg-amber-500 rounded-full\"></span>\n                                                                入社後のリアルギャップ予防\n                                                            </p>\n                                                            <p className=\"text-xs font-bold text-amber-900 leading-snug\">\n                                                                {company.rjpNegatives}\n                                                            </p>\n                                                        </div>\n                                                    </div>\n                                                )}\n\n                                                <div className=\"mt-4 pt-4 border-t border-slate-100 md:hidden pr-12\">\n                                                    <div className=\"text-center text-xs font-bold text-blue-600\">\n                                                        詳細を見る\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </Link>\n                            );\n                        })\n                    ) : (\n                        <div className=\"text-center py-20 bg-white rounded-3xl border border-dashed border-slate-200\">\n                            <p className=\"text-slate-400 font-bold mb-4\">条件に一致する求人が見つかりませんでした。</p>\n                            <button\n                                onClick={clearFilters}\n                                className=\"px-6 py-2 bg-slate-100 hover:bg-slate-200 text-slate-600 rounded-full text-sm font-bold transition-colors\"\n                            >\n                                検索条件をクリア\n                            </button>\n                        </div>\n                    )}\n                </div>\n            </div>\n\n            <ReelModal\n                isOpen={isReelModalOpen}\n                onClose={() => setIsReelModalOpen(false)}\n                reels={activeReels}\n                entityName={activeEntity.name}\n                entityId={activeEntity.id}\n                entityType=\"job\"\n                companyId={activeEntity.companyId}\n            />\n        </div>\n    );\n}\n\nexport default function JobsPage() {\n    return (\n        <Suspense fallback={\n            <div className=\"min-h-screen bg-slate-50 flex items-center justify-center\">\n                <div className=\"animate-pulse flex flex-col items-center gap-4\">\n                    <div className=\"w-12 h-12 bg-slate-200 rounded-full\"></div>\n                    <div className=\"h-4 w-32 bg-slate-200 rounded-lg\"></div>\n                </div>\n            </div>\n        }>\n            <JobsContent />\n        </Suspense>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/layout.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DebugRoleSwitcher' is defined but never used.","line":7,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":25,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"DebugRoleSwitcher"},"fix":{"range":[260,329],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'geistSans' is assigned a value but never used.","line":9,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'geistMono' is assigned a value but never used.","line":14,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import type { Metadata } from \"next\";\nimport { Geist, Geist_Mono } from \"next/font/google\";\nimport { Toaster } from \"sonner\";\nimport \"./globals.css\";\nimport LayoutWrapper from \"@/components/LayoutWrapper\";\nimport { AuthProvider } from \"@/context/AuthContext\";\nimport DebugRoleSwitcher from \"@/components/debug/DebugRoleSwitcher\";\n\nconst geistSans = Geist({\n  variable: \"--font-geist-sans\",\n  subsets: [\"latin\"],\n});\n\nconst geistMono = Geist_Mono({\n  variable: \"--font-geist-mono\",\n  subsets: [\"latin\"],\n});\n\nexport const metadata: Metadata = {\n  title: \"Ehime Base\",\n  description: \"愛媛で働く。本音で繋がる。\",\n};\n\nexport default function RootLayout({\n  children,\n}: Readonly<{\n  children: React.ReactNode;\n}>) {\n  return (\n    <html lang=\"ja\">\n      <body className=\"antialiased font-sans\" suppressHydrationWarning={true}>\n        <AuthProvider>\n          <LayoutWrapper>{children}</LayoutWrapper>\n          <Toaster position=\"top-center\" richColors />\n        </AuthProvider>\n      </body>\n    </html>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/login/company/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/login/seeker/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/messages/[id]/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/messages/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/money-simulation/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":3,"column":36,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":45,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useEffect"},"fix":{"range":[48,59],"text":""},"desc":"Remove unused variable \"useEffect\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CashFlowGraph' is defined but never used.","line":14,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":21,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"CashFlowGraph"},"fix":{"range":[662,742],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":137,"column":90,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":137,"endColumn":93,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4406,4409],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4406,4409],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/money-simulation/page.tsx:202:26\n  200 |                     {/* 1. Assets & Config */}\n  201 |                     <div>\n> 202 |                         <SectionHeader id=\"assets\" title=\"資産・シミュレーション条件\" icon={TrendingUp} />\n      |                          ^^^^^^^^^^^^^ This component is created during render\n  203 |                         {expandedSection === 'assets' && (\n  204 |                             <div className=\"bg-white p-4 rounded-b-xl border border-t-0 border-slate-200 shadow-sm\">\n  205 |                                 <AssetsConfigForm\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/money-simulation/page.tsx:137:27\n  135 |     };\n  136 |\n> 137 |     const SectionHeader = ({ id, title, icon: Icon }: { id: string, title: string, icon: any }) => (\n      |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 138 |         <button\n      | ^^^^^^^^^^^^^^^\n> 139 |             onClick={() => setExpandedSection(expandedSection === id ? null : id)}\n      …\n      | ^^^^^^^^^^^^^^^\n> 147 |         </button>\n      | ^^^^^^^^^^^^^^^\n> 148 |     );\n      | ^^^^^^ The component is created during render here\n  149 |\n  150 |     return (\n  151 |         <div className=\"min-h-screen bg-slate-50 font-sans pb-20\">","line":202,"column":26,"nodeType":null,"endLine":202,"endColumn":39},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/money-simulation/page.tsx:217:26\n  215 |                     {/* 2. Basic Profile */}\n  216 |                     <div>\n> 217 |                         <SectionHeader id=\"basic\" title=\"基本情報・家族\" icon={Users} />\n      |                          ^^^^^^^^^^^^^ This component is created during render\n  218 |                         {expandedSection === 'basic' && (\n  219 |                             <div className=\"bg-white p-4 rounded-b-xl border border-t-0 border-slate-200 shadow-sm space-y-6\">\n  220 |                                 <PersonInput\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/money-simulation/page.tsx:137:27\n  135 |     };\n  136 |\n> 137 |     const SectionHeader = ({ id, title, icon: Icon }: { id: string, title: string, icon: any }) => (\n      |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 138 |         <button\n      | ^^^^^^^^^^^^^^^\n> 139 |             onClick={() => setExpandedSection(expandedSection === id ? null : id)}\n      …\n      | ^^^^^^^^^^^^^^^\n> 147 |         </button>\n      | ^^^^^^^^^^^^^^^\n> 148 |     );\n      | ^^^^^^ The component is created during render here\n  149 |\n  150 |     return (\n  151 |         <div className=\"min-h-screen bg-slate-50 font-sans pb-20\">","line":217,"column":26,"nodeType":null,"endLine":217,"endColumn":39},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/money-simulation/page.tsx:259:26\n  257 |                     {/* 2. Expenses & Housing */}\n  258 |                     <div>\n> 259 |                         <SectionHeader id=\"expenses\" title=\"住まい・生活費\" icon={Info} />\n      |                          ^^^^^^^^^^^^^ This component is created during render\n  260 |                         {expandedSection === 'expenses' && (\n  261 |                             <div className=\"bg-white p-4 rounded-b-xl border border-t-0 border-slate-200 shadow-sm\">\n  262 |                                 <ExpensesForm\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/money-simulation/page.tsx:137:27\n  135 |     };\n  136 |\n> 137 |     const SectionHeader = ({ id, title, icon: Icon }: { id: string, title: string, icon: any }) => (\n      |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 138 |         <button\n      | ^^^^^^^^^^^^^^^\n> 139 |             onClick={() => setExpandedSection(expandedSection === id ? null : id)}\n      …\n      | ^^^^^^^^^^^^^^^\n> 147 |         </button>\n      | ^^^^^^^^^^^^^^^\n> 148 |     );\n      | ^^^^^^ The component is created during render here\n  149 |\n  150 |     return (\n  151 |         <div className=\"min-h-screen bg-slate-50 font-sans pb-20\">","line":259,"column":26,"nodeType":null,"endLine":259,"endColumn":39}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState, useMemo, useEffect } from 'react';\nimport { calculateLifePlan } from '@/lib/money-simulation/simulation';\nimport { LifePlanInput } from '@/lib/money-simulation/types';\nimport { useAppStore } from '@/lib/appStore';\n\nimport PersonInput from '@/components/money-simulation/forms/PersonInput';\nimport FamilyForm from '@/components/money-simulation/forms/FamilyForm';\nimport ExpensesForm from '@/components/money-simulation/forms/ExpensesForm';\nimport AssetsConfigForm from '@/components/money-simulation/forms/AssetsConfigForm';\n\nimport AssetTransitionGraph from '@/components/money-simulation/results/AssetTransitionGraph';\nimport CashFlowGraph from '@/components/money-simulation/results/CashFlowGraph';\n\nimport { Users, Info, ChevronDown, ChevronUp, TrendingUp, ArrowLeft } from 'lucide-react';\nimport Link from 'next/link';\n\nexport default function MoneySimulationPage() {\n    const { lastMoneySimulationInput, setMoneySimulationInput } = useAppStore();\n\n    // Initial State from Store or Default\n    const [input, setInput] = useState<LifePlanInput>(lastMoneySimulationInput || {\n        headOfHousehold: {\n            currentAge: 30,\n            targetRetirementAge: 65,\n            employmentType: 'employee',\n            annualIncome: 5000000,\n            annualBonus: 1000000,\n            retirementAllowance: 10000000\n        },\n        spouse: undefined,\n        children: [],\n        housing: {\n            type: 'rent',\n            monthlyCost: 100000,\n            maintenanceCostPerYear: 0,\n            remainingLoanYears: 0,\n            loanInterestRate: 0\n        },\n        expenses: {\n            food: 60000,\n            utilities: 20000,\n            communication: 10000,\n            dailyGoods: 10000,\n            clothingBeauty: 10000,\n            entertainment: 30000,\n            medicalInsurance: 5000,\n            otherBasic: 20000,\n            yearlySpecialExpenses: 300000,\n            vehicleReplacements: []\n        },\n        assets: {\n            cashSavings: 3000000,\n            investmentAssets: 1000000,\n            monthlyInvestment: {\n                amount: 30000,\n                expectedReturn: 5.0,\n                durationYears: 20\n            },\n            otherLoansRemaining: 0,\n            otherMonthlyPayment: 0\n        },\n        config: {\n            inflationRate: 2.0,\n            socialSecurityPensionOffset: 65,\n            enableExpenses: true,\n            enableRetirement: true\n        }\n    });\n\n    // Helper to update state and persist to store\n    const handleUpdateInput = (newInput: LifePlanInput) => {\n        setInput(newInput);\n        setMoneySimulationInput(newInput);\n    };\n\n    const [expandedSection, setExpandedSection] = useState<string | null>('assets');\n\n    // Graph Options\n    const [isLogScale, setIsLogScale] = useState(false);\n    const [maxDisplayAge, setMaxDisplayAge] = useState(100);\n\n    // Toggle Spouse\n    const toggleSpouse = () => {\n        let newInput: LifePlanInput;\n        if (input.spouse) {\n            newInput = { ...input, spouse: undefined };\n        } else {\n            newInput = {\n                ...input,\n                spouse: {\n                    currentAge: 30,\n                    targetRetirementAge: 65,\n                    employmentType: 'employee',\n                    annualIncome: 3000000,\n                    annualBonus: 500000,\n                    retirementAllowance: 5000000\n                }\n            };\n        }\n        handleUpdateInput(newInput);\n    };\n\n    const results = useMemo(() => {\n        try {\n            const res = calculateLifePlan(input);\n            if (!res || res.length === 0) {\n                return [];\n            }\n            return res;\n        } catch (e) {\n            console.error(\"Simulation error\", e);\n            return [];\n        }\n    }, [input]);\n\n    // Guard against empty results\n    const finalResult = results.length > 0 ? results[results.length - 1] : {\n        totalAssets: 0,\n        realTotalAssets: 0,\n        investmentAssets: 0,\n        cashAssets: 0,\n        age: 0,\n        year: 0,\n        income: 0,\n        pension: 0,\n        totalIncome: 0,\n        basicLiving: 0,\n        housing: 0,\n        education: 0,\n        events: 0,\n        totalExpenses: 0,\n        annualSurplus: 0\n    };\n\n    const SectionHeader = ({ id, title, icon: Icon }: { id: string, title: string, icon: any }) => (\n        <button\n            onClick={() => setExpandedSection(expandedSection === id ? null : id)}\n            className={`w-full flex items-center justify-between p-4 bg-white border border-slate-200 ${expandedSection === id ? 'rounded-t-xl border-b-0' : 'rounded-xl shadow-sm'}`}\n        >\n            <div className=\"flex items-center gap-3 font-bold text-slate-700\">\n                <Icon className=\"text-blue-500\" />\n                {title}\n            </div>\n            {expandedSection === id ? <ChevronUp size={20} className=\"text-slate-400\" /> : <ChevronDown size={20} className=\"text-slate-400\" />}\n        </button>\n    );\n\n    return (\n        <div className=\"min-h-screen bg-slate-50 font-sans pb-20\">\n            {/* Navigation */}\n            <div className=\"bg-white/10 backdrop-blur-md sticky top-0 z-50 px-4 py-4 flex items-center justify-between border-b border-white/10\">\n                <Link href=\"/mypage\" className=\"flex items-center gap-2 text-white/80 hover:text-white font-black text-sm transition-colors group\">\n                    <ArrowLeft size={18} className=\"group-hover:-translate-x-1 transition-transform\" /> マイページへ戻る\n                </Link>\n            </div>\n\n            {/* Header */}\n            <header className=\"bg-gradient-to-r from-blue-600 to-indigo-700 text-white pt-10 pb-24 px-4 shadow-lg rounded-b-[2.5rem] -mt-16\">\n                <div className=\"max-w-7xl mx-auto text-center pt-8\">\n                    <h1 className=\"text-2xl md:text-4xl font-black mb-2 tracking-tight\">\n                        ライフプラン・シミュレーター\n                    </h1>\n                    <p className=\"text-blue-100 text-sm md:text-base font-medium opacity-90\">\n                        家族、住まい、教育、そして老後。<br />\n                        人生の収支を見える化し、未来を設計しよう。\n                    </p>\n                </div>\n            </header>\n\n            <main className=\"max-w-7xl mx-auto px-4 -mt-16 grid grid-cols-1 lg:grid-cols-12 gap-8\">\n                {/* Left: Inputs */}\n                <div className=\"lg:col-span-12 space-y-4\">\n                    {/* Summary Cards moved up for mobile visibility */}\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        <div className=\"bg-white p-5 rounded-2xl shadow-sm border border-slate-100\">\n                            <p className=\"text-xs font-bold text-slate-400 mb-1\">100歳時点の資産残高</p>\n                            <p className={`text-2xl font-black ${finalResult.totalAssets >= 0 ? 'text-blue-600' : 'text-red-500'}`}>\n                                {finalResult.totalAssets >= 0 ? '' : '▲'}\n                                {Math.abs(finalResult.totalAssets).toLocaleString()}円\n                            </p>\n                            <p className=\"text-xs text-slate-400 mt-2\">\n                                (インフレ考慮後の実質価値: {finalResult.realTotalAssets.toLocaleString()}円)\n                            </p>\n                        </div>\n                        <div className=\"bg-white p-5 rounded-2xl shadow-sm border border-slate-100\">\n                            <p className=\"text-xs font-bold text-slate-400 mb-1\">生涯の総支出 (インフレ込)</p>\n                            <p className=\"text-2xl font-black text-slate-700\">\n                                {Math.round(results.reduce((acc, r) => acc + r.totalExpenses, 0)).toLocaleString()}円\n                            </p>\n                            <p className=\"text-xs text-slate-400 mt-2\">\n                                内 教育費: {Math.round(results.reduce((acc, r) => acc + r.education, 0)).toLocaleString()}円\n                            </p>\n                        </div>\n                    </div>\n                </div>\n\n                <div className=\"lg:col-span-5 space-y-4\">\n                    {/* 1. Assets & Config */}\n                    <div>\n                        <SectionHeader id=\"assets\" title=\"資産・シミュレーション条件\" icon={TrendingUp} />\n                        {expandedSection === 'assets' && (\n                            <div className=\"bg-white p-4 rounded-b-xl border border-t-0 border-slate-200 shadow-sm\">\n                                <AssetsConfigForm\n                                    assets={input.assets}\n                                    config={input.config}\n                                    onAssetsChange={(a) => handleUpdateInput({ ...input, assets: a })}\n                                    onConfigChange={(c) => handleUpdateInput({ ...input, config: c })}\n                                />\n                            </div>\n                        )}\n                    </div>\n\n                    {/* 2. Basic Profile */}\n                    <div>\n                        <SectionHeader id=\"basic\" title=\"基本情報・家族\" icon={Users} />\n                        {expandedSection === 'basic' && (\n                            <div className=\"bg-white p-4 rounded-b-xl border border-t-0 border-slate-200 shadow-sm space-y-6\">\n                                <PersonInput\n                                    title=\"世帯主\"\n                                    person={input.headOfHousehold}\n                                    onChange={(p) => handleUpdateInput({ ...input, headOfHousehold: p })}\n                                    colorClass=\"bg-blue-50 border-blue-100\"\n                                />\n\n                                <div className=\"pt-4 border-t border-slate-100\">\n                                    <div className=\"flex items-center justify-between mb-4\">\n                                        <h3 className=\"font-bold text-slate-600\">配偶者</h3>\n                                        <button\n                                            onClick={toggleSpouse}\n                                            className={`text-xs px-3 py-1 rounded-full font-bold transition ${input.spouse ? 'bg-pink-500 text-white' : 'bg-slate-200 text-slate-500'}`}\n                                        >\n                                            {input.spouse ? 'あり' : 'なし'}\n                                        </button>\n                                    </div>\n                                    {input.spouse && (\n                                        <PersonInput\n                                            title=\"配偶者\"\n                                            person={input.spouse}\n                                            onChange={(p) => handleUpdateInput({ ...input, spouse: p })}\n                                            colorClass=\"bg-pink-50 border-pink-100\"\n                                        />\n                                    )}\n                                </div>\n\n                                <div className=\"pt-4 border-t border-slate-100\">\n                                    <FamilyForm\n                                        childrenData={input.children}\n                                        onChange={(c) => handleUpdateInput({ ...input, children: c })}\n                                    />\n                                </div>\n                            </div>\n                        )}\n                    </div>\n\n                    {/* 2. Expenses & Housing */}\n                    <div>\n                        <SectionHeader id=\"expenses\" title=\"住まい・生活費\" icon={Info} />\n                        {expandedSection === 'expenses' && (\n                            <div className=\"bg-white p-4 rounded-b-xl border border-t-0 border-slate-200 shadow-sm\">\n                                <ExpensesForm\n                                    housing={input.housing}\n                                    expenses={input.expenses}\n                                    onHousingChange={(h) => handleUpdateInput({ ...input, housing: h })}\n                                    onExpensesChange={(e) => handleUpdateInput({ ...input, expenses: e })}\n                                />\n                            </div>\n                        )}\n                    </div>\n                </div>\n\n                {/* Right: Results */}\n                <div className=\"lg:col-span-7 space-y-6\">\n                    {/* Graphs */}\n                    <div className=\"bg-white p-2 rounded-2xl shadow-sm border border-slate-200\">\n                        <div className=\"p-4 border-b border-slate-100 mb-4 flex flex-col md:flex-row md:items-center justify-between gap-4\">\n                            <div>\n                                <h3 className=\"font-bold text-lg text-slate-800\">資産推移シミュレーション</h3>\n                                <p className=\"text-xs text-slate-500\">\n                                    {input.assets.monthlyInvestment?.expectedReturn || 0}%運用 / インフレ率{input.config.inflationRate}%\n                                </p>\n                            </div>\n                            <div className=\"flex items-center gap-4 text-xs\">\n                                <label className=\"flex items-center gap-1 cursor-pointer\">\n                                    <input\n                                        type=\"checkbox\"\n                                        checked={isLogScale}\n                                        onChange={(e) => setIsLogScale(e.target.checked)}\n                                        className=\"rounded border-slate-300 text-blue-600 focus:ring-blue-500\"\n                                    />\n                                    <span className=\"text-slate-600 font-bold\">対数表示</span>\n                                </label>\n                                <div className=\"flex items-center gap-2\">\n                                    <span className=\"text-slate-500\">表示期間:</span>\n                                    <select\n                                        value={maxDisplayAge}\n                                        onChange={(e) => setMaxDisplayAge(Number(e.target.value))}\n                                        className=\"bg-slate-100 border-none rounded py-1 px-2 text-slate-700 font-medium\"\n                                    >\n                                        <option value={100}>100歳まで</option>\n                                        <option value={90}>90歳まで</option>\n                                        <option value={80}>80歳まで</option>\n                                        <option value={70}>70歳まで</option>\n                                        <option value={60}>60歳まで</option>\n                                    </select>\n                                </div>\n                            </div>\n                        </div>\n                        <AssetTransitionGraph\n                            data={results}\n                            isLogScale={isLogScale}\n                            maxDisplayAge={maxDisplayAge}\n                        />\n                    </div>\n\n                    {/* Disclaimer */}\n                    <div className=\"px-4 py-2 text-[10px] text-slate-400 text-center\">\n                        ※ このシミュレーション結果は概算であり、将来の運用成果や税制変更などを保証するものではありません。\n                        教育費は文部科学省の統計データ(H30)を参照しています。\n                    </div>\n                </div>\n            </main>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/mypage/edit/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronRight' is defined but never used.","line":6,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":41,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ChevronRight"},"fix":{"range":[173,187],"text":""},"desc":"Remove unused variable \"ChevronRight\"."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":51,"column":25,"nodeType":"JSXOpeningElement","endLine":55,"endColumn":27}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState } from 'react';\nimport { useAppStore } from '@/lib/appStore';\nimport { useRouter } from 'next/navigation';\nimport { ArrowLeft, Camera, ChevronRight, Save } from 'lucide-react';\n\nexport default function ProfileEditPage() {\n    const { users, currentUserId, updateUser } = useAppStore();\n\n    const currentUser = users.find(u => u.id === currentUserId);\n    const router = useRouter();\n\n    const [form, setForm] = useState({\n        name: currentUser?.name || '',\n        university: currentUser?.university || '',\n        bio: currentUser?.bio || '',\n        faculty: currentUser?.faculty || '',\n        graduationYear: currentUser?.graduationYear || '',\n    });\n\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n        setForm({ ...form, [e.target.name]: e.target.value });\n    };\n\n    const handleSave = () => {\n        if (!currentUser) return;\n        updateUser(currentUserId, form);\n        router.back();\n    };\n\n    if (!currentUser) return null;\n\n    return (\n        <div className=\"min-h-screen bg-slate-50 pb-24\">\n            {/* Header */}\n            <div className=\"bg-white px-6 py-4 flex items-center justify-between sticky top-0 z-10 shadow-sm\">\n                <button onClick={() => router.back()} className=\"w-10 h-10 bg-slate-100 rounded-full flex items-center justify-center text-slate-600\">\n                    <ArrowLeft size={20} />\n                </button>\n                <span className=\"font-black text-slate-800\">プロフィール編集</span>\n                <button onClick={handleSave} className=\"w-10 h-10 bg-eis-blue/10 text-eis-blue rounded-full flex items-center justify-center font-bold\">\n                    <Save size={20} />\n                </button>\n            </div>\n\n            <div className=\"p-6 max-w-md mx-auto space-y-8\">\n                {/* Image Upload */}\n                <div className=\"flex flex-col items-center\">\n                    <div className=\"relative\">\n                        <img\n                            src={currentUser.image}\n                            alt={currentUser.name}\n                            className=\"w-28 h-28 rounded-full object-cover border-4 border-white shadow-md\"\n                        />\n                        <button className=\"absolute bottom-0 right-0 w-8 h-8 bg-slate-800 text-white rounded-full flex items-center justify-center border-2 border-white\">\n                            <Camera size={14} />\n                        </button>\n                    </div>\n                </div>\n\n                {/* Form Fields */}\n                <div className=\"space-y-6\">\n                    <div className=\"space-y-2\">\n                        <label className=\"text-xs font-bold text-slate-400 uppercase\">お名前</label>\n                        <input\n                            type=\"text\"\n                            name=\"name\"\n                            value={form.name}\n                            onChange={handleChange}\n                            className=\"w-full bg-white border border-slate-200 rounded-xl px-4 py-3 font-bold text-slate-800 focus:outline-none focus:border-blue-500\"\n                        />\n                    </div>\n\n                    <div className=\"space-y-2\">\n                        <label className=\"text-xs font-bold text-slate-400 uppercase\">大学名</label>\n                        <input\n                            type=\"text\"\n                            name=\"university\"\n                            value={form.university}\n                            onChange={handleChange}\n                            className=\"w-full bg-white border border-slate-200 rounded-xl px-4 py-3 font-bold text-slate-800 focus:outline-none focus:border-blue-500\"\n                        />\n                    </div>\n\n                    <div className=\"grid grid-cols-2 gap-4\">\n                        <div className=\"space-y-2\">\n                            <label className=\"text-xs font-bold text-slate-400 uppercase\">学部</label>\n                            <input\n                                type=\"text\"\n                                name=\"faculty\"\n                                value={form.faculty}\n                                onChange={handleChange}\n                                className=\"w-full bg-white border border-slate-200 rounded-xl px-4 py-3 font-bold text-slate-800 focus:outline-none focus:border-blue-500\"\n                            />\n                        </div>\n                        <div className=\"space-y-2\">\n                            <label className=\"text-xs font-bold text-slate-400 uppercase\">卒業予定</label>\n                            <input\n                                type=\"text\"\n                                name=\"graduationYear\"\n                                value={form.graduationYear}\n                                onChange={handleChange}\n                                placeholder=\"2027年\"\n                                className=\"w-full bg-white border border-slate-200 rounded-xl px-4 py-3 font-bold text-slate-800 focus:outline-none focus:border-blue-500\"\n                            />\n                        </div>\n                    </div>\n\n                    <div className=\"space-y-2\">\n                        <label className=\"text-xs font-bold text-slate-400 uppercase\">自己紹介</label>\n                        <textarea\n                            name=\"bio\"\n                            value={form.bio}\n                            onChange={handleChange}\n                            rows={4}\n                            className=\"w-full bg-white border border-slate-200 rounded-xl px-4 py-3 font-bold text-slate-800 focus:outline-none focus:border-blue-500 resize-none\"\n                        />\n                    </div>\n                </div>\n\n                <div className=\"pt-4\">\n                    <button onClick={handleSave} className=\"w-full bg-gradient-to-r from-blue-600 to-cyan-500 text-white font-black py-4 rounded-xl shadow-lg active:scale-95 transition-transform\">\n                        変更を保存する\n                    </button>\n                </div>\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/mypage/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowRight' is defined but never used.","line":10,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":36,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowRight"},"fix":{"range":[388,400],"text":""},"desc":"Remove unused variable \"ArrowRight\"."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":23,"column":21,"nodeType":"JSXOpeningElement","endLine":27,"endColumn":23},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":71,"column":54,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[4101,4210],"text":"\n                                                Today&apos;s Fortune\n                                            "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[4101,4210],"text":"\n                                                Today&lsquo;s Fortune\n                                            "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[4101,4210],"text":"\n                                                Today&#39;s Fortune\n                                            "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[4101,4210],"text":"\n                                                Today&rsquo;s Fortune\n                                            "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React from 'react';\nimport { User, Settings, LogOut, Sparkles, CircleDollarSign } from 'lucide-react';\nimport { useAppStore } from '@/lib/appStore';\n\nimport Link from 'next/link';\nimport { calculateDayMasterIndex, JIKKAN, JIKKAN_READING, JIKKAN_ELEMENTS, getDailyFortune } from '@/lib/fortune';\nimport { useGameStore } from '@/lib/gameStore';\nimport { Trophy, Swords, ArrowRight } from 'lucide-react';\n\nexport default function MyPage() {\n    const { users, currentUserId } = useAppStore();\n    const { isInitialized, stats } = useGameStore();\n    const currentUser = users.find(u => u.id === currentUserId);\n\n    if (!currentUser) return null;\n\n    return (\n        <div className=\"min-h-screen bg-slate-50 pb-24\">\n            <div className=\"bg-white p-6 pb-10 rounded-b-[2rem] shadow-sm mb-6\">\n                <div className=\"flex flex-col items-center\">\n                    <img\n                        src={currentUser.image}\n                        alt={currentUser.name}\n                        className=\"w-24 h-24 rounded-full object-cover border-4 border-slate-50 shadow-md mb-4\"\n                    />\n                    <h1 className=\"text-xl font-black text-slate-800 mb-1\">{currentUser.name}</h1>\n                    <p className=\"text-sm text-slate-500 font-bold\">{currentUser.university || '所属なし'}</p>\n                </div>\n            </div>\n\n            <div className=\"p-4 max-w-md mx-auto\">\n                {/* Game Status Widget (Show if initialized) */}\n                {isInitialized ? (\n                    <Link href=\"/game\" className=\"bg-gradient-to-br from-slate-900 to-indigo-950 rounded-[2rem] p-6 text-white shadow-xl mb-6 flex items-center justify-between group relative overflow-hidden\">\n                        <div className=\"absolute right-[-5%] bottom-[-10%] opacity-10 rotate-12\">\n                            <Trophy size={140} />\n                        </div>\n                        <div className=\"relative z-10 space-y-3\">\n                            <div className=\"flex items-center gap-2\">\n                                <span className=\"bg-indigo-500 px-2 py-0.5 rounded-full text-[9px] font-black uppercase tracking-widest\">Job Hunt active</span>\n                                <span className=\"text-[10px] font-bold text-indigo-300\">Level {stats.level}</span>\n                            </div>\n                            <div>\n                                <h3 className=\"font-black text-lg leading-tight\">就活RPG: 冒険の続きへ</h3>\n                                <p className=\"text-[10px] font-bold text-slate-400 mt-1\">所持金: {stats.money.toLocaleString()} 円 / 技術: {stats.skill}</p>\n                            </div>\n                        </div>\n                        <div className=\"bg-white/10 p-3 rounded-2xl group-hover:bg-indigo-600 transition-all z-10\">\n                            <Swords size={24} />\n                        </div>\n                    </Link>\n                ) : null}\n\n                {/* Daily Fortune Widget */}\n                {currentUser.birthDate ? (\n                    (() => {\n                        const index = calculateDayMasterIndex(currentUser.birthDate);\n                        const stem = JIKKAN[index];\n                        const daily = getDailyFortune(stem);\n                        return (\n                            <div className=\"bg-gradient-to-br from-purple-600 to-indigo-700 rounded-[2rem] p-6 text-white shadow-xl shadow-purple-200 mb-6 relative overflow-hidden\">\n                                <div className=\"absolute right-[-10%] top-[-10%] opacity-10\">\n                                    <Sparkles size={120} />\n                                </div>\n                                <div className=\"relative z-10\">\n                                    <div className=\"flex items-center justify-between mb-4\">\n                                        <div className=\"flex items-center gap-2\">\n                                            <div className=\"px-3 py-1 bg-white/20 rounded-full text-[10px] font-black uppercase tracking-widest border border-white/20\">\n                                                Today's Fortune\n                                            </div>\n                                        </div>\n                                        <div className=\"text-[10px] font-black opacity-60 italic\">\n                                            {JIKKAN_READING[stem]}の{JIKKAN_ELEMENTS[stem]}\n                                        </div>\n                                    </div>\n                                    <div className=\"flex items-start gap-4 mb-6\">\n                                        <div className=\"w-14 h-14 bg-white/20 backdrop-blur-md rounded-2xl flex items-center justify-center text-2xl font-black shrink-0\">\n                                            {stem}\n                                        </div>\n                                        <div>\n                                            <p className=\"text-xs font-bold text-white/70 mb-1\">今日のアドバイス</p>\n                                            <p className=\"font-bold leading-tight\">{daily.advice}</p>\n                                        </div>\n                                    </div>\n                                    <div className=\"grid grid-cols-2 gap-3\">\n                                        <div className=\"bg-black/20 rounded-2xl p-3 border border-white/10\">\n                                            <p className=\"text-[9px] font-black text-white/50 uppercase tracking-tighter mb-1\">Lucky Color</p>\n                                            <p className=\"text-xs font-black\">{daily.luckyColor}</p>\n                                        </div>\n                                        <div className=\"bg-black/20 rounded-2xl p-3 border border-white/10\">\n                                            <p className=\"text-[9px] font-black text-white/50 uppercase tracking-tighter mb-1\">Lucky Number</p>\n                                            <p className=\"text-xs font-black\">{daily.luckyNumber}</p>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        );\n                    })()\n                ) : (\n                    <Link href=\"/analysis\" className=\"bg-gradient-to-br from-slate-800 to-slate-900 rounded-[2rem] p-6 text-white shadow-xl mb-6 flex items-center justify-between group\">\n                        <div className=\"space-y-1\">\n                            <p className=\"text-[10px] font-black text-blue-400 uppercase tracking-widest\">New Feature</p>\n                            <h3 className=\"font-black text-lg text-white\">資質診断を完了する</h3>\n                            <p className=\"text-[10px] font-bold text-slate-400\">毎日の運勢とアドバイスが届きます</p>\n                        </div>\n                        <div className=\"bg-white/10 p-3 rounded-2xl group-hover:bg-blue-600 transition-colors\">\n                            <Sparkles size={24} />\n                        </div>\n                    </Link>\n                )}\n            </div>\n\n            <div className=\"p-4 max-w-md mx-auto space-y-3\">\n                <Link href=\"/mypage/edit\" className=\"bg-white p-4 rounded-xl shadow-sm flex items-center gap-3 cursor-pointer hover:bg-slate-50 transition-colors\">\n                    <div className=\"w-10 h-10 bg-slate-100 rounded-full flex items-center justify-center text-slate-600\">\n                        <User size={20} />\n                    </div>\n                    <div className=\"flex-1 font-bold text-slate-700\">プロフィール編集</div>\n                    <div className=\"text-slate-400\">→</div>\n                </Link>\n\n                <Link href=\"/analysis\" className=\"bg-white p-4 rounded-xl shadow-sm flex items-center gap-3 cursor-pointer hover:bg-slate-50 transition-colors\">\n                    <div className=\"w-10 h-10 bg-blue-50 rounded-full flex items-center justify-center text-blue-600\">\n                        <Sparkles size={20} />\n                    </div>\n                    <div className=\"flex-1 font-bold text-slate-700\">自己分析・資質診断</div>\n                    <div className=\"text-slate-400\">→</div>\n                </Link>\n\n                <Link href=\"/game\" className=\"bg-white p-4 rounded-xl shadow-sm flex items-center gap-3 cursor-pointer hover:bg-slate-50 transition-colors\">\n                    <div className=\"w-10 h-10 bg-indigo-50 rounded-full flex items-center justify-center text-indigo-600\">\n                        <Swords size={20} />\n                    </div>\n                    <div className=\"flex-1 font-bold text-slate-700\">就活RPG（シミュレーション）</div>\n                    <div className=\"text-indigo-400 font-bold text-xs\">New!</div>\n                    <div className=\"text-slate-400\">→</div>\n                </Link>\n\n                <Link href=\"/money-simulation\" className=\"bg-white p-4 rounded-xl shadow-sm flex items-center gap-3 cursor-pointer hover:bg-slate-50 transition-colors\">\n                    <div className=\"w-10 h-10 bg-emerald-50 rounded-full flex items-center justify-center text-emerald-600\">\n                        <CircleDollarSign size={20} />\n                    </div>\n                    <div className=\"flex-1 font-bold text-slate-700\">ライフプラン・シミュレーション</div>\n                    <div className=\"text-slate-400\">→</div>\n                </Link>\n\n                <Link href=\"/settings\" className=\"bg-white p-4 rounded-xl shadow-sm flex items-center gap-3 cursor-pointer hover:bg-slate-50 transition-colors\">\n                    <div className=\"w-10 h-10 bg-slate-100 rounded-full flex items-center justify-center text-slate-600\">\n                        <Settings size={20} />\n                    </div>\n                    <div className=\"flex-1 font-bold text-slate-700\">設定</div>\n                    <div className=\"text-slate-400\">→</div>\n                </Link>\n                <div className=\"bg-white p-4 rounded-xl shadow-sm flex items-center gap-3 cursor-pointer hover:bg-slate-50 transition-colors text-red-500\">\n                    <div className=\"w-10 h-10 bg-red-50 rounded-full flex items-center justify-center\">\n                        <LogOut size={20} />\n                    </div>\n                    <div className=\"flex-1 font-bold\">ログアウト</div>\n                </div>\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Building2' is defined but never used.","line":6,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":24,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Building2"},"fix":{"range":[170,181],"text":""},"desc":"Remove unused variable \"Building2\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'LogIn' is defined but never used.","line":6,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":43,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"LogIn"},"fix":{"range":[193,200],"text":""},"desc":"Remove unused variable \"LogIn\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Heart' is defined but never used.","line":6,"column":108,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":113,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Heart"},"fix":{"range":[263,270],"text":""},"desc":"Remove unused variable \"Heart\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":6,"column":123,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":128,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Clock"},"fix":{"range":[278,285],"text":""},"desc":"Remove unused variable \"Clock\"."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":42,"column":11,"nodeType":"JSXOpeningElement","endLine":42,"endColumn":91},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":60,"column":17,"nodeType":"JSXOpeningElement","endLine":60,"endColumn":138},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":71,"column":11,"nodeType":"JSXOpeningElement","endLine":75,"endColumn":13},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":191,"column":17,"nodeType":"JSXOpeningElement","endLine":191,"endColumn":96},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":234,"column":21,"nodeType":"JSXOpeningElement","endLine":238,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":253,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":253,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13084,13087],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13084,13087],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":266,"column":31,"nodeType":"JSXOpeningElement","endLine":266,"endColumn":119},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":286,"column":25,"nodeType":"JSXOpeningElement","endLine":286,"endColumn":110},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":388,"column":21,"nodeType":"JSXOpeningElement","endLine":388,"endColumn":94},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":425,"column":15,"nodeType":"JSXOpeningElement","endLine":425,"endColumn":80}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":13,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useEffect, useState } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { useAppStore } from '@/lib/appStore';\nimport { Map, Building2, Film, Play, LogIn, ArrowRight, Sparkles, Search, MapPin, Briefcase, ChevronRight, Heart, Wallet, Clock, Users, Zap } from 'lucide-react';\nimport Link from 'next/link';\n\nexport default function HomePage() {\n  const router = useRouter();\n  const { authStatus, activeRole, jobs, companies, users, currentUserId } = useAppStore();\n  const [searchQuery, setSearchQuery] = useState('');\n  const [selectedArea, setSelectedArea] = useState('all');\n  const [selectedIndustry, setSelectedIndustry] = useState('all');\n  const currentUser = users.find(u => u.id === currentUserId);\n\n  // Redirect Company to Dashboard immediately\n  useEffect(() => {\n    if (authStatus === 'authenticated' && activeRole === 'company') {\n      router.push('/dashboard/company');\n    }\n  }, [authStatus, activeRole, router]);\n\n  // Featured Data\n  const featuredQuests = jobs.filter(j => j.type === 'quest').slice(0, 4);\n  const hotCompanies = companies.slice(0, 6);\n\n  const handleSearch = (e: React.FormEvent) => {\n    e.preventDefault();\n    const params = new URLSearchParams();\n    if (searchQuery) params.set('q', searchQuery);\n    if (selectedArea && selectedArea !== 'all') params.set('area', selectedArea);\n    if (selectedIndustry && selectedIndustry !== 'all') params.set('industry', selectedIndustry);\n    router.push(`/quests?${params.toString()}`);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-white\">\n      {/* 1. Global Header (Transparent Overlay) */}\n      <nav className=\"absolute top-0 left-0 right-0 z-50 px-6 py-6 flex items-center justify-between\">\n        <Link href=\"/\" className=\"flex items-center gap-2\">\n          <img src=\"/eis_logo_mark.png\" alt=\"EIS\" className=\"h-8 w-auto drop-shadow-lg\" />\n          <span className=\"font-black text-xl tracking-tighter text-white drop-shadow-lg\">Ehime Base</span>\n        </Link>\n        <div className=\"flex items-center gap-4\">\n          {authStatus === 'guest' ? (\n            <button\n              onClick={() => router.push('/welcome')}\n              className=\"bg-white text-blue-600 px-5 py-2 rounded-full font-black text-xs hover:bg-blue-50 transition-all shadow-lg active:scale-95\"\n            >\n              ログイン / 登録\n            </button>\n          ) : (\n            <div className=\"flex items-center gap-3\">\n              <span className=\"text-xs font-bold text-white drop-shadow-lg hidden md:block\">ようこそ、{currentUser?.name?.split(' ')[1] || 'ゲスト'}さん</span>\n              <button\n                onClick={() => router.push('/mypage')}\n                className=\"w-10 h-10 rounded-full border-2 border-white shadow-lg overflow-hidden\"\n              >\n                <img src={currentUser?.image || 'https://via.placeholder.com/40'} className=\"w-full h-full object-cover\" alt=\"Profile\" />\n              </button>\n            </div>\n          )}\n        </div>\n      </nav>\n\n      {/* 2. Hero Slider Style Area */}\n      <section className=\"relative overflow-hidden\">\n        {/* Background Image / Slider Background */}\n        <div className=\"h-[500px] md:h-[600px] relative bg-slate-900\">\n          <img\n            src=\"/hero_bg_new.png\"\n            alt=\"Banner\"\n            className=\"w-full h-full object-cover opacity-80\"\n          />\n          {/* Visual Flare */}\n          <div className=\"absolute inset-0 bg-gradient-to-t from-slate-900/80 via-transparent to-transparent\" />\n        </div>\n\n        {/* Hero Content Overlay */}\n        <div className=\"absolute inset-0 flex flex-col justify-center items-center px-6 z-10\">\n          <div className=\"w-full text-center mb-8 flex flex-col items-center\">\n            <div className=\"inline-flex items-center gap-2 bg-blue-600 text-white px-4 py-1.5 rounded-full text-[10px] font-black tracking-widest uppercase mb-6 animate-bounce\">\n              <Sparkles size={12} />\n              New Experience in Ehime\n            </div>\n            <h1 className=\"text-3xl md:text-[3.2rem] lg:text-6xl xl:text-7xl font-black text-white mb-4 tracking-tight leading-tight drop-shadow-2xl\">\n              愛媛で、<span className=\"text-blue-400\">「働く」の枠</span>を超えていく。\n            </h1>\n            <p className=\"text-slate-200 text-lg font-bold md:text-xl drop-shadow-lg\">\n              非対称なマッチングが、あなたの新しいキャリアを拓く\n            </p>\n          </div>\n\n          {/* Main Search Panel (Mynavi-style) */}\n          <form\n            onSubmit={handleSearch}\n            className=\"w-full max-w-4xl bg-white p-2 md:p-3 rounded-2xl md:rounded-[32px] shadow-2xl flex flex-col md:flex-row items-stretch gap-2\"\n          >\n            <div className=\"flex-1 flex items-center gap-3 px-4 border-b md:border-b-0 md:border-r border-slate-100 py-3 md:py-0\">\n              <Search className=\"text-blue-500\" size={24} />\n              <input\n                type=\"text\"\n                placeholder=\"フリーワードで検索 (例: 農業, IT, カフェ)\"\n                className=\"w-full bg-transparent border-none focus:ring-0 font-bold text-slate-700 placeholder:text-slate-400\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n              />\n            </div>\n            <div className=\"relative flex-1 flex items-center gap-3 px-4 border-b md:border-b-0 md:border-r border-slate-100 py-3 md:py-0\">\n              <MapPin className=\"text-slate-400\" size={24} />\n              <select\n                value={selectedArea}\n                onChange={(e) => setSelectedArea(e.target.value)}\n                className=\"w-full bg-transparent border-none focus:ring-0 focus:outline-none font-bold text-slate-700 appearance-none\"\n              >\n                <option value=\"all\">すべてのエリア</option>\n                <option value=\"chuyo\">中予（松山市・伊予市など）</option>\n                <option value=\"toyo\">東予（今治市・西条市など）</option>\n                <option value=\"nanyo\">南予（宇和島市・八幡浜市など）</option>\n              </select>\n              <ChevronRight className=\"text-slate-400 absolute right-3\" size={18} style={{ transform: 'rotate(90deg)' }} />\n            </div>\n            <div className=\"relative flex-1 flex items-center gap-3 px-4 border-b md:border-b-0 md:border-r border-slate-100 py-3 md:py-0\">\n              <Briefcase className=\"text-slate-400\" size={24} />\n              <select\n                value={selectedIndustry}\n                onChange={(e) => setSelectedIndustry(e.target.value)}\n                className=\"w-full bg-transparent border-none focus:ring-0 focus:outline-none font-bold text-slate-700 appearance-none\"\n              >\n                <option value=\"all\">すべての業種</option>\n                <option value=\"IT・システム開発\">IT・システム開発</option>\n                <option value=\"製造・エンジニアリング\">製造・エンジニアリング</option>\n                <option value=\"サービス・観光・飲食店\">サービス・観光・飲食店</option>\n                <option value=\"農業・一次産業\">農業・一次産業</option>\n                <option value=\"物流・運送\">物流・運送</option>\n                <option value=\"医療・福祉\">医療・福祉</option>\n                <option value=\"その他\">その他</option>\n              </select>\n              <ChevronRight className=\"text-slate-400 absolute right-3\" size={18} style={{ transform: 'rotate(90deg)' }} />\n            </div>\n            <button\n              type=\"submit\"\n              className=\"bg-blue-600 text-white px-8 py-3 md:py-0 rounded-xl md:rounded-2xl font-black hover:bg-blue-700 transition-all flex items-center justify-center gap-2 shadow-lg hover:shadow-blue-500/20 active:scale-95\"\n            >\n              検索する\n              <ChevronRight size={20} />\n            </button>\n          </form>\n\n          <div className=\"mt-6 flex flex-wrap justify-center items-center gap-3 text-white/80 text-xs font-bold\">\n            <span>人気のキーワード:</span>\n            <span\n              onClick={() => { setSearchQuery('短期体験'); router.push('/quests?q=短期体験'); }}\n              className=\"bg-white/10 backdrop-blur-md px-3 py-1 rounded-full hover:bg-white/20 cursor-pointer transition-colors border border-white/10\"\n            >\n              #短期体験\n            </span>\n            <span\n              onClick={() => { setSearchQuery('農業'); router.push('/quests?q=農業'); }}\n              className=\"bg-white/10 backdrop-blur-md px-3 py-1 rounded-full hover:bg-white/20 cursor-pointer transition-colors border border-white/10\"\n            >\n              #農業DX\n            </span>\n            <span\n              onClick={() => { setSearchQuery('未経験'); router.push('/quests?q=未経験'); }}\n              className=\"bg-white/10 backdrop-blur-md px-3 py-1 rounded-full hover:bg-white/20 cursor-pointer transition-colors border border-white/10\"\n            >\n              #未経験OK\n            </span>\n          </div>\n        </div>\n      </section>\n\n      {/* 3. Icon Menu (Quick Navigation) */}\n      <section className=\"max-w-7xl mx-auto px-6 -mt-10 relative z-20\">\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n          {[\n            { label: 'クエスト', icon: Map, color: 'bg-blue-500', href: '/quests', desc: '体験から始める', illustration: '/illustrations/quest_card.png' },\n            { label: '動画リール', icon: Film, color: 'bg-pink-500', href: '/reels', desc: '会社の空気を知る', illustration: '/illustrations/reels_card.png' },\n            { label: '求人一覧', icon: Briefcase, color: 'bg-indigo-500', href: '/jobs', desc: 'じっくり探す', illustration: '/illustrations/job_search.png' },\n            { label: 'eラーニング', icon: Zap, color: 'bg-amber-500', href: '/elearning', desc: 'スキルを磨く', illustration: '/illustrations/learning_growth.png' },\n          ].map((item) => (\n            <Link\n              key={item.label}\n              href={item.href}\n              className=\"relative bg-white p-6 rounded-[32px] shadow-xl shadow-slate-200/50 hover:shadow-2xl hover:-translate-y-2 transition-all group border border-slate-100/50 overflow-hidden\"\n            >\n              {/* Background illustration */}\n              <div className=\"absolute top-1/2 -translate-y-1/2 right-4 w-40 h-40 opacity-100 transition-opacity\">\n                <img src={item.illustration} alt=\"\" className=\"w-full h-full object-contain\" />\n              </div>\n\n              {/* Content */}\n              <div className=\"relative z-10\">\n                <div className={`${item.color} w-12 h-12 rounded-2xl text-white flex items-center justify-center mb-4 group-hover:scale-110 transition-transform shadow-lg`}>\n                  <item.icon size={26} />\n                </div>\n                <div className=\"font-black text-slate-800 text-lg mb-1\">{item.label}</div>\n                <div className=\"text-[10px] font-bold text-slate-400 uppercase tracking-widest\">{item.desc}</div>\n              </div>\n            </Link>\n          ))}\n        </div>\n      </section>\n\n      {/* 4. Pick Up Quests */}\n      <section className=\"max-w-7xl mx-auto px-6 py-20\">\n        <div className=\"flex items-end justify-between mb-10\">\n          <div>\n            <h2 className=\"text-3xl font-black text-slate-900 mb-2 flex items-center gap-3 tracking-tighter drop-shadow-sm\">\n              <Sparkles className=\"text-amber-500\" size={28} />\n              注目のクエスト\n            </h2>\n            <p className=\"text-slate-600 font-bold\">1日から体験できる、新しい出会いの形。</p>\n          </div>\n          <Link href=\"/quests\" className=\"flex items-center gap-2 text-blue-600 font-black text-sm hover:gap-4 transition-all\">\n            すべてのクエストを見る\n            <ArrowRight size={18} />\n          </Link>\n        </div>\n\n        <div className=\"grid md:grid-cols-2 lg:grid-cols-4 gap-6\">\n          {featuredQuests.map((quest) => {\n            const company = companies.find(c => c.id === quest.companyId);\n            return (\n              <Link\n                key={quest.id}\n                href={`/jobs/${quest.id}`}\n                className=\"bg-white rounded-3xl overflow-hidden border border-slate-100 shadow-sm hover:shadow-xl transition-all group flex flex-col\"\n              >\n                <div className=\"relative aspect-[16/9] overflow-hidden bg-slate-100\">\n                  {company?.image || company?.images?.[0] ? (\n                    <img\n                      src={company.image || company.images![0]}\n                      alt={company.name}\n                      className=\"w-full h-full object-cover\"\n                    />\n                  ) : (\n                    <>\n                      <div className={`absolute inset-0 ${company?.logoColor || 'bg-slate-200'} opacity-10`} />\n                      <div className=\"absolute inset-0 flex items-center justify-center\">\n                        <Map className=\"text-slate-200\" size={48} />\n                      </div>\n                    </>\n                  )}\n                  <div className=\"absolute top-3 left-3\">\n                    <span className=\"bg-white/90 backdrop-blur-md text-blue-600 px-3 py-1 rounded-full text-[10px] font-black shadow-sm\">\n                      {quest.category}\n                    </span>\n                  </div>\n                  {/* Video Reel Icon - Large, centered on right */}\n                  {((company as any)?.videos?.length > 0 || (company?.reels && company.reels.length > 0)) && (\n                    <div className=\"absolute right-10 top-1/2 -translate-y-1/2\">\n                      <div className=\"relative group/reel\">\n                        <div className=\"w-32 h-32 bg-gradient-to-br from-pink-500 to-purple-600 rounded-3xl p-[4px] shadow-2xl transform group-hover/reel:scale-110 transition-all overflow-hidden bg-black\">\n                          <div className=\"w-full h-full rounded-[20px] overflow-hidden relative\">\n                            {company?.reels?.[0]?.type === 'file' ? (\n                              <video\n                                src={`${company.reels[0].url}#t=0.01`}\n                                className=\"w-full h-full object-cover opacity-80\"\n                                muted\n                                playsInline\n                              />\n                            ) : company?.image ? (\n                              <img src={company.image} alt=\"Reel\" className=\"w-full h-full object-cover opacity-60\" />\n                            ) : (\n                              <div className=\"w-full h-full bg-slate-800\" />\n                            )}\n                            <div className=\"absolute inset-0 flex items-center justify-center bg-black/20 group-hover/reel:bg-black/10 transition-opacity group-hover/reel:opacity-0\">\n                              <Play className=\"text-white fill-white ml-2 drop-shadow-2xl\" size={56} />\n                            </div>\n                          </div>\n                        </div>\n                        <div className=\"absolute -bottom-2 -right-2 bg-slate-900 text-white px-3 py-1 rounded-full text-[10px] font-black shadow-lg border border-white/20\">\n                          REEL\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                </div>\n                <div className=\"p-5 flex-1 flex flex-col\">\n                  <div className=\"flex items-center gap-2 mb-3\">\n                    <div className=\"w-6 h-6 rounded-full overflow-hidden border border-slate-100 flex-shrink-0\">\n                      {company?.image ? (\n                        <img src={company.image} alt={company.name} className=\"w-full h-full object-cover\" />\n                      ) : (\n                        <div className={`w-full h-full ${company?.logoColor || 'bg-slate-400'} flex items-center justify-center text-[8px] text-white font-black`}>\n                          {company?.name.charAt(0)}\n                        </div>\n                      )}\n                    </div>\n                    <span className=\"text-[10px] font-black text-slate-400 group-hover:text-blue-600 transition-colors uppercase tracking-wider\">{company?.name}</span>\n                  </div>\n                  <h3 className=\"font-black text-slate-800 leading-tight mb-4 group-hover:text-blue-600 transition-colors line-clamp-2 min-h-[3rem]\">\n                    {quest.title}\n                  </h3>\n                  <div className=\"mt-auto pt-4 border-t border-slate-50 flex items-center justify-between\">\n                    <div className=\"flex items-center gap-1.5 text-slate-800 font-black text-xs\">\n                      <span className=\"text-amber-500\"><Wallet size={14} /></span>\n                      {quest.reward}\n                    </div>\n                    <div className=\"text-slate-300 group-hover:text-blue-500 transition-colors\">\n                      <ChevronRight size={18} />\n                    </div>\n                  </div>\n                </div>\n              </Link>\n            );\n          })}\n        </div>\n      </section>\n\n      {/* 5. Ehime Base Brand Story */}\n      <section className=\"bg-slate-900 py-24 relative overflow-hidden\">\n        <div className=\"absolute top-1/4 left-0 w-64 h-64 bg-blue-600 rounded-full blur-[120px] opacity-20 animate-pulse\" />\n        <div className=\"absolute bottom-1/4 right-0 w-96 h-96 bg-indigo-600 rounded-full blur-[150px] opacity-20 animate-pulse\" style={{ animationDelay: '700ms' }} />\n\n        <div className=\"max-w-7xl mx-auto px-6 relative z-10\">\n          <div className=\"grid md:grid-cols-2 gap-16 items-center\">\n            <div className=\"space-y-8\">\n              <div className=\"inline-flex items-center gap-2 bg-white/10 backdrop-blur-md px-4 py-1.5 rounded-full border border-white/20 text-white font-bold text-xs tracking-widest uppercase\">\n                Our Vision\n              </div>\n              <h2 className=\"text-4xl md:text-5xl font-black text-white leading-tight tracking-tighter\">\n                「非対称」が、<br />\n                <span className=\"text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-indigo-400 italic\">新しい風</span>を吹き込む。\n              </h2>\n              <p className=\"text-slate-400 text-lg leading-relaxed font-medium\">\n                従来の「履歴書と条件」だけでのマッチングはもう古い。<br />\n                企業が持つ「本音」と、あなたが隠している「情熱」がぶつかったとき、\n                愛媛の新しい未来が動き出します。\n              </p>\n              <div className=\"grid grid-cols-2 gap-6 pt-4\">\n                <div className=\"p-6 bg-white/5 rounded-3xl border border-white/10 hover:bg-white/10 transition-colors\">\n                  <div className=\"text-blue-400 font-black text-3xl mb-2\">1,200+</div>\n                  <div className=\"text-sm font-bold text-slate-300\">Ehime Spirits</div>\n                </div>\n                <div className=\"p-6 bg-white/5 rounded-3xl border border-white/10 hover:bg-white/10 transition-colors\">\n                  <div className=\"text-indigo-400 font-black text-3xl mb-2\">350+</div>\n                  <div className=\"text-sm font-bold text-slate-300\">Active Quests</div>\n                </div>\n              </div>\n            </div>\n            <div className=\"relative aspect-auto md:aspect-square\">\n              <div className=\"absolute inset-0 bg-blue-500/10 rounded-[60px] transform rotate-6 scale-95\" />\n              <div className=\"absolute inset-0 bg-white shadow-2xl rounded-[60px] overflow-hidden flex flex-col p-8 group hover:-rotate-1 transition-all duration-500\">\n                <div className=\"flex-1 flex flex-col justify-center items-center text-center\">\n                  <div className=\"w-24 h-24 bg-blue-100 text-blue-600 rounded-[32px] flex items-center justify-center mb-8 shadow-inner transform group-hover:rotate-12 transition-transform\">\n                    <Users size={48} />\n                  </div>\n                  <h3 className=\"text-2xl font-black text-slate-800 mb-4 tracking-tighter\">まずはカジュアルに<br />「体験」から始めよう</h3>\n                  <p className=\"text-slate-500 font-bold mb-8\">\n                    本採用の前に、1日だけ働いてみる。<br />\n                    会社の「中の人」とランチを食べてみる。<br />\n                    そんな小さな仕掛けをたくさん用意しています。\n                  </p>\n                  <button className=\"w-full bg-slate-900 text-white font-black py-5 rounded-3xl hover:bg-blue-600 transition-all flex items-center justify-center gap-2 shadow-xl shadow-slate-200\">\n                    詳細ガイドをチェック\n                    <ArrowRight />\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* 6. Featured Companies - Full Width Auto-Scrolling Carousel */}\n      <section className=\"w-full py-24 bg-white overflow-hidden\">\n        <div className=\"text-center mb-16 max-w-7xl mx-auto px-6\">\n          <h2 className=\"text-3xl font-black text-slate-900 mb-4 tracking-tight drop-shadow-sm\">参加している魅力的な企業</h2>\n          <div className=\"w-20 h-1 bg-blue-500 mx-auto rounded-full\" />\n        </div>\n\n        {/* Auto-scrolling container */}\n        <div className=\"relative\">\n          <div className=\"flex gap-8 animate-scroll\">\n            {/* Duplicate companies for seamless loop */}\n            {[...hotCompanies, ...hotCompanies, ...hotCompanies].map((c, idx) => (\n              <Link\n                key={`${c.id}-${idx}`}\n                href={`/companies/${c.id}`}\n                className=\"flex-shrink-0 w-64 opacity-90 hover:opacity-100 transition-all transform hover:scale-105 group\"\n              >\n                {c.image ? (\n                  <div className=\"w-full aspect-[3/2] rounded-2xl overflow-hidden shadow-lg border-2 border-slate-200 group-hover:border-blue-400 group-hover:shadow-2xl transition-all\">\n                    <img src={c.image} alt={c.name} className=\"w-full h-full object-cover\" />\n                  </div>\n                ) : (\n                  <div className={`${c.logoColor} aspect-[3/2] rounded-2xl text-white font-black text-2xl shadow-lg group-hover:shadow-2xl transition-all flex items-center justify-center`}>\n                    {c.name.slice(0, 3)}\n                  </div>\n                )}\n              </Link>\n            ))}\n          </div>\n        </div>\n      </section>\n\n      <style jsx>{`\n        @keyframes scroll {\n          0% {\n            transform: translateX(0);\n          }\n          100% {\n            transform: translateX(calc(-256px * ${hotCompanies.length} - 2rem * ${hotCompanies.length}));\n          }\n        }\n        \n        .animate-scroll {\n          animation: scroll 30s linear infinite;\n        }\n        \n        .animate-scroll:hover {\n          animation-play-state: paused;\n        }\n      `}</style>\n\n      {/* 7. Footer */}\n      <footer className=\"bg-white border-t border-slate-100 pt-20 pb-10\">\n        <div className=\"max-w-7xl mx-auto px-6 grid md:grid-cols-4 gap-12 mb-20\">\n          <div className=\"space-y-6\">\n            <Link href=\"/\" className=\"flex items-center gap-2\">\n              <img src=\"/eis_logo_mark.png\" alt=\"EIS\" className=\"h-8 w-auto\" />\n              <span className=\"font-black text-xl tracking-tighter text-slate-800\">Ehime Base</span>\n            </Link>\n            <p className=\"text-slate-400 text-sm font-bold leading-relaxed\">\n              愛媛の求職者と企業の「非対称性」をエネルギーに変え、新しい時代を創造するマッチングプラットフォーム。\n            </p>\n          </div>\n          <div>\n            <h4 className=\"font-black text-slate-800 mb-6 uppercase text-xs tracking-widest\">探す</h4>\n            <ul className=\"space-y-4 text-sm font-bold text-slate-500\">\n              <li><Link href=\"/quests\" className=\"hover:text-blue-600 transition-colors\">クエストを探す</Link></li>\n              <li><Link href=\"/jobs\" className=\"hover:text-blue-600 transition-colors\">求人を探す</Link></li>\n              <li><Link href=\"/reels\" className=\"hover:text-blue-600 transition-colors\">動画一覧</Link></li>\n              <li><Link href=\"/companies\" className=\"hover:text-blue-600 transition-colors\">企業一覧</Link></li>\n            </ul>\n          </div>\n          <div>\n            <h4 className=\"font-black text-slate-800 mb-6 uppercase text-xs tracking-widest\">Ehime Baseについて</h4>\n            <ul className=\"space-y-4 text-sm font-bold text-slate-500\">\n              <li><Link href=\"#\" className=\"hover:text-blue-600 transition-colors\">サービス概要</Link></li>\n              <li><Link href=\"#\" className=\"hover:text-blue-600 transition-colors\">運営会社</Link></li>\n              <li><Link href=\"#\" className=\"hover:text-blue-600 transition-colors\">利用規約</Link></li>\n              <li><Link href=\"#\" className=\"hover:text-blue-600 transition-colors\">プライバシーポリシー</Link></li>\n            </ul>\n          </div>\n          <div>\n            <h4 className=\"font-black text-slate-800 mb-6 uppercase text-xs tracking-widest\">企業の方へ</h4>\n            <p className=\"text-slate-400 text-xs font-bold leading-relaxed mb-4\">\n              採用課題の解決や魅力発信、教育プログラムの導入についてはこちらから。\n            </p>\n            <Link href=\"/login/company\" className=\"inline-block bg-slate-900 text-white px-6 py-3 rounded-xl font-black text-xs hover:bg-slate-700 transition-colors\">\n              法人向けページ\n            </Link>\n          </div>\n        </div>\n        <div className=\"text-center pt-10 border-t border-slate-50\">\n          <p className=\"text-[10px] font-black text-slate-300 uppercase tracking-widest leading-relaxed\">\n            © 2026 EHIME BASE Project by EIS LLC. / Empowering Regional Energy\n          </p>\n        </div>\n      </footer>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/progress/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/quests/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Job' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":13,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Job"},"fix":{"range":[325,329],"text":""},"desc":"Remove unused variable \"Job\"."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/quests/page.tsx:33:17\n  31 |             const regionName = areaMap[areaParam];\n  32 |             if (regionName && !selectedRegions.includes(regionName)) {\n> 33 |                 setSelectedRegions([regionName]);\n     |                 ^^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  34 |             }\n  35 |         }\n  36 |","line":33,"column":17,"nodeType":null,"endLine":33,"endColumn":35},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'searchParams', 'selectedCategories', and 'selectedRegions'. Either include them or remove the dependency array.","line":41,"column":8,"nodeType":"ArrayExpression","endLine":41,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [searchParams, selectedCategories, selectedRegions]","fix":{"range":[1696,1698],"text":"[searchParams, selectedCategories, selectedRegions]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState, useEffect, Suspense } from 'react';\nimport { useSearchParams } from 'next/navigation';\nimport Link from 'next/link';\nimport { useAppStore } from '@/lib/appStore';\nimport { Map, ArrowRight, Wallet, Clock, Info, Search, Filter, ChevronUp, ChevronDown, X } from 'lucide-react';\nimport { Job, Reel } from '@/lib/dummyData';\nimport { ReelIcon } from '@/components/reels/ReelIcon';\nimport { ReelModal } from '@/components/reels/ReelModal';\n\nfunction QuestsContent() {\n    const searchParams = useSearchParams();\n    const { jobs, companies } = useAppStore();\n    const [searchQuery, setSearchQuery] = useState(searchParams.get('q') || '');\n    const [selectedRegions, setSelectedRegions] = useState<string[]>([]);\n    const [selectedCategories, setSelectedCategories] = useState<string[]>([]);\n    const [isFilterOpen, setIsFilterOpen] = useState(false);\n\n    // Initialize area and industry filters from URL parameters\n    useEffect(() => {\n        const areaParam = searchParams.get('area');\n        const industryParam = searchParams.get('industry');\n\n        if (areaParam) {\n            const areaMap: { [key: string]: string } = {\n                'chuyo': '中予',\n                'toyo': '東予',\n                'nanyo': '南予'\n            };\n            const regionName = areaMap[areaParam];\n            if (regionName && !selectedRegions.includes(regionName)) {\n                setSelectedRegions([regionName]);\n            }\n        }\n\n        if (industryParam && !selectedCategories.includes(industryParam)) {\n            // Check if industryParam is one of the standardized industries\n            setSelectedCategories([industryParam]);\n        }\n    }, []);\n\n    // Reel State\n    const [isReelModalOpen, setIsReelModalOpen] = useState(false);\n    const [activeReels, setActiveReels] = useState<Reel[]>([]);\n    const [activeEntity, setActiveEntity] = useState<{ name: string, id: string, companyId?: string }>({ name: '', id: '' });\n\n    // Filter only quests\n    const allQuests = jobs.filter(j => j.type === 'quest');\n\n    // Extract unique filter options\n    const allRegions = ['中予', '東予', '南予'];\n    const allCategories = ['新卒', '中途', 'アルバイト', '体験JOB', 'インターンシップ', '会社説明会', 'IT・システム開発', '製造・エンジニアリング', 'サービス・観光・飲食店', '農業・一次産業', '物流・運送', '医療・福祉'];\n\n    const toggleRegion = (region: string) => {\n        if (selectedRegions.includes(region)) {\n            setSelectedRegions(selectedRegions.filter(r => r !== region));\n        } else {\n            setSelectedRegions([...selectedRegions, region]);\n        }\n    };\n\n    const toggleCategory = (category: string) => {\n        if (selectedCategories.includes(category)) {\n            setSelectedCategories(selectedCategories.filter(c => c !== category));\n        } else {\n            setSelectedCategories([...selectedCategories, category]);\n        }\n    };\n\n    const clearFilters = () => {\n        setSearchQuery('');\n        setSelectedRegions([]);\n        setSelectedCategories([]);\n    };\n\n    // Filter Logic\n    const filteredQuests = allQuests.filter(quest => {\n        const matchesSearch =\n            quest.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\n            quest.description.toLowerCase().includes(searchQuery.toLowerCase()) ||\n            companies.find(c => c.id === quest.companyId)?.name.toLowerCase().includes(searchQuery.toLowerCase());\n\n        const regionCities: Record<string, string[]> = {\n            '中予': ['松山', '伊予', '東温', '久万高原', '松前', '砥部'],\n            '東予': ['今治', '新居浜', '西条', '四国中央', '上島'],\n            '南予': ['宇和島', '八幡浜', '大洲', '西予', '内子', '伊方', '松野', '鬼北', '愛南']\n        };\n\n        const matchesRegion = selectedRegions.length === 0 || selectedRegions.some(region => {\n            if (quest.location?.includes(region)) return true;\n            const cities = regionCities[region] || [];\n            return cities.some(city => quest.location?.includes(city));\n        });\n\n        // Match either the quest's category OR the company's industry\n        const company = companies.find(c => c.id === quest.companyId);\n        const matchesCategory = selectedCategories.length === 0 ||\n            selectedCategories.includes(quest.category) ||\n            (company && selectedCategories.includes(company.industry));\n\n        return matchesSearch && matchesRegion && matchesCategory;\n    });\n\n    const activeFilterCount = selectedRegions.length + selectedCategories.length;\n\n    return (\n        <div className=\"min-h-screen bg-slate-50 pb-24 md:pb-0\">\n            {/* Unified Header Section */}\n            <div className=\"bg-white border-b border-slate-100 shadow-sm sticky top-0 z-20\">\n                <div className=\"max-w-7xl mx-auto p-4 md:p-6\">\n                    <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-4\">\n                        <div>\n                            <h1 className=\"text-2xl md:text-3xl font-black text-slate-800 flex items-center gap-3 tracking-tighter\">\n                                <Map size={32} className=\"text-blue-600\" />\n                                クエストを探す\n                            </h1>\n                            <p className=\"text-slate-500 font-bold mt-1 text-xs md:text-sm pl-11\">\n                                体験型ジョブや短期プロジェクトに参加して、スキルと報酬を手に入れよう。\n                            </p>\n                        </div>\n                    </div>\n\n                    {/* Unified Search & Filter Bar */}\n                    <div className=\"bg-slate-50 p-2 rounded-2xl border border-slate-200 shadow-inner\">\n                        <div className=\"relative flex items-center\">\n                            <div className=\"absolute left-4 text-slate-400 pointer-events-none\">\n                                <Search size={20} />\n                            </div>\n                            <input\n                                type=\"text\"\n                                placeholder=\"キーワードで検索 (例: 農業, イベント, スタッフ)...\"\n                                value={searchQuery}\n                                onChange={(e) => setSearchQuery(e.target.value)}\n                                className=\"w-full pl-12 pr-4 py-3.5 rounded-xl bg-slate-50 border-none focus:ring-0 font-bold text-slate-700 text-base placeholder:font-medium placeholder:text-slate-400\"\n                            />\n                            <div className=\"flex items-center gap-2 pr-2\">\n                                {(activeFilterCount > 0 || searchQuery) && (\n                                    <button\n                                        onClick={clearFilters}\n                                        className=\"p-2 hover:bg-slate-200 rounded-full text-slate-400 transition-colors\"\n                                        title=\"検索条件をクリア\"\n                                    >\n                                        <X size={20} />\n                                    </button>\n                                )}\n                                <button\n                                    onClick={() => setIsFilterOpen(!isFilterOpen)}\n                                    className={`flex items-center gap-2 px-5 py-2.5 rounded-xl font-bold transition-all whitespace-nowrap shadow-sm border ${isFilterOpen || activeFilterCount > 0\n                                        ? 'bg-slate-800 text-white border-slate-800 shadow-md transform scale-105'\n                                        : 'bg-white text-slate-600 border-slate-200 hover:bg-slate-100'\n                                        }`}\n                                >\n                                    <Filter size={18} />\n                                    <span className=\"hidden md:inline\">絞り込み</span>\n                                    {activeFilterCount > 0 && (\n                                        <span className=\"bg-blue-500 text-white text-[10px] px-1.5 py-0.5 rounded-full ml-1 min-w-[18px] text-center font-bold\">\n                                            {activeFilterCount}\n                                        </span>\n                                    )}\n                                    {isFilterOpen ? <ChevronUp size={16} /> : <ChevronDown size={16} />}\n                                </button>\n                            </div>\n                        </div>\n\n                        {/* Applied Filters Tags */}\n                        {(searchQuery || activeFilterCount > 0) && (\n                            <div className=\"flex flex-wrap items-center gap-2 px-4 py-2 bg-white/40 border-t border-slate-100/50\">\n                                <span className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest mr-1\">適用中:</span>\n                                {searchQuery && (\n                                    <span className=\"flex items-center gap-1 px-2 py-0.5 bg-blue-50 text-blue-700 text-[10px] font-black rounded-md border border-blue-100\">\n                                        キーワード: {searchQuery}\n                                        <X size={10} className=\"cursor-pointer\" onClick={() => setSearchQuery('')} />\n                                    </span>\n                                )}\n                                {selectedRegions.length > 0 && selectedRegions.map(region => (\n                                    <span key={region} className=\"flex items-center gap-1 px-2 py-0.5 bg-amber-50 text-amber-700 text-[10px] font-black rounded-md border border-amber-100\">\n                                        エリア: {region}\n                                        <X size={10} className=\"cursor-pointer\" onClick={() => toggleRegion(region)} />\n                                    </span>\n                                ))}\n                                {selectedCategories.length > 0 && selectedCategories.map(cat => (\n                                    <span key={cat} className=\"flex items-center gap-1 px-2 py-0.5 bg-slate-100 text-slate-700 text-[10px] font-black rounded-md border border-slate-200\">\n                                        {cat}\n                                        <X size={10} className=\"cursor-pointer\" onClick={() => toggleCategory(cat)} />\n                                    </span>\n                                ))}\n                            </div>\n                        )}\n\n                        {/* Collapsible Detailed Filters */}\n                        <div\n                            className={`overflow-hidden transition-all duration-300 ease-in-out ${isFilterOpen ? 'max-h-[800px] opacity-100' : 'max-h-0 opacity-0'\n                                }`}\n                        >\n                            <div className=\"p-4 md:p-6 border-t border-slate-200 bg-white/50 rounded-b-xl space-y-6 mt-2\">\n                                <div className=\"flex flex-col md:flex-row gap-6\">\n                                    {/* Region Filter */}\n                                    <div className=\"flex-1\">\n                                        <div className=\"flex items-center gap-2 mb-3\">\n                                            <span className=\"text-sm font-black text-slate-700\">エリア</span>\n                                        </div>\n                                        <div className=\"flex flex-wrap gap-2\">\n                                            {allRegions.map(region => (\n                                                <button\n                                                    key={region}\n                                                    onClick={() => toggleRegion(region)}\n                                                    className={`px-4 py-2.5 rounded-full text-sm font-bold transition-all border shadow-sm hover:-translate-y-0.5 ${selectedRegions.includes(region)\n                                                        ? 'bg-blue-600 text-white border-blue-600 ring-2 ring-blue-200'\n                                                        : 'bg-white text-slate-600 border-slate-200 hover:border-slate-300 hover:shadow-md'\n                                                        }`}\n                                                >\n                                                    {region}\n                                                </button>\n                                            ))}\n                                        </div>\n                                    </div>\n\n                                    {/* Category Filter */}\n                                    <div className=\"flex-1 md:border-l md:border-slate-100 md:pl-6\">\n                                        <div className=\"flex items-center gap-2 mb-3\">\n                                            <span className=\"text-sm font-black text-slate-700\">カテゴリ</span>\n                                        </div>\n                                        <div className=\"flex flex-wrap gap-2\">\n                                            {allCategories.map(category => (\n                                                <button\n                                                    key={category}\n                                                    onClick={() => toggleCategory(category)}\n                                                    className={`px-4 py-2.5 rounded-full text-sm font-bold transition-all border shadow-sm hover:-translate-y-0.5 ${selectedCategories.includes(category)\n                                                        ? 'bg-emerald-600 text-white border-emerald-600 ring-2 ring-emerald-200'\n                                                        : 'bg-white text-slate-600 border-slate-200 hover:border-slate-300 hover:shadow-md'\n                                                        }`}\n                                                >\n                                                    {category}\n                                                </button>\n                                            ))}\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <div className=\"p-4 md:p-8 max-w-4xl mx-auto\">\n\n\n                {/* Results Count */}\n                < div className=\"mb-4 text-slate-500 text-sm font-bold\" >\n                    {filteredQuests.length}件のクエストが見つかりました\n                </div >\n\n                <div className=\"grid gap-4\">\n                    {filteredQuests.map(quest => {\n                        const company = companies.find(c => c.id === quest.companyId);\n                        return (\n                            <Link\n                                href={`/jobs/${quest.id}`} // Quests are jobs in the data model\n                                key={quest.id}\n                                className=\"block bg-white p-5 rounded-2xl shadow-sm hover:shadow-md transition-shadow border border-slate-100 group relative\"\n                            >\n                                <div className=\"absolute right-6 top-1/2 -translate-y-1/2 z-10 transition-transform group-hover:scale-110\">\n                                    <ReelIcon\n                                        reels={company?.reels || []}\n                                        fallbackImage={company?.image}\n                                        onClick={() => {\n                                            setActiveReels(company?.reels || []);\n                                            setActiveEntity({ name: quest.title, id: quest.id, companyId: company?.id });\n                                            setIsReelModalOpen(true);\n                                        }}\n                                    />\n                                </div>\n                                <div className=\"flex justify-between items-start mb-3 pr-36\">\n                                    <span className=\"bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-xs font-bold\">\n                                        {quest.category}\n                                    </span>\n                                    {quest.reward && (\n                                        <span className=\"flex items-center gap-1 text-slate-800 font-bold text-sm bg-yellow-100 px-3 py-1 rounded-full text-yellow-800\">\n                                            <Wallet size={14} />\n                                            {quest.reward}\n                                        </span>\n                                    )}\n                                </div>\n                                <h3 className=\"text-lg font-bold text-slate-800 mb-2 group-hover:text-blue-600 transition-colors\">\n                                    {quest.title}\n                                </h3>\n                                <div className=\"flex items-center gap-2 text-slate-500 text-xs font-bold mb-4\">\n                                    <div className={`w-5 h-5 rounded-full flex items-center justify-center text-white text-[10px] ${company?.logoColor || 'bg-slate-400'}`}>\n                                        {company?.name.slice(0, 1) || 'C'}\n                                    </div>\n                                    {company?.name}\n                                </div>\n\n                                <div className=\"space-y-2 mb-4\">\n                                    <div className=\"flex items-center gap-2 text-slate-600 text-sm\">\n                                        <Info size={16} className=\"text-slate-400\" />\n                                        <span className=\"line-clamp-1\">{quest.description}</span>\n                                    </div>\n                                    {quest.workingHours && (\n                                        <div className=\"flex items-center gap-2 text-slate-600 text-sm\">\n                                            <Clock size={16} className=\"text-slate-400\" />\n                                            <span>{quest.workingHours}</span>\n                                        </div>\n                                    )}\n                                </div>\n\n                                <div className=\"flex items-center justify-end text-blue-600 text-sm font-bold gap-1 mt-2\">\n                                    詳細を見る <ArrowRight size={16} />\n                                </div>\n                            </Link>\n                        );\n                    })}\n                </div>\n\n                {\n                    filteredQuests.length === 0 && (\n                        <div className=\"text-center py-20 text-slate-400\">\n                            <p className=\"font-bold\">条件に一致するクエストが見つかりませんでした。</p>\n                            <button\n                                onClick={clearFilters}\n                                className=\"mt-4 text-blue-600 hover:underline text-sm font-bold\"\n                            >\n                                条件をクリアして全件表示\n                            </button>\n                        </div>\n                    )\n                }\n            </div >\n\n            <ReelModal\n                isOpen={isReelModalOpen}\n                onClose={() => setIsReelModalOpen(false)}\n                reels={activeReels}\n                entityName={activeEntity.name}\n                entityId={activeEntity.id}\n                entityType=\"job\" // Quests are internally job structures\n                companyId={activeEntity.companyId}\n            />\n        </div >\n    );\n}\n\nexport default function QuestsPage() {\n    return (\n        <Suspense fallback={\n            <div className=\"min-h-screen bg-slate-50 flex items-center justify-center\">\n                <div className=\"animate-pulse flex flex-col items-center gap-4\">\n                    <div className=\"w-12 h-12 bg-slate-200 rounded-full\"></div>\n                    <div className=\"h-4 w-32 bg-slate-200 rounded-lg\"></div>\n                </div>\n            </div>\n        }>\n            <QuestsContent />\n        </Suspense>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/reels/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ReelIcon' is defined but never used.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":18,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"ReelIcon"},"fix":{"range":[174,229],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronUp' is defined but never used.","line":9,"column":54,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":63,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ChevronUp"},"fix":{"range":[379,390],"text":""},"desc":"Remove unused variable \"ChevronUp\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'company' is assigned a value but never used.","line":32,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isFilterOpen' is assigned a value but never used.","line":50,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":50,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setIsFilterOpen' is assigned a value but never used.","line":50,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":50,"endColumn":41},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/reels/page.tsx:63:13\n  61 |                 'nanyo': '南予'\n  62 |             };\n> 63 |             setSelectedArea(areaMap[areaParam] || '');\n     |             ^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  64 |         }\n  65 |         if (industryParam) {\n  66 |             setSelectedIndustry(industryParam);","line":63,"column":13,"nodeType":null,"endLine":63,"endColumn":28},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'searchParams'. Either include it or remove the dependency array.","line":68,"column":8,"nodeType":"ArrayExpression","endLine":68,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [searchParams]","fix":{"range":[2687,2689],"text":"[searchParams]"}}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":218,"column":37,"nodeType":"JSXOpeningElement","endLine":222,"endColumn":39}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState, Suspense, useEffect } from 'react';\nimport { useAppStore } from '@/lib/appStore';\nimport { useSearchParams } from 'next/navigation';\nimport { ReelIcon } from '@/components/reels/ReelIcon';\nimport { ReelModal } from '@/components/reels/ReelModal';\nimport { Reel } from '@/lib/dummyData';\nimport { Film, Play, Search, Filter, X, ChevronDown, ChevronUp } from 'lucide-react';\n\nfunction ReelsContent() {\n    const searchParams = useSearchParams();\n    const { companies, jobs } = useAppStore();\n\n    // Aggregate all reels from companies and jobs\n    const allReels: { reel: Reel, entityName: string, entityId: string, type: 'company' | 'job', companyId?: string }[] = [];\n\n    companies.forEach(company => {\n        if (company.reels) {\n            company.reels.forEach(reel => {\n                allReels.push({\n                    reel,\n                    entityName: company.name,\n                    entityId: company.id,\n                    type: 'company'\n                });\n            });\n        }\n    });\n\n    jobs.forEach(job => {\n        const company = companies.find(c => c.id === job.companyId);\n        // If jobs have specific reels in the future, we add them here.\n        // Currently, we might show company reels linked to jobs, but to avoid duplicates in a specific \"feed\", \n        // we should probably just stick to unique sources. \n        // For now, let's just list company reels as that's what we populated.\n    });\n\n    // Reel State\n    const [isReelModalOpen, setIsReelModalOpen] = useState(false);\n    const [activeReels, setActiveReels] = useState<Reel[]>([]);\n    const [startIndex, setStartIndex] = useState(0);\n    const [activeEntity, setActiveEntity] = useState<{ name: string, id: string, companyId?: string }>({ name: '', id: '' });\n    const [activeType, setActiveType] = useState<'company' | 'job'>('company');\n\n    // Filter State\n    const [searchQuery, setSearchQuery] = useState(searchParams.get('q') || '');\n    const [selectedArea, setSelectedArea] = useState('');\n    const [selectedIndustry, setSelectedIndustry] = useState('');\n    const [isFilterOpen, setIsFilterOpen] = useState(false);\n\n    // Initialize from URL\n    useEffect(() => {\n        const areaParam = searchParams.get('area');\n        const industryParam = searchParams.get('industry');\n\n        if (areaParam) {\n            const areaMap: Record<string, string> = {\n                'chuyo': '中予',\n                'toyo': '東予',\n                'nanyo': '南予'\n            };\n            setSelectedArea(areaMap[areaParam] || '');\n        }\n        if (industryParam) {\n            setSelectedIndustry(industryParam);\n        }\n    }, []);\n\n    // Filter Logic\n    const filteredReels = allReels.filter(item => {\n        const company = companies.find(c => c.id === item.entityId || c.id === item.companyId);\n\n        const query = searchQuery.toLowerCase();\n        const matchesSearch = !query ||\n            item.entityName.toLowerCase().includes(query) ||\n            item.reel.title.toLowerCase().includes(query) ||\n            company?.location.toLowerCase().includes(query);\n\n        const regionCities: Record<string, string[]> = {\n            '中予': ['松山', '伊予', '東温', '久万高原', '松前', '砥部'],\n            '東予': ['今治', '新居浜', '西条', '四国中央', '上島'],\n            '南予': ['宇和島', '八幡浜', '大洲', '西予', '内子', '伊方', '松野', '鬼北', '愛南']\n        };\n        const cities = regionCities[selectedArea] || [];\n        const matchesArea = !selectedArea ||\n            company?.location.includes(selectedArea) ||\n            cities.some(city => company?.location.includes(city));\n\n        const matchesIndustry = !selectedIndustry || company?.industry === selectedIndustry;\n\n        return matchesSearch && matchesArea && matchesIndustry;\n    });\n\n    const clearFilters = () => {\n        setSearchQuery('');\n        setSelectedArea('');\n        setSelectedIndustry('');\n    };\n\n    const handleReelClick = (index: number) => {\n        // Construct a list of all reels for the modal to swipe through\n        const reelsList = allReels.map(item => item.reel);\n        setActiveReels(reelsList);\n        setStartIndex(index);\n\n        const currentItem = allReels[index];\n        setActiveEntity({\n            name: currentItem.entityName,\n            id: currentItem.entityId,\n            companyId: currentItem.companyId\n        });\n        setActiveType(currentItem.type);\n\n        setIsReelModalOpen(true);\n    };\n\n    return (\n        <div className=\"min-h-screen bg-slate-50 pb-24 md:pb-0\">\n            {/* Unified Header Section */}\n            <div className=\"bg-white border-b border-slate-100 shadow-sm sticky top-0 z-20\">\n                <div className=\"max-w-7xl mx-auto p-4 md:p-6\">\n                    <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-4\">\n                        <div>\n                            <h1 className=\"text-2xl md:text-3xl font-black text-slate-800 flex items-center gap-3 tracking-tighter\">\n                                <Film size={32} className=\"text-pink-500\" />\n                                動画で探す\n                            </h1>\n                            <p className=\"text-slate-500 font-bold mt-1 text-xs md:text-sm pl-11\">\n                                企業の雰囲気をショート動画で体験しよう。\n                            </p>\n                        </div>\n                    </div>\n\n                    {/* Unified Search & Filter Bar */}\n                    <div className=\"bg-slate-50 p-2 rounded-2xl border border-slate-200 shadow-inner\">\n                        <div className=\"relative flex items-center\">\n                            <div className=\"absolute left-4 text-slate-400 pointer-events-none\">\n                                <Search size={20} />\n                            </div>\n                            <input\n                                type=\"text\"\n                                placeholder=\"キーワード検索 (企業名, 動画タイトル)...\"\n                                value={searchQuery}\n                                onChange={(e) => setSearchQuery(e.target.value)}\n                                className=\"w-full pl-12 pr-4 py-3.5 rounded-xl bg-slate-50 border-none focus:ring-0 font-bold text-slate-700 text-base placeholder:font-medium placeholder:text-slate-400\"\n                            />\n                            <div className=\"flex items-center gap-2 pr-2\">\n                                {(searchQuery || selectedArea || selectedIndustry) && (\n                                    <button\n                                        onClick={clearFilters}\n                                        className=\"p-2 hover:bg-slate-200 rounded-full text-slate-400 transition-colors\"\n                                        title=\"検索条件をクリア\"\n                                    >\n                                        <X size={20} />\n                                    </button>\n                                )}\n                                {/* Filter button placeholder - disabled style until filters exist */}\n                                <button\n                                    className=\"flex items-center gap-2 px-5 py-2.5 rounded-xl font-bold transition-all whitespace-nowrap shadow-sm border bg-white text-slate-400 border-slate-200 opacity-50 cursor-not-allowed\"\n                                >\n                                    <Filter size={18} />\n                                    <span className=\"hidden md:inline\">絞り込み</span>\n                                    <ChevronDown size={16} />\n                                </button>\n                            </div>\n                        </div>\n\n                        {/* Applied Filters Tags */}\n                        {(searchQuery || selectedArea || selectedIndustry) && (\n                            <div className=\"flex flex-wrap items-center gap-2 px-4 py-2 bg-white/40 border-t border-slate-100/50\">\n                                <span className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest mr-1\">適用中:</span>\n                                {searchQuery && (\n                                    <span className=\"flex items-center gap-1 px-2 py-0.5 bg-blue-50 text-blue-700 text-[10px] font-black rounded-md border border-blue-100\">\n                                        キーワード: {searchQuery}\n                                        <X size={10} className=\"cursor-pointer\" onClick={() => setSearchQuery('')} />\n                                    </span>\n                                )}\n                                {selectedArea && (\n                                    <span className=\"flex items-center gap-1 px-2 py-0.5 bg-amber-50 text-amber-700 text-[10px] font-black rounded-md border border-amber-100\">\n                                        エリア: {selectedArea}\n                                        <X size={10} className=\"cursor-pointer\" onClick={() => setSelectedArea('')} />\n                                    </span>\n                                )}\n                                {selectedIndustry && (\n                                    <span className=\"flex items-center gap-1 px-2 py-0.5 bg-indigo-50 text-indigo-700 text-[10px] font-black rounded-md border border-indigo-100\">\n                                        業種: {selectedIndustry}\n                                        <X size={10} className=\"cursor-pointer\" onClick={() => setSelectedIndustry('')} />\n                                    </span>\n                                )}\n                            </div>\n                        )}\n                    </div>\n                </div>\n            </div>\n\n            <div className=\"p-4 md:p-8 max-w-7xl mx-auto\">\n                <div className=\"flex items-center justify-between px-2 mb-2\">\n                    <span className=\"text-sm font-bold text-slate-500\">{filteredReels.length}本の動画</span>\n                </div>\n\n                {filteredReels.length > 0 ? (\n                    <div className=\"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4\">\n                        {filteredReels.map((item, index) => (\n                            <button\n                                key={`${item.type}-${item.entityId}-${item.reel.id}`}\n                                onClick={() => handleReelClick(index)}\n                                className=\"relative aspect-[9/16] rounded-2xl overflow-hidden group shadow-md hover:shadow-xl transition-all hover:scale-105 border border-slate-100 bg-black\"\n                            >\n                                {item.reel.type === 'file' ? (\n                                    <video\n                                        src={item.reel.url}\n                                        className=\"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity\"\n                                        muted\n                                        playsInline\n                                    />\n                                ) : (\n                                    <img\n                                        src={`https://img.youtube.com/vi/${item.reel.url.split('embed/')[1]}/0.jpg`}\n                                        alt={item.reel.title}\n                                        className=\"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity\"\n                                    />\n                                )}\n\n                                <div className=\"absolute inset-0 bg-gradient-to-b from-transparent via-transparent to-black/80\" />\n\n                                <div className=\"absolute center inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300\">\n                                    <div className=\"bg-white/20 backdrop-blur-sm p-3 rounded-full\">\n                                        <Play size={24} className=\"text-white fill-white\" />\n                                    </div>\n                                </div>\n\n                                <div className=\"absolute bottom-0 left-0 right-0 p-3 text-left\">\n                                    <p className=\"text-white text-xs font-bold line-clamp-1 drop-shadow-md mb-0.5\">\n                                        {item.entityName}\n                                    </p>\n                                    <p className=\"text-white/80 text-[10px] font-medium line-clamp-1\">\n                                        {item.reel.title}\n                                    </p>\n                                </div>\n                            </button>\n                        ))}\n                    </div>\n                ) : (\n                    <div className=\"text-center py-20 text-slate-400 font-bold\">\n                        動画コンテンツはまだありません。\n                    </div>\n                )}\n            </div>\n\n            {/* \n               Note: The current ReelModal takes a list of reels and an index. \n               However, it also takes single entityName/ID. \n               To support a \"Feed\" where each reel belongs to a different entity, \n               ReelModal might need refactoring or we pass generic tracking data.\n               For this iteration, we'll open the modal with ALL reels, \n               but the modal needs to update the \"entity info\" displayed at the bottom \n               as the user swipes. \n               \n               Currently ReelModal expects `entityName` as a static prop.\n               I should update ReelModal to likely accept an array of \"ReelItems\" which contain metadata,\n               OR just accept it works for a single entity for now.\n               \n               Given the user wants \"Find by Video\", a \"TikTok style feed\" is expected.\n               I will stick to the grid for now which opens the specific reel. \n               Swiping between reels of *different* companies in the modal would require \n               refactoring ReelModal to accept `items: {reel: Reel, entity: ...}[]`.\n               \n               I will assume for this step, just opening the specific reel in the modal is defined MVP. \n            */}\n            <ReelModal\n                isOpen={isReelModalOpen}\n                onClose={() => setIsReelModalOpen(false)}\n                reels={activeReels} // Passing all reels\n                initialReelIndex={startIndex}\n                entityName={activeEntity.name} // This will be static for the open session unless modal changes it\n                entityId={activeEntity.id}\n                entityType={activeType}\n                companyId={activeEntity.companyId}\n            />\n        </div>\n    );\n}\n\nexport default function ReelsPage() {\n    return (\n        <Suspense fallback={\n            <div className=\"min-h-screen bg-slate-50 flex items-center justify-center\">\n                <div className=\"animate-pulse flex flex-col items-center gap-4\">\n                    <div className=\"w-12 h-12 bg-slate-200 rounded-full\"></div>\n                    <div className=\"h-4 w-32 bg-slate-200 rounded-lg\"></div>\n                </div>\n            </div>\n        }>\n            <ReelsContent />\n        </Suspense>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/reskill/course/[id]/page.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":23,"column":17,"nodeType":"JSXOpeningElement","endLine":23,"endColumn":100},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":97,"column":29,"nodeType":"JSXOpeningElement","endLine":97,"endColumn":140}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { use } from 'react';\nimport { COURSES } from '@/lib/learningData';\nimport {\n    ChevronLeft, PlayCircle, Clock, Award,\n    BookOpen, CheckCircle2, ArrowRight\n} from 'lucide-react';\nimport Link from 'next/link';\nimport { useAppStore } from '@/lib/appStore';\n\nexport default function CourseDetailPage({ params }: { params: Promise<{ id: string }> }) {\n    const { id } = use(params);\n    const course = COURSES.find(c => c.id === id);\n    const { isLessonCompleted } = useAppStore();\n\n    if (!course) return <div>Course not found</div>;\n\n    return (\n        <div className=\"min-h-screen bg-white\">\n            {/* Simple Hero Header */}\n            <div className=\"relative h-64 md:h-96 bg-slate-900 border-b border-slate-200\">\n                <img src={course.image} className=\"w-full h-full object-cover opacity-60\" alt=\"\" />\n                <div className=\"absolute inset-0 bg-gradient-to-t from-slate-900 to-transparent\" />\n\n                <nav className=\"absolute top-0 left-0 right-0 p-6 flex items-center justify-between\">\n                    <Link href=\"/reskill/courses\" className=\"text-white hover:bg-white/10 p-2 rounded-full transition-colors\">\n                        <ChevronLeft size={24} />\n                    </Link>\n                </nav>\n\n                <div className=\"absolute bottom-12 left-6 right-6 max-w-4xl mx-auto text-white\">\n                    <span className=\"bg-blue-600 px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-widest shadow-lg\">\n                        {course.category}\n                    </span>\n                    <h1 className=\"text-4xl md:text-5xl font-black mt-6 leading-tight tracking-tight\">{course.title}</h1>\n                    <div className=\"flex flex-wrap items-center gap-6 mt-6\">\n                        <div className=\"flex items-center gap-2\">\n                            <Clock size={16} className=\"text-blue-400\" />\n                            <span className=\"text-sm font-bold text-slate-300\">{course.duration}</span>\n                        </div>\n                        <div className=\"flex items-center gap-2\">\n                            <Award size={16} className=\"text-amber-400\" />\n                            <span className=\"text-sm font-bold text-slate-300\">{course.level}</span>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <main className=\"max-w-4xl mx-auto px-6 py-12 md:py-20 grid grid-cols-1 md:grid-cols-3 gap-12\">\n                {/* Curriculum List */}\n                <div className=\"md:col-span-2 space-y-12\">\n                    <section>\n                        <h2 className=\"text-2xl font-black text-slate-800 mb-6 flex items-center gap-2\">\n                            <BookOpen className=\"text-blue-600\" />\n                            カリキュラム\n                        </h2>\n                        <div className=\"space-y-4\">\n                            {course.curriculums.map((curr) => (\n                                <div key={curr.id} className=\"bg-slate-50 rounded-3xl p-6 border border-slate-100\">\n                                    <div className=\"flex justify-between items-start mb-4\">\n                                        <div>\n                                            <span className=\"text-[10px] font-black text-blue-500 uppercase tracking-widest\">Step {curr.order}</span>\n                                            <h3 className=\"text-lg font-black text-slate-800\">{curr.title}</h3>\n                                        </div>\n                                    </div>\n                                    <div className=\"space-y-2\">\n                                        {curr.lessons.map((lesson) => (\n                                            <Link\n                                                key={lesson.id}\n                                                href={`/reskill/lesson/${lesson.id}`}\n                                                className=\"flex items-center justify-between p-4 bg-white hover:bg-white hover:shadow-md rounded-2xl transition-all group\"\n                                            >\n                                                <div className=\"flex items-center gap-3\">\n                                                    {isLessonCompleted(lesson.id) ? (\n                                                        <CheckCircle2 size={18} className=\"text-emerald-500\" />\n                                                    ) : (\n                                                        <PlayCircle size={18} className=\"text-slate-300 group-hover:text-blue-600\" />\n                                                    )}\n                                                    <span className=\"text-[13px] font-bold text-slate-600 group-hover:text-slate-900 line-clamp-1\">{lesson.title}</span>\n                                                </div>\n                                                <span className=\"text-[11px] font-bold text-slate-400\">{lesson.duration}</span>\n                                            </Link>\n                                        ))}\n                                    </div>\n                                </div>\n                            ))}\n                        </div>\n                    </section>\n                </div>\n\n                {/* Sidebar Intro */}\n                <div className=\"space-y-10\">\n                    <section className=\"bg-slate-50 rounded-3xl p-8 border border-slate-100\">\n                        <h3 className=\"text-sm font-black text-slate-400 uppercase tracking-widest mb-4\">Instructor</h3>\n                        <div className=\"flex items-center gap-4 mb-4\">\n                            <img src={course.instructor.image} className=\"w-16 h-16 rounded-full border-4 border-white shadow-lg\" alt=\"\" />\n                            <div>\n                                <p className=\"font-black text-slate-900\">{course.instructor.name}</p>\n                                <p className=\"text-xs font-bold text-slate-500 leading-tight mt-1\">{course.instructor.role}</p>\n                            </div>\n                        </div>\n                        <p className=\"text-xs text-slate-500 font-medium leading-relaxed\">\n                            愛媛の地方創生とDXを牽引するエキスパート。現場での豊富な経験を活かし、実践的なスキルを伝授します。\n                        </p>\n                    </section>\n\n                    <Link\n                        href={`/reskill/lesson/${course.curriculums[0].lessons[0].id}`}\n                        className=\"w-full bg-slate-900 text-white font-black py-5 rounded-[2rem] flex items-center justify-center gap-3 shadow-2xl shadow-blue-900/40 hover:bg-slate-800 active:scale-95 transition-all group\"\n                    >\n                        コースを始める <ArrowRight size={20} className=\"group-hover:translate-x-1 transition-transform\" />\n                    </Link>\n                </div>\n            </main>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/reskill/courses/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Filter' is defined but never used.","line":6,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":29,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Filter"},"fix":{"range":[131,139],"text":""},"desc":"Remove unused variable \"Filter\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronRight' is defined but never used.","line":6,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":50,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ChevronRight"},"fix":{"range":[146,160],"text":""},"desc":"Remove unused variable \"ChevronRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronLeft' is defined but never used.","line":7,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":16,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ChevronLeft"},"fix":{"range":[160,177],"text":""},"desc":"Remove unused variable \"ChevronLeft\"."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":100,"column":37,"nodeType":"JSXOpeningElement","endLine":104,"endColumn":39},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":135,"column":45,"nodeType":"JSXOpeningElement","endLine":135,"endColumn":171}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState } from 'react';\nimport { useAppStore } from '@/lib/appStore';\nimport {\n    BookOpen, Search, Filter, Clock, ChevronRight,\n    ChevronLeft, ArrowRight, GraduationCap,\n    Lightbulb, Layout as LayoutIcon\n} from 'lucide-react';\nimport Link from 'next/link';\n\nexport default function CoursesListPage() {\n    const { completedLessonIds, courses, fetchCourses } = useAppStore();\n    const [searchQuery, setSearchQuery] = useState('');\n    const [selectedCategory, setSelectedCategory] = useState('すべて');\n\n    React.useEffect(() => {\n        if (courses.length === 0) {\n            fetchCourses();\n        }\n    }, [courses.length, fetchCourses]);\n\n    const categories = ['すべて', ...Array.from(new Set(courses.map(c => c.category)))];\n\n    const filteredCourses = courses.filter(course => {\n        const matchesSearch = course.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\n            course.description.toLowerCase().includes(searchQuery.toLowerCase());\n        const matchesCategory = selectedCategory === 'すべて' || course.category === selectedCategory;\n        return matchesSearch && matchesCategory;\n    });\n\n    const getProgress = (courseId: string) => {\n        const course = courses.find(c => c.id === courseId);\n        if (!course) return 0;\n        const allLessons = course.curriculums.flatMap(curr => curr.lessons);\n        const completed = allLessons.filter(l => completedLessonIds.includes(l.id)).length;\n        return Math.round((completed / allLessons.length) * 100);\n    };\n\n    return (\n        <div className=\"min-h-screen bg-slate-50 pb-20\">\n            {/* Header Section */}\n            <div className=\"bg-white border-b border-slate-200\">\n                <div className=\"max-w-7xl mx-auto px-6 py-12 md:py-20 flex flex-col items-center text-center\">\n                    <div className=\"bg-blue-50 text-blue-600 px-4 py-1.5 rounded-full text-xs font-black uppercase tracking-widest mb-6 border border-blue-100 flex items-center gap-2\">\n                        <GraduationCap size={16} /> Reskill University\n                    </div>\n                    <h1 className=\"text-4xl md:text-6xl font-black text-slate-900 tracking-tight mb-6 leading-tight\">\n                        愛媛で、一生モノの<br /><span className=\"text-blue-600\">スキルを磨こう。</span>\n                    </h1>\n                    <p className=\"max-w-2xl text-slate-500 font-bold text-lg md:text-xl leading-relaxed\">\n                        地域DX、ITエンジニアリング、ビジネスマナーまで。<br className=\"hidden md:block\" />\n                        地元の企業の「今」必要としているスキルを体系的に学びます。\n                    </p>\n                </div>\n            </div>\n\n            {/* Filter & Search Bar */}\n            <div className=\"max-w-7xl mx-auto px-6 -mt-8 relative z-20\">\n                <div className=\"bg-white p-4 md:p-6 rounded-[2rem] shadow-xl shadow-blue-900/5 border border-slate-100 flex flex-col md:flex-row gap-4\">\n                    <div className=\"flex-1 relative\">\n                        <Search className=\"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400\" size={20} />\n                        <input\n                            type=\"text\"\n                            placeholder=\"コース名やキーワードで検索...\"\n                            value={searchQuery}\n                            onChange={(e) => setSearchQuery(e.target.value)}\n                            className=\"w-full pl-12 pr-4 py-4 bg-slate-50 border-none rounded-2xl font-bold focus:ring-2 focus:ring-blue-500/20 transition-all outline-none\"\n                        />\n                    </div>\n                    <div className=\"flex gap-2 overflow-x-auto pb-2 md:pb-0 scrollbar-hide\">\n                        {categories.map(cat => (\n                            <button\n                                key={cat}\n                                onClick={() => setSelectedCategory(cat)}\n                                className={`px-6 py-4 rounded-2xl text-sm font-black transition-all whitespace-nowrap ${selectedCategory === cat\n                                    ? 'bg-slate-900 text-white shadow-lg'\n                                    : 'bg-slate-50 text-slate-500 hover:bg-slate-100'\n                                    }`}\n                            >\n                                {cat}\n                            </button>\n                        ))}\n                    </div>\n                </div>\n            </div>\n\n            <main className=\"max-w-7xl mx-auto px-6 py-12 space-y-12\">\n                {/* Courses Grid */}\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\">\n                    {filteredCourses.map(course => {\n                        const progress = getProgress(course.id);\n                        return (\n                            <Link\n                                key={course.id}\n                                href={`/reskill/course/${course.id}`}\n                                className=\"group bg-white rounded-[2.5rem] border border-slate-200 overflow-hidden hover:shadow-2xl transition-all h-full flex flex-col\"\n                            >\n                                <div className=\"aspect-video relative overflow-hidden\">\n                                    <img\n                                        src={course.image}\n                                        className=\"w-full h-full object-cover group-hover:scale-110 transition-transform duration-700\"\n                                        alt={course.title}\n                                    />\n                                    <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent\" />\n                                    <div className=\"absolute bottom-4 left-6 right-6 flex justify-between items-center\">\n                                        <span className=\"bg-blue-600 text-white px-3 py-1 rounded-full text-[10px] font-black shadow-lg\">\n                                            {course.category}\n                                        </span>\n                                        <div className=\"flex items-center gap-1.5 text-white text-[10px] font-black\">\n                                            <Clock size={14} /> {course.duration}\n                                        </div>\n                                    </div>\n                                </div>\n                                <div className=\"p-8 flex-1 flex flex-col justify-between\">\n                                    <div>\n                                        <div className=\"flex items-center justify-between mb-3\">\n                                            <span className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest\">{course.level}</span>\n                                            {progress > 0 && (\n                                                <span className=\"text-emerald-500 text-[10px] font-black flex items-center gap-1\">\n                                                    学習中: {progress}%\n                                                </span>\n                                            )}\n                                        </div>\n                                        <h3 className=\"text-xl font-black text-slate-800 leading-tight mb-4 group-hover:text-blue-600 transition-colors\">\n                                            {course.title}\n                                        </h3>\n                                        <p className=\"text-sm text-slate-500 font-medium line-clamp-2\">\n                                            {course.description}\n                                        </p>\n                                    </div>\n\n                                    <div className=\"mt-8 pt-6 border-t border-slate-50 flex items-center justify-between\">\n                                        <div className=\"flex items-center gap-3\">\n                                            <img src={course.instructor.image} className=\"w-8 h-8 rounded-full border-2 border-white shadow-md shadow-slate-200\" alt=\"\" />\n                                            <span className=\"text-xs font-black text-slate-700\">{course.instructor.name}</span>\n                                        </div>\n                                        <div className=\"bg-slate-50 p-2 rounded-xl text-slate-400 group-hover:bg-blue-600 group-hover:text-white transition-all\">\n                                            <ArrowRight size={18} />\n                                        </div>\n                                    </div>\n                                </div>\n                            </Link>\n                        );\n                    })}\n                </div>\n\n                {filteredCourses.length === 0 && (\n                    <div className=\"text-center py-20 bg-white rounded-[3rem] border border-slate-100 shadow-sm\">\n                        <div className=\"bg-slate-50 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6 text-slate-300\">\n                            <Search size={40} />\n                        </div>\n                        <h3 className=\"text-xl font-black text-slate-800 mb-2\">コースが見つかりませんでした</h3>\n                        <p className=\"text-slate-500 font-bold\">検索ワードを変えて試してみてください。</p>\n                    </div>\n                )}\n\n                {/* Info Card */}\n                <section className=\"bg-slate-900 rounded-[3rem] p-10 md:p-16 relative overflow-hidden text-white shadow-2xl\">\n                    <div className=\"absolute right-[-5%] top-[-5%] text-white/5 rotate-12\">\n                        <Lightbulb size={300} />\n                    </div>\n                    <div className=\"relative z-10 max-w-2xl\">\n                        <h2 className=\"text-3xl md:text-4xl font-black mb-6 leading-tight tracking-tight\">\n                            学びを、<br /><span className=\"text-blue-400 italic\">スカウト</span>に繋げよう。\n                        </h2>\n                        <p className=\"text-slate-400 font-bold text-lg mb-8 leading-relaxed\">\n                            Reskill Universityでの学習履歴は、企業に共有されます。特定のコースを完了した求職者には、企業から特別なオファーが届くかもしれません。\n                        </p>\n                        <div className=\"flex flex-wrap gap-4\">\n                            <div className=\"bg-white/10 backdrop-blur-md border border-white/10 px-6 py-4 rounded-3xl\">\n                                <p className=\"text-[10px] font-black text-blue-400 uppercase tracking-widest mb-1\">Benefit 1</p>\n                                <p className=\"font-black\">スキルの可視化</p>\n                            </div>\n                            <div className=\"bg-white/10 backdrop-blur-md border border-white/10 px-6 py-4 rounded-3xl\">\n                                <p className=\"text-[10px] font-black text-blue-400 uppercase tracking-widest mb-1\">Benefit 2</p>\n                                <p className=\"font-black\">スカウト率の向上</p>\n                            </div>\n                        </div>\n                    </div>\n                </section>\n            </main>\n\n            {/* Navigation Buttons for switching back */}\n            <div className=\"fixed bottom-6 left-1/2 -translate-x-1/2 bg-white/80 backdrop-blur-xl px-2 py-2 rounded-2xl border border-slate-200 shadow-2xl z-50 flex gap-1\">\n                <Link href=\"/reskill\" className=\"flex items-center gap-2 px-6 py-3 rounded-xl text-slate-400 hover:text-slate-600 font-black text-sm transition-colors\">\n                    <LayoutIcon size={18} /> Dashboard\n                </Link>\n                <button className=\"flex items-center gap-2 px-6 py-3 rounded-xl bg-blue-600 text-white font-black text-sm shadow-lg shadow-blue-100\">\n                    <BookOpen size={18} /> Courses\n                </button>\n            </div>\n        </div>\n    );\n}\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/reskill/lesson/[id]/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Award' is defined but never used.","line":9,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Award"},"fix":{"range":[279,290],"text":""},"desc":"Remove unused variable \"Award\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'curriculum' is assigned a value but never used.","line":33,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":33,"endColumn":21},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":36,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1441,1444],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1441,1444],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":43,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":43,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1602,1605],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1602,1605],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":58,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":58,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2190,2193],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2190,2193],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":67,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":67,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2513,2516],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2513,2516],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`handleComplete` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/reskill/lesson/[id]/page.tsx:70:29\n  68 |                         // YT.PlayerState.ENDED is 0\n  69 |                         if (event.data === 0) {\n> 70 |                             handleComplete();\n     |                             ^^^^^^^^^^^^^^ `handleComplete` accessed before it is declared\n  71 |                         }\n  72 |                     }\n  73 |                 }\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/reskill/lesson/[id]/page.tsx:109:5\n  107 |     };\n  108 |\n> 109 |     const handleComplete = () => {\n      |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 110 |         completeLesson(lesson.id);\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 111 |         setShowCelebration(true);\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 112 |         toast.success('レッスンを完了しました！');\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 113 |         setTimeout(() => setShowCelebration(false), 3000);\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 114 |     };\n      | ^^^^^^^ `handleComplete` is declared here\n  115 |\n  116 |     const nextLesson = allLessons.find(l =>\n  117 |         l.curriculumId === lesson.curriculumId && l.order === lesson.order + 1","line":70,"column":29,"nodeType":null,"endLine":70,"endColumn":43},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":78,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":78,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2859,2862],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2859,2862],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":78,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":78,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2881,2884],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2881,2884],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: This value cannot be modified\n\nModifying a variable defined outside a component or hook is not allowed. Consider using an effect.\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/reskill/lesson/[id]/page.tsx:81:14\n  79 |             initPlayer();\n  80 |         } else {\n> 81 |             (window as any).onYouTubeIframeAPIReady = initPlayer;\n     |              ^^^^^^^^^^^^^ value cannot be modified\n  82 |         }\n  83 |\n  84 |         return () => {","line":81,"column":14,"nodeType":null,"endLine":81,"endColumn":27},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":81,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":81,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2965,2968],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2965,2968],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'handleComplete' and 'lesson'. Either include them or remove the dependency array.","line":89,"column":8,"nodeType":"ArrayExpression","endLine":89,"endColumn":20,"suggestions":[{"desc":"Update the dependencies array to be: [handleComplete, lesson, lesson.id]","fix":{"range":[3156,3168],"text":"[handleComplete, lesson, lesson.id]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'lesson'. Either include it or remove the dependency array.","line":95,"column":8,"nodeType":"ArrayExpression","endLine":95,"endColumn":44,"suggestions":[{"desc":"Update the dependencies array to be: [lesson, lesson.id, updateLastViewedLesson]","fix":{"range":[3311,3347],"text":"[lesson, lesson.id, updateLastViewedLesson]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'idx' is defined but never used.","line":101,"column":51,"nodeType":"Identifier","messageId":"unusedVar","endLine":101,"endColumn":54},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'l' is defined but never used.","line":118,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":118,"endColumn":27}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState, useEffect, use, useRef } from 'react';\nimport { useAppStore } from '@/lib/appStore';\nimport { COURSES } from '@/lib/learningData';\nimport {\n    ChevronLeft, FileText, Download, CheckSquare,\n    PlayCircle, CheckCircle2, ChevronRight, Menu,\n    Award, XCircle, Lightbulb\n} from 'lucide-react';\nimport Link from 'next/link';\nimport { toast } from 'sonner';\n\nexport default function LessonPlayerPage({ params }: { params: Promise<{ id: string }> }) {\n    const { id } = use(params);\n    const {\n        completeLesson,\n        updateLastViewedLesson,\n        isLessonCompleted,\n        isLessonSidebarOpen: isSidebarOpen,\n        setLessonSidebarOpen: setIsSidebarOpen\n    } = useAppStore();\n\n    const [isQuizOpen, setIsQuizOpen] = useState(false);\n    const [selectedAnswers, setSelectedAnswers] = useState<Record<string, number>>({});\n    const [quizSubmitted, setQuizSubmitted] = useState(false);\n    const [showCelebration, setShowCelebration] = useState(false);\n\n    // Find lesson and course\n    const allLessons = COURSES.flatMap(c => c.curriculums.flatMap(curr => curr.lessons));\n    const lesson = allLessons.find(l => l.id === id);\n    const course = COURSES.find(c => c.curriculums.some(curr => curr.id === lesson?.curriculumId));\n    const curriculum = course?.curriculums.find(curr => curr.id === lesson?.curriculumId);\n\n    // --- YouTube API Integration ---\n    const playerRef = useRef<any>(null);\n\n    useEffect(() => {\n        // Only proceed if we have a lesson\n        if (!lesson) return;\n\n        // Load YouTube API\n        if (!(window as any).YT) {\n            const tag = document.createElement('script');\n            tag.src = \"https://www.youtube.com/iframe_api\";\n            const firstScriptTag = document.getElementsByTagName('script')[0];\n            firstScriptTag.parentNode?.insertBefore(tag, firstScriptTag);\n        }\n\n        // Initialize Player helper\n        const initPlayer = () => {\n            if (playerRef.current) {\n                playerRef.current.destroy();\n            }\n\n            const videoId = lesson.youtubeUrl.split('/').pop()?.split('?')[0];\n\n            playerRef.current = new (window as any).YT.Player('youtube-player', {\n                height: '100%',\n                width: '100%',\n                videoId: videoId,\n                playerVars: {\n                    'rel': 0,\n                    'modestbranding': 1,\n                },\n                events: {\n                    'onStateChange': (event: any) => {\n                        // YT.PlayerState.ENDED is 0\n                        if (event.data === 0) {\n                            handleComplete();\n                        }\n                    }\n                }\n            });\n        };\n\n        // If API already loaded, init now, otherwise wait for callback\n        if ((window as any).YT && (window as any).YT.Player) {\n            initPlayer();\n        } else {\n            (window as any).onYouTubeIframeAPIReady = initPlayer;\n        }\n\n        return () => {\n            if (playerRef.current) {\n                playerRef.current.destroy();\n            }\n        };\n    }, [lesson?.id]); // Re-init when lesson changes\n\n    useEffect(() => {\n        if (lesson) {\n            updateLastViewedLesson(lesson.id);\n        }\n    }, [lesson?.id, updateLastViewedLesson]);\n\n    if (!lesson || !course) return <div>Lesson not found</div>;\n\n    const handleQuizSubmit = () => {\n        setQuizSubmitted(true);\n        const allCorrect = lesson.quiz?.every((q, idx) => selectedAnswers[q.id] === q.correctAnswerIndex);\n        if (allCorrect) {\n            toast.success('正解です！よく理解できました。');\n        } else {\n            toast.error('一部誤りがあります。解説を確認しましょう。');\n        }\n    };\n\n    const handleComplete = () => {\n        completeLesson(lesson.id);\n        setShowCelebration(true);\n        toast.success('レッスンを完了しました！');\n        setTimeout(() => setShowCelebration(false), 3000);\n    };\n\n    const nextLesson = allLessons.find(l =>\n        l.curriculumId === lesson.curriculumId && l.order === lesson.order + 1\n    ) || allLessons.find(l => {\n        const currIdx = course.curriculums.findIndex(c => c.id === lesson.curriculumId);\n        return course.curriculums[currIdx + 1]?.lessons[0];\n    });\n\n    return (\n        <div className=\"min-h-screen bg-slate-900 flex flex-col\">\n            {/* Top Navigation */}\n            <nav className=\"bg-slate-800/50 backdrop-blur-md border-b border-white/10 px-4 py-3 flex items-center justify-between text-white z-40\">\n                <div className=\"flex items-center gap-4\">\n                    <Link href=\"/reskill\" className=\"hover:bg-white/10 p-2 rounded-full transition-colors\">\n                        <ChevronLeft size={24} />\n                    </Link>\n                    <div>\n                        <span className=\"text-[10px] font-black uppercase text-blue-400 tracking-widest\">{course.title}</span>\n                        <h1 className=\"text-sm font-bold truncate max-w-[200px] md:max-w-md\">{lesson.title}</h1>\n                    </div>\n                </div>\n                <button\n                    onClick={() => setIsSidebarOpen(!isSidebarOpen)}\n                    className=\"p-2 hover:bg-white/10 rounded-lg text-slate-400\"\n                >\n                    <Menu size={20} />\n                </button>\n            </nav>\n\n            <div className=\"flex-1 flex overflow-hidden\">\n                {/* Main Content Area */}\n                <main className=\"flex-1 overflow-y-auto bg-slate-950\">\n                    <div className=\"bg-black aspect-video w-full shadow-2xl relative\">\n                        <div id=\"youtube-player\" className=\"w-full h-full\" />\n                    </div>\n\n                    <div className=\"max-w-4xl mx-auto p-6 md:p-10 space-y-10 pb-32\">\n                        {/* Lesson Info */}\n                        <div className=\"flex flex-col md:flex-row md:items-start justify-between gap-6\">\n                            <div className=\"flex-1\">\n                                <h2 className=\"text-3xl font-black text-white mb-4 tracking-tight\">{lesson.title}</h2>\n                                <p className=\"text-slate-400 font-medium leading-relaxed\">\n                                    {lesson.description}\n                                </p>\n                            </div>\n                            <div className=\"shrink-0 flex gap-3\">\n                                <button\n                                    onClick={handleComplete}\n                                    className={`relative px-8 py-4 rounded-2xl font-black transition-all flex items-center gap-2 overflow-hidden ${isLessonCompleted(lesson.id)\n                                        ? 'bg-emerald-500 text-white shadow-lg shadow-emerald-900/40'\n                                        : 'bg-blue-600 text-white hover:bg-blue-500 shadow-lg shadow-blue-900/40'\n                                        }`}\n                                >\n                                    {isLessonCompleted(lesson.id) ? <CheckCircle2 size={20} /> : null}\n                                    {isLessonCompleted(lesson.id) ? '完了済み' : '完了にする'}\n                                    {showCelebration && (\n                                        <div className=\"absolute inset-0 bg-white/20 animate-ping\" />\n                                    )}\n                                </button>\n                                {nextLesson && (\n                                    <Link\n                                        href={`/reskill/lesson/${nextLesson.id}`}\n                                        className=\"p-4 bg-slate-800 text-white rounded-2xl hover:bg-slate-700 transition-all border border-white/5\"\n                                    >\n                                        <ChevronRight size={24} />\n                                    </Link>\n                                )}\n                            </div>\n                        </div>\n\n                        {/* Interactive Tabs/Sections */}\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                            {/* Attachments */}\n                            {lesson.attachments && lesson.attachments.length > 0 && (\n                                <div className=\"bg-slate-900 rounded-[2rem] p-8 border border-white/5\">\n                                    <h3 className=\"text-lg font-black text-white flex items-center gap-2 mb-6\">\n                                        <FileText className=\"text-blue-500\" /> 学習資料\n                                    </h3>\n                                    <div className=\"space-y-3\">\n                                        {lesson.attachments.map((file, idx) => (\n                                            <a\n                                                key={idx}\n                                                href={file.url}\n                                                className=\"flex items-center justify-between p-4 bg-white/5 hover:bg-white/10 rounded-2xl transition-all border border-white/5 group\"\n                                            >\n                                                <div className=\"flex items-center gap-3\">\n                                                    <div className=\"bg-blue-500/20 p-2 rounded-lg text-blue-400 group-hover:scale-110 transition-transform\">\n                                                        <FileText size={18} />\n                                                    </div>\n                                                    <div>\n                                                        <p className=\"text-sm font-bold text-white leading-none\">{file.name}</p>\n                                                        <span className=\"text-[10px] text-slate-500 font-bold\">{file.size}</span>\n                                                    </div>\n                                                </div>\n                                                <Download size={18} className=\"text-slate-400\" />\n                                            </a>\n                                        ))}\n                                    </div>\n                                </div>\n                            )}\n\n                            {/* Quiz Entry */}\n                            {lesson.quiz && (\n                                <div\n                                    className={`bg-slate-900 rounded-[2rem] p-8 border ${isQuizOpen ? 'border-amber-500/30 ring-1 ring-amber-500/30' : 'border-white/5 hover:border-amber-500/20'} transition-all cursor-pointer`}\n                                    onClick={() => !isQuizOpen && setIsQuizOpen(true)}\n                                >\n                                    <h3 className=\"text-lg font-black text-white flex items-center gap-2 mb-2\">\n                                        <CheckSquare className=\"text-amber-500\" /> 理解度テスト\n                                    </h3>\n                                    <p className=\"text-sm text-slate-400 font-bold mb-6\">\n                                        このレッスンのポイントを復習しましょう（{lesson.quiz.length}門）\n                                    </p>\n                                    {!isQuizOpen && (\n                                        <button className=\"text-amber-500 font-black text-sm flex items-center gap-1 hover:translate-x-1 transition-transform\">\n                                            テストを開始する <ChevronRight size={16} />\n                                        </button>\n                                    )}\n                                </div>\n                            )}\n                        </div>\n\n                        {/* Quiz Detail Section (when open) */}\n                        {isQuizOpen && lesson.quiz && (\n                            <section className=\"bg-slate-900 rounded-[2.5rem] p-10 border border-amber-500/30 space-y-8 animate-in slide-in-from-bottom-5 duration-500\">\n                                <div className=\"flex items-center justify-between\">\n                                    <h3 className=\"text-2xl font-black text-white italic\">Practice Test</h3>\n                                    <button onClick={() => setIsQuizOpen(false)} className=\"text-slate-500 hover:text-white\">Close</button>\n                                </div>\n                                <div className=\"space-y-10\">\n                                    {lesson.quiz.map((q, qIdx) => (\n                                        <div key={q.id} className=\"space-y-4\">\n                                            <div className=\"flex items-center gap-3\">\n                                                <span className=\"w-8 h-8 rounded-full bg-slate-800 flex items-center justify-center text-xs font-black text-slate-400\">\n                                                    Q{qIdx + 1}\n                                                </span>\n                                                <p className=\"text-lg font-bold text-white leading-tight\">\n                                                    {q.question}\n                                                </p>\n                                            </div>\n                                            <div className=\"grid grid-cols-1 gap-3\">\n                                                {q.options.map((opt, optIdx) => {\n                                                    const isSelected = selectedAnswers[q.id] === optIdx;\n                                                    const isCorrect = optIdx === q.correctAnswerIndex;\n                                                    let statusClass = 'bg-white/5 border-white/10 text-white hover:bg-white/10';\n\n                                                    if (quizSubmitted) {\n                                                        if (isCorrect) {\n                                                            statusClass = 'bg-emerald-500/10 border-emerald-500 text-emerald-400 ring-1 ring-emerald-500/20';\n                                                        } else if (isSelected) {\n                                                            statusClass = 'bg-red-500/10 border-red-500 text-red-400';\n                                                        } else {\n                                                            statusClass = 'bg-white/2 border-white/5 text-slate-600 opacity-50';\n                                                        }\n                                                    } else if (isSelected) {\n                                                        statusClass = 'bg-blue-500/20 border-blue-500 text-blue-400';\n                                                    }\n\n                                                    return (\n                                                        <button\n                                                            key={optIdx}\n                                                            disabled={quizSubmitted}\n                                                            onClick={() => setSelectedAnswers({ ...selectedAnswers, [q.id]: optIdx })}\n                                                            className={`p-4 rounded-2xl text-left font-bold transition-all border flex items-center justify-between group ${statusClass}`}\n                                                        >\n                                                            <span>{opt}</span>\n                                                            {quizSubmitted && isCorrect && <CheckCircle2 size={18} className=\"text-emerald-500\" />}\n                                                            {quizSubmitted && isSelected && !isCorrect && <XCircle size={18} className=\"text-red-500\" />}\n                                                        </button>\n                                                    );\n                                                })}\n                                            </div>\n                                            {quizSubmitted && q.explanation && (\n                                                <div className=\"p-6 bg-blue-500/10 border border-blue-500/20 rounded-2xl text-xs font-medium text-blue-300 leading-relaxed italic animate-in zoom-in-95 duration-300\">\n                                                    <div className=\"flex items-center gap-2 mb-2\">\n                                                        <Lightbulb size={14} className=\"text-blue-400\" />\n                                                        <span className=\"font-black uppercase tracking-widest text-[10px]\">Explanation</span>\n                                                    </div>\n                                                    {q.explanation}\n                                                </div>\n                                            )}\n                                        </div>\n                                    ))}\n                                </div>\n                                {!quizSubmitted ? (\n                                    <button\n                                        onClick={handleQuizSubmit}\n                                        className=\"w-full py-4 bg-amber-500 text-black font-black rounded-2xl hover:bg-amber-400 transition-all shadow-xl shadow-amber-900/20\"\n                                    >\n                                        回答を送信する\n                                    </button>\n                                ) : (\n                                    <button\n                                        onClick={() => {\n                                            setQuizSubmitted(false);\n                                            setSelectedAnswers({});\n                                            setIsQuizOpen(false);\n                                        }}\n                                        className=\"w-full py-4 bg-slate-800 text-white font-black rounded-2xl hover:bg-slate-700 transition-all border border-white/5\"\n                                    >\n                                        回答をクリア\n                                    </button>\n                                )}\n                            </section>\n                        )}\n                    </div>\n                </main>\n\n                {/* Sidebar Navigation */}\n                {isSidebarOpen && (\n                    <aside className=\"hidden lg:flex w-80 bg-slate-900 border-l border-white/10 flex-col animate-in slide-in-from-right duration-300\">\n                        <div className=\"p-6 border-b border-white/10\">\n                            <h3 className=\"font-black text-white text-lg tracking-tight\">Curriculum Contents</h3>\n                        </div>\n                        <div className=\"flex-1 overflow-y-auto\">\n                            {course.curriculums.map((curr) => (\n                                <div key={curr.id}>\n                                    <div className=\"px-6 py-4 bg-white/5 border-b border-white/5\">\n                                        <span className=\"text-[10px] font-black tracking-widest text-slate-500 uppercase\">Step {curr.order}</span>\n                                        <h4 className=\"text-sm font-black text-slate-300\">{curr.title}</h4>\n                                    </div>\n                                    <div className=\"py-2\">\n                                        {curr.lessons.map((l) => (\n                                            <Link\n                                                key={l.id}\n                                                href={`/reskill/lesson/${l.id}`}\n                                                className={`flex items-center gap-3 px-6 py-3 hover:bg-white/5 transition-colors group ${l.id === id ? 'bg-blue-600/10 text-blue-400 border-l-4 border-blue-600' : 'text-slate-400'\n                                                    }`}\n                                            >\n                                                <div className=\"shrink-0\">\n                                                    {isLessonCompleted(l.id) ? (\n                                                        <CheckCircle2 size={18} className=\"text-emerald-500\" />\n                                                    ) : (\n                                                        <PlayCircle size={18} className={l.id === id ? 'text-blue-600' : 'group-hover:text-white'} />\n                                                    )}\n                                                </div>\n                                                <div className=\"min-w-0\">\n                                                    <p className={`text-xs font-bold leading-snug line-clamp-2 ${l.id === id ? 'text-blue-400' : 'group-hover:text-slate-200'}`}>\n                                                        {l.title}\n                                                    </p>\n                                                    <span className=\"text-[10px] opacity-50\">{l.duration}</span>\n                                                </div>\n                                            </Link>\n                                        ))}\n                                    </div>\n                                </div>\n                            ))}\n                        </div>\n                    </aside>\n                )}\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/reskill/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle2' is defined but never used.","line":6,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":29,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CheckCircle2"},"fix":{"range":[111,125],"text":""},"desc":"Remove unused variable \"CheckCircle2\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isLessonCompleted' is assigned a value but never used.","line":16,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":26},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":139,"column":116,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":139,"endColumn":119,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7910,7913],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7910,7913],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":142,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":142,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8070,8073],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8070,8073],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":143,"column":77,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":143,"endColumn":80,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8155,8158],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8155,8158],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":147,"column":45,"nodeType":"JSXOpeningElement","endLine":151,"endColumn":47},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":158,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":158,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9606,9609],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9606,9609],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":164,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":164,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10146,10149],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10146,10149],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":193,"column":37,"nodeType":"JSXOpeningElement","endLine":193,"endColumn":177},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":222,"column":45,"nodeType":"JSXOpeningElement","endLine":222,"endColumn":167}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React from 'react';\nimport { useAppStore } from '@/lib/appStore';\nimport {\n    PlayCircle, CheckCircle2, BookOpen, Clock,\n    TrendingUp, Award, ChevronRight, Layout,\n    Zap, Star, ArrowRight\n} from 'lucide-react';\nimport Link from 'next/link';\n\nexport default function ReskillDashboardPage() {\n    const {\n        completedLessonIds,\n        lastViewedLessonIds,\n        isLessonCompleted,\n        courses,\n        fetchCourses\n    } = useAppStore();\n\n    React.useEffect(() => {\n        if (courses.length === 0) {\n            fetchCourses();\n        }\n    }, [courses.length, fetchCourses]);\n\n    // Calculate overall progress\n    const allLessons = courses.flatMap(c => c.curriculums.flatMap(curr => curr.lessons));\n    const totalLessonsCount = allLessons.length;\n    const completedCount = completedLessonIds.length;\n    const overallProgress = totalLessonsCount > 0 ? Math.round((completedCount / totalLessonsCount) * 100) : 0;\n\n    // Get recently viewed lessons info\n    const recentlyViewedLessons = lastViewedLessonIds.map(id =>\n        allLessons.find(l => l.id === id)\n    ).filter(Boolean);\n\n    // Get the most recent course being studied\n    const lastLesson = recentlyViewedLessons[0];\n    const activeCourse = lastLesson ? courses.find(c => c.curriculums.some(curr => curr.id === lastLesson.curriculumId)) : courses[0];\n    const activeCourseLessons = activeCourse?.curriculums.flatMap(c => c.lessons) || [];\n    const activeCourseCompletedCount = activeCourseLessons.filter(l => completedLessonIds.includes(l.id)).length;\n    const activeCourseProgress = activeCourseLessons.length > 0 ? Math.round((activeCourseCompletedCount / activeCourseLessons.length) * 100) : 0;\n\n    return (\n        <div className=\"min-h-screen bg-slate-50 pb-20\">\n            {/* Header */}\n            <header className=\"bg-white border-b border-slate-200 sticky top-0 z-30\">\n                <div className=\"max-w-7xl mx-auto px-6 py-4 flex items-center justify-between\">\n                    <div className=\"flex items-center gap-3\">\n                        <div className=\"bg-blue-600 p-2 rounded-xl text-white shadow-lg shadow-blue-100\">\n                            <BookOpen size={24} />\n                        </div>\n                        <h1 className=\"text-xl font-black tracking-tighter\">Reskill University</h1>\n                    </div>\n                </div>\n            </header>\n\n            <main className=\"max-w-7xl mx-auto px-6 py-8 space-y-8\">\n                {/* Stats Overview */}\n                <section className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                    <div className=\"bg-white p-6 rounded-[2rem] border border-slate-200 shadow-sm relative overflow-hidden group\">\n                        <div className=\"absolute right-[-10%] top-[-10%] text-blue-50 opacity-50 group-hover:scale-110 transition-transform\">\n                            <Award size={140} />\n                        </div>\n                        <div className=\"relative z-10\">\n                            <span className=\"text-xs font-black text-slate-400 uppercase tracking-widest\">全体の進捗</span>\n                            <div className=\"flex items-end gap-2 mt-2\">\n                                <span className=\"text-5xl font-black text-slate-900\">{overallProgress}%</span>\n                                <span className=\"text-slate-400 font-bold mb-1\">達成</span>\n                            </div>\n                            <div className=\"mt-4 h-3 bg-slate-100 rounded-full overflow-hidden\">\n                                <div\n                                    className=\"h-full bg-blue-600 rounded-full transition-all duration-1000\"\n                                    style={{ width: `${overallProgress}%` }}\n                                />\n                            </div>\n                        </div>\n                    </div>\n\n                    <div className=\"bg-slate-900 p-6 rounded-[2rem] shadow-xl relative overflow-hidden group text-white\">\n                        <div className=\"absolute right-[-10%] top-[-10%] text-white/5 group-hover:scale-110 transition-transform\">\n                            <Zap size={140} />\n                        </div>\n                        <div className=\"relative z-10 h-full flex flex-col justify-between\">\n                            <div>\n                                <span className=\"text-xs font-black text-white/50 uppercase tracking-widest\">\n                                    {activeCourseProgress > 0 ? '学習を継続する' : '新しく始める'}\n                                </span>\n                                <h3 className=\"text-2xl font-black mt-2 leading-tight line-clamp-2\">\n                                    {activeCourse?.title || \"未経験から学ぶエンジニアの道\"}\n                                </h3>\n                                {activeCourseProgress > 0 && (\n                                    <div className=\"mt-4 flex items-center gap-3\">\n                                        <div className=\"flex-1 h-1.5 bg-white/20 rounded-full overflow-hidden\">\n                                            <div className=\"h-full bg-blue-400 rounded-full\" style={{ width: `${activeCourseProgress}%` }} />\n                                        </div>\n                                        <span className=\"text-[10px] font-black text-blue-400\">{activeCourseProgress}%</span>\n                                    </div>\n                                )}\n                            </div>\n                            <Link\n                                href={lastLesson ? `/reskill/lesson/${lastLesson.id}` : `/reskill/course/${activeCourse?.id}`}\n                                className=\"mt-6 bg-blue-500 hover:bg-blue-400 text-white font-black py-3 rounded-2xl flex items-center justify-center gap-2 transition-all active:scale-95 shadow-lg shadow-blue-500/20\"\n                            >\n                                {activeCourseProgress > 0 ? '学習を再開する' : 'コースを見る'} <PlayCircle size={20} />\n                            </Link>\n                        </div>\n                    </div>\n\n                    <div className=\"bg-white p-6 rounded-[2rem] border border-slate-200 shadow-sm flex flex-col justify-between\">\n                        <div>\n                            <span className=\"text-xs font-black text-slate-400 uppercase tracking-widest\">完了したステップ</span>\n                            <div className=\"flex items-center gap-4 mt-2\">\n                                <div className=\"text-5xl font-black text-slate-900\">{completedCount}</div>\n                                <div className=\"text-slate-400 font-bold leading-tight\">\n                                    lessons<br />completed\n                                </div>\n                            </div>\n                        </div>\n                        <div className=\"flex items-center gap-1.5 text-xs font-bold text-emerald-600 bg-emerald-50 self-start px-3 py-1.5 rounded-full\">\n                            <TrendingUp size={14} />\n                            先週比 +3\n                        </div>\n                    </div>\n                </section>\n\n                {/* Recently Viewed */}\n                {recentlyViewedLessons.length > 0 && (\n                    <section>\n                        <div className=\"flex items-center justify-between mb-4\">\n                            <h2 className=\"text-2xl font-black text-slate-800 tracking-tight flex items-center gap-2\">\n                                <Clock className=\"text-blue-500\" />\n                                続きから見る\n                            </h2>\n                        </div>\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                            {recentlyViewedLessons.map((lesson) => {\n                                const course = courses.find(c => c.curriculums.some(curr => curr.id === (lesson as any).curriculumId));\n                                return (\n                                    <Link\n                                        key={(lesson as any).id}\n                                        href={`/reskill/lesson/${(lesson as any).id}`}\n                                        className=\"group bg-white rounded-3xl border border-slate-200 overflow-hidden hover:shadow-xl hover:shadow-blue-900/5 transition-all\"\n                                    >\n                                        <div className=\"aspect-video bg-slate-100 relative overflow-hidden\">\n                                            <img\n                                                src={course?.image}\n                                                alt={course?.title}\n                                                className=\"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500\"\n                                            />\n                                            <div className=\"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity\">\n                                                <div className=\"w-12 h-12 bg-white rounded-full flex items-center justify-center text-blue-600 shadow-lg\">\n                                                    <PlayCircle size={32} />\n                                                </div>\n                                            </div>\n                                            <div className=\"absolute bottom-3 right-3 bg-black/60 backdrop-blur-md text-white text-[10px] font-black px-2 py-1 rounded\">\n                                                {(lesson as any).duration}\n                                            </div>\n                                        </div>\n                                        <div className=\"p-5\">\n                                            <span className=\"text-[10px] font-black text-blue-600 uppercase tracking-widest\">{course?.title}</span>\n                                            <h3 className=\"text-lg font-black text-slate-800 mt-1 line-clamp-1 group-hover:text-blue-600 transition-colors\">\n                                                {(lesson as any).title}\n                                            </h3>\n                                        </div>\n                                    </Link>\n                                );\n                            })}\n                        </div>\n                    </section>\n                )}\n\n                {/* Recommended Courses */}\n                <section>\n                    <div className=\"flex items-center justify-between mb-4\">\n                        <h2 className=\"text-2xl font-black text-slate-800 tracking-tight flex items-center gap-2\">\n                            <Star className=\"text-amber-500\" fill=\"currentColor\" />\n                            おすすめのコース\n                        </h2>\n                        <Link href=\"/reskill/courses\" className=\"text-blue-600 font-bold text-sm hover:underline flex items-center gap-1\">\n                            すべて見る <ChevronRight size={16} />\n                        </Link>\n                    </div>\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\n                        {courses.map((course) => (\n                            <Link\n                                key={course.id}\n                                href={`/reskill/course/${course.id}`}\n                                className=\"group flex flex-col md:flex-row bg-white rounded-[2.5rem] border border-slate-200 overflow-hidden hover:shadow-2xl transition-all h-full\"\n                            >\n                                <div className=\"md:w-2/5 aspect-[4/3] md:aspect-auto relative\">\n                                    <img src={course.image} className=\"w-full h-full object-cover group-hover:scale-105 transition-transform duration-700\" alt={course.title} />\n                                    <div className=\"absolute top-4 left-4\">\n                                        <span className=\"bg-white/90 backdrop-blur px-3 py-1.5 rounded-full text-[10px] font-black text-slate-800 shadow-sm border border-slate-100\">\n                                            {course.category}\n                                        </span>\n                                    </div>\n                                </div>\n                                <div className=\"flex-1 p-8 flex flex-col justify-between\">\n                                    <div>\n                                        <div className=\"flex items-center gap-2 mb-2\">\n                                            <span className={`text-[10px] font-black px-2 py-0.5 rounded-md ${course.level === '初級' ? 'bg-emerald-50 text-emerald-600 border border-emerald-100' :\n                                                'bg-blue-50 text-blue-600 border border-blue-100'\n                                                }`}>\n                                                {course.level}\n                                            </span>\n                                            <span className=\"text-[10px] font-bold text-slate-400 flex items-center gap-1\">\n                                                <Clock size={12} /> {course.duration}\n                                            </span>\n                                        </div>\n                                        <h3 className=\"text-2xl font-black text-slate-800 leading-tight mb-4 group-hover:text-blue-600 transition-colors\">\n                                            {course.title}\n                                        </h3>\n                                        <p className=\"text-sm text-slate-500 font-medium line-clamp-2 mb-6\">\n                                            {course.description}\n                                        </p>\n                                    </div>\n\n                                    <div className=\"flex items-center justify-between border-t border-slate-50 pt-4\">\n                                        <div className=\"flex items-center gap-3\">\n                                            <img src={course.instructor.image} className=\"w-10 h-10 rounded-full border-2 border-white shadow-md text-[0px]\" alt=\"\" />\n                                            <div>\n                                                <p className=\"text-xs font-black text-slate-800 leading-none\">{course.instructor.name}</p>\n                                                <p className=\"text-[10px] font-bold text-slate-400 mt-0.5\">{course.instructor.role}</p>\n                                            </div>\n                                        </div>\n                                        <div className=\"flex items-center gap-2\">\n                                            {(() => {\n                                                const lessons = course.curriculums.flatMap(c => c.lessons);\n                                                const completed = lessons.filter(l => completedLessonIds.includes(l.id)).length;\n                                                const progress = Math.round((completed / lessons.length) * 100);\n                                                if (progress > 0) {\n                                                    return (\n                                                        <div className=\"flex flex-col items-end mr-2\">\n                                                            <span className=\"text-[9px] font-black text-emerald-500 mb-1\">{progress}% Complete</span>\n                                                            <div className=\"w-16 h-1 bg-slate-100 rounded-full overflow-hidden\">\n                                                                <div className=\"h-full bg-emerald-500\" style={{ width: `${progress}%` }} />\n                                                            </div>\n                                                        </div>\n                                                    );\n                                                }\n                                                return null;\n                                            })()}\n                                            <div className=\"w-10 h-10 bg-slate-50 rounded-full flex items-center justify-center text-slate-400 group-hover:bg-blue-600 group-hover:text-white transition-all\">\n                                                <ArrowRight size={20} />\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </Link>\n                        ))}\n                    </div>\n                </section>\n            </main>\n\n            {/* Bottom Nav Hint (for mobile style feel) */}\n            <div className=\"fixed bottom-6 left-1/2 -translate-x-1/2 bg-white/80 backdrop-blur-xl px-2 py-2 rounded-2xl border border-slate-200 shadow-2xl z-50 flex gap-1\">\n                <button className=\"flex items-center gap-2 px-6 py-3 rounded-xl bg-blue-600 text-white font-black text-sm shadow-lg shadow-blue-100\">\n                    <Layout size={18} /> Dashboard\n                </button>\n                <Link href=\"/reskill/courses\" className=\"flex items-center gap-2 px-6 py-3 rounded-xl text-slate-400 hover:text-slate-600 font-black text-sm transition-colors\">\n                    <BookOpen size={18} /> Courses\n                </Link>\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/saved/page.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":126,"column":41,"nodeType":"JSXOpeningElement","endLine":130,"endColumn":43},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":176,"column":45,"nodeType":"JSXOpeningElement","endLine":180,"endColumn":47}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState } from 'react';\nimport Link from 'next/link';\nimport { useAppStore } from '@/lib/appStore';\nimport { JOBS, COMPANIES } from '@/lib/dummyData';\nimport { ChevronLeft, MapPin, Heart, ArrowRight, CheckCircle2, Building2, Briefcase, Zap } from 'lucide-react';\nimport { toast } from 'sonner';\nimport { motion, AnimatePresence } from 'framer-motion';\n\ntype Tab = 'quest' | 'job' | 'company';\n\nexport default function SavedJobsPage() {\n    const { interactions, toggleInteraction, currentUserId } = useAppStore();\n    const [activeTab, setActiveTab] = useState<Tab>('quest');\n\n    // Helper to check if item is liked\n    const isLiked = (type: 'like_job' | 'like_company', id: string) => {\n        return interactions.some(i => i.type === type && i.fromId === currentUserId && i.toId === id);\n    };\n\n    // Filter jobs based on interactions\n    const savedQuests = JOBS.filter(job =>\n        isLiked('like_job', job.id) && job.type === 'quest'\n    ).map(job => {\n        const company = COMPANIES.find(c => c.id === job.companyId);\n        return { ...job, company };\n    });\n\n    const savedJobs = JOBS.filter(job =>\n        isLiked('like_job', job.id) && job.type === 'job'\n    ).map(job => {\n        const company = COMPANIES.find(c => c.id === job.companyId);\n        return { ...job, company };\n    });\n\n    const savedCompanies = COMPANIES.filter(company =>\n        isLiked('like_company', company.id)\n    );\n\n    // Get applied jobs for status badge\n    const isApplied = (jobId: string) => {\n        return interactions.some(i => i.type === 'apply' && i.fromId === currentUserId && i.toId === jobId);\n    }\n\n    const handleToggleLikeJob = (jobId: string) => {\n        toggleInteraction('like_job', currentUserId, jobId);\n        toast.success('「気になる」を解除しました');\n    };\n\n    const handleToggleLikeCompany = (companyId: string) => {\n        toggleInteraction('like_company', currentUserId, companyId);\n        toast.success('「気になる」を解除しました');\n    };\n\n    const getCount = (tab: Tab) => {\n        switch (tab) {\n            case 'quest': return savedQuests.length;\n            case 'job': return savedJobs.length;\n            case 'company': return savedCompanies.length;\n        }\n    };\n\n    const isEmpty = getCount(activeTab) === 0;\n\n    return (\n        <div className=\"min-h-screen bg-zinc-50 pb-24\">\n            <nav className=\"sticky top-0 z-40 bg-white/80 backdrop-blur-md border-b border-zinc-100 flex items-center justify-between px-6 py-4 md:px-12\">\n                <Link href=\"/jobs\" className=\"p-2 hover:bg-zinc-100 rounded-full transition-colors text-zinc-600\">\n                    <ChevronLeft size={24} />\n                </Link>\n                <h1 className=\"text-sm font-black tracking-tight text-zinc-800 uppercase\">気になるリスト</h1>\n                <div className=\"w-10\" />\n            </nav>\n\n            <main className=\"max-w-xl mx-auto p-4 space-y-6\">\n                {/* Tabs */}\n                <div className=\"flex bg-zinc-200/50 p-1 rounded-2xl mx-2\">\n                    {(['quest', 'job', 'company'] as const).map((tab) => (\n                        <button\n                            key={tab}\n                            onClick={() => setActiveTab(tab)}\n                            className={`flex-1 flex items-center justify-center gap-2 py-2.5 rounded-xl text-xs font-black transition-all ${activeTab === tab ? 'bg-white text-zinc-800 shadow-sm' : 'text-zinc-400 hover:text-zinc-600'}`}\n                        >\n                            {tab === 'quest' && <Zap size={14} className={activeTab === tab ? 'text-eis-yellow' : ''} />}\n                            {tab === 'job' && <Briefcase size={14} className={activeTab === tab ? 'text-blue-500' : ''} />}\n                            {tab === 'company' && <Building2 size={14} className={activeTab === tab ? 'text-zinc-800' : ''} />}\n                            <span className=\"uppercase tracking-wider\">\n                                {tab === 'quest' ? 'クエスト' : tab === 'job' ? '求人' : '企業'}\n                            </span>\n                            <span className={`text-[10px] px-1.5 py-0.5 rounded-md ml-1 ${activeTab === tab ? 'bg-zinc-100 text-zinc-600' : 'text-zinc-400'}`}>\n                                {getCount(tab)}\n                            </span>\n                        </button>\n                    ))}\n                </div>\n\n                {isEmpty ? (\n                    <div className=\"flex flex-col items-center justify-center py-20 text-center space-y-4\">\n                        <div className=\"w-20 h-20 bg-zinc-100 rounded-full flex items-center justify-center text-zinc-300\">\n                            <Heart size={40} />\n                        </div>\n                        <p className=\"text-zinc-500 font-bold\">\n                            {activeTab === 'quest' ? '保存されたクエストはありません' :\n                                activeTab === 'job' ? '保存された求人はありません' :\n                                    '保存された企業はありません'}\n                        </p>\n                        <Link href={activeTab === 'company' ? '/companies' : '/jobs'} className=\"bg-zinc-900 text-white px-6 py-3 rounded-full font-bold text-sm hover:bg-zinc-800 transition-colors\">\n                            {activeTab === 'company' ? '企業を探す' : '探す'}\n                        </Link>\n                    </div>\n                ) : (\n                    <AnimatePresence mode=\"popLayout\">\n                        {activeTab === 'company' ? (\n                            // Render Companies\n                            savedCompanies.map(company => (\n                                <motion.div\n                                    key={company.id}\n                                    layout\n                                    initial={{ opacity: 0, scale: 0.9 }}\n                                    animate={{ opacity: 1, scale: 1 }}\n                                    exit={{ opacity: 0, scale: 0.9, transition: { duration: 0.2 } }}\n                                    className=\"group relative bg-white rounded-3xl p-5 shadow-sm border border-zinc-100 hover:shadow-lg transition-shadow\"\n                                >\n                                    <div className=\"flex items-center gap-4\">\n                                        <img\n                                            src={company.image} // dummyData uses 'image' but safeguard\n                                            alt={company.name}\n                                            className=\"w-16 h-16 rounded-2xl object-cover border border-zinc-100\"\n                                        />\n                                        <div className=\"flex-1 min-w-0\">\n                                            <p className=\"text-[10px] text-zinc-400 font-black tracking-wider uppercase mb-1\">{company.industry}</p>\n                                            <h3 className=\"text-base font-black text-zinc-800 truncate leading-tight group-hover:text-blue-600 transition-colors\">{company.name}</h3>\n                                            <p className=\"text-xs text-zinc-500 mt-1 truncate\">{company.location}</p>\n                                        </div>\n                                    </div>\n\n                                    <div className=\"flex items-center justify-end gap-2 mt-4 pt-4 border-t border-zinc-50\">\n                                        <button\n                                            onClick={(e) => {\n                                                e.preventDefault();\n                                                handleToggleLikeCompany(company.id);\n                                            }}\n                                            className=\"w-10 h-10 flex items-center justify-center text-red-500 bg-red-50 rounded-full hover:bg-red-100 transition-colors\"\n                                        >\n                                            <Heart size={18} fill=\"currentColor\" />\n                                        </button>\n                                        <Link href={`/companies/${company.id}`} className=\"w-10 h-10 flex items-center justify-center text-zinc-400 hover:text-blue-500 hover:bg-blue-50 rounded-full transition-all\">\n                                            <ArrowRight size={20} />\n                                        </Link>\n                                    </div>\n                                </motion.div>\n                            ))\n                        ) : (\n                            // Render Jobs or Quests\n                            (activeTab === 'quest' ? savedQuests : savedJobs).map(job => {\n                                return (\n                                    <motion.div\n                                        key={job.id}\n                                        layout\n                                        initial={{ opacity: 0, scale: 0.9 }}\n                                        animate={{ opacity: 1, scale: 1 }}\n                                        exit={{ opacity: 0, scale: 0.9, transition: { duration: 0.2 } }}\n                                        className=\"group relative bg-white rounded-3xl p-5 shadow-sm border border-zinc-100 hover:shadow-lg transition-shadow\"\n                                    >\n                                        {/* Status Badge if Applied */}\n                                        {isApplied(job.id) && (\n                                            <div className=\"absolute top-4 right-4 bg-zinc-100 text-zinc-500 text-[10px] font-bold px-2 py-1 rounded-full flex items-center gap-1 z-10\">\n                                                <CheckCircle2 size={12} />\n                                                申し込み済み\n                                            </div>\n                                        )}\n\n                                        {/* Company Info */}\n                                        <div className=\"flex items-center gap-3 mb-3\">\n                                            <img\n                                                src={job.company?.image}\n                                                alt={job.company?.name}\n                                                className=\"w-10 h-10 rounded-full object-cover border border-zinc-100\"\n                                            />\n                                            <div>\n                                                <p className=\"text-[10px] text-zinc-400 font-black tracking-wider uppercase\">{job.company?.industry}</p>\n                                                <p className=\"text-xs font-bold text-zinc-600\">{job.company?.name}</p>\n                                            </div>\n                                        </div>\n\n                                        {/* Job Title */}\n                                        <Link href={`/jobs/${job.id}`} className=\"block\">\n                                            <h3 className=\"text-lg font-black text-zinc-800 leading-tight mb-3 group-hover:text-blue-600 transition-colors\">\n                                                {job.title}\n                                            </h3>\n                                        </Link>\n\n                                        {/* Tag for Job/Quest Type */}\n                                        <div className=\"flex items-center gap-2 mb-4\">\n                                            <span className={`text-[10px] font-bold px-2 py-1 rounded-md ${job.category === '体験JOB' ? 'bg-yellow-100 text-yellow-700' :\n                                                job.category === 'インターンシップ' ? 'bg-green-100 text-green-700' :\n                                                    'bg-zinc-100 text-zinc-500'\n                                                }`}>\n                                                {job.category}\n                                            </span>\n                                        </div>\n\n                                        <div className=\"flex items-center justify-between mt-4\">\n                                            <div className=\"flex items-center gap-2 text-xs font-bold text-zinc-400\">\n                                                <MapPin size={14} />\n                                                {job.company?.location}\n                                            </div>\n                                            <div className=\"flex items-center gap-2\">\n                                                <button\n                                                    onClick={(e) => {\n                                                        e.preventDefault();\n                                                        handleToggleLikeJob(job.id);\n                                                    }}\n                                                    className=\"w-10 h-10 flex items-center justify-center text-red-500 bg-red-50 rounded-full hover:bg-red-100 transition-colors\"\n                                                >\n                                                    <Heart size={18} fill=\"currentColor\" />\n                                                </button>\n                                                <Link href={`/jobs/${job.id}`} className=\"w-10 h-10 flex items-center justify-center text-zinc-400 hover:text-blue-500 hover:bg-blue-50 rounded-full transition-all\">\n                                                    <ArrowRight size={20} />\n                                                </Link>\n                                            </div>\n                                        </div>\n                                    </motion.div>\n                                );\n                            })\n                        )}\n                    </AnimatePresence>\n                )}\n            </main>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/settings/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":11,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":14,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[243,246],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[243,246],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React from 'react';\nimport { useRouter } from 'next/navigation';\nimport { ArrowLeft, Bell, Lock, HelpCircle, LogOut, ChevronRight, User, Shield, Smartphone, Mail } from 'lucide-react';\n\ninterface SettingsItem {\n    icon: any;\n    label: string;\n    href: string;\n    toggle?: boolean;\n    badge?: string;\n}\n\ninterface SettingsSection {\n    title: string;\n    items: SettingsItem[];\n}\n\nexport default function SettingsPage() {\n    const router = useRouter();\n\n    const sections: SettingsSection[] = [\n        {\n            title: 'アカウント設定',\n            items: [\n                { icon: User, label: 'プロフィール編集', href: '/mypage/edit' },\n                { icon: Lock, label: 'パスワードとセキュリティ', href: '/settings/security' },\n                { icon: Mail, label: 'メールアドレス変更', href: '/settings/email' },\n            ]\n        },\n        {\n            title: '通知設定',\n            items: [\n                { icon: Bell, label: 'プッシュ通知', href: '#', toggle: true },\n                { icon: Smartphone, label: 'SMS通知', href: '#', toggle: false },\n            ]\n        },\n        {\n            title: 'サポート・その他',\n            items: [\n                { icon: HelpCircle, label: 'ヘルプ・よくある質問', href: '/help' },\n                { icon: Shield, label: 'プライバシーポリシー', href: '/privacy' },\n                { icon: LogOut, label: 'ログアウト', href: '/logout' },\n            ]\n        }\n    ];\n\n    return (\n        <div className=\"min-h-screen bg-slate-50 pb-24\">\n            {/* Header */}\n            <div className=\"bg-white px-6 py-4 flex items-center gap-4 sticky top-0 z-10 shadow-sm\">\n                <button onClick={() => router.back()} className=\"w-10 h-10 bg-slate-100 rounded-full flex items-center justify-center text-slate-600\">\n                    <ArrowLeft size={20} />\n                </button>\n                <span className=\"font-black text-slate-800 text-lg\">設定</span>\n            </div>\n\n            <div className=\"p-6 max-w-md mx-auto space-y-8\">\n                {sections.map((section) => (\n                    <div key={section.title} className=\"space-y-3\">\n                        <h2 className=\"text-xs font-bold text-slate-400 uppercase tracking-wider pl-2\">{section.title}</h2>\n                        <div className=\"bg-white rounded-2xl shadow-sm overflow-hidden\">\n                            {section.items.map((item, idx) => (\n                                <div\n                                    key={item.label}\n                                    className={`p-4 flex items-center justify-between cursor-pointer hover:bg-slate-50 transition-colors ${idx !== section.items.length - 1 ? 'border-b border-slate-50' : ''}`}\n                                >\n                                    <div className=\"flex items-center gap-3\">\n                                        <div className=\"w-8 h-8 bg-slate-100 rounded-full flex items-center justify-center text-slate-500\">\n                                            <item.icon size={16} />\n                                        </div>\n                                        <span className=\"font-bold text-slate-700 text-sm\">{item.label}</span>\n                                    </div>\n\n                                    {item.toggle ? (\n                                        <div className=\"w-11 h-6 bg-slate-200 rounded-full relative cursor-pointer\">\n                                            <div className=\"absolute left-1 top-1 w-4 h-4 bg-white rounded-full shadow-sm\" />\n                                        </div>\n                                    ) : (\n                                        <div className=\"flex items-center gap-2\">\n                                            {item.badge && (\n                                                <span className=\"text-[10px] bg-red-100 text-red-500 font-bold px-2 py-0.5 rounded-full\">\n                                                    {item.badge}\n                                                </span>\n                                            )}\n                                            <ChevronRight size={16} className=\"text-slate-300\" />\n                                        </div>\n                                    )}\n                                </div>\n                            ))}\n                        </div>\n                    </div>\n                ))}\n\n                <button className=\"w-full bg-white hover:bg-red-50 text-red-500 font-bold py-4 rounded-xl shadow-sm border border-transparent hover:border-red-100 transition-all flex items-center justify-center gap-2\">\n                    <LogOut size={20} />\n                    ログアウト\n                </button>\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/app/welcome/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":3,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":26,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useEffect"},"fix":{"range":[27,42],"text":""},"desc":"Remove unused variable \"useEffect\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'authStatus' is assigned a value but never used.","line":10,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'activeRole' is assigned a value but never used.","line":10,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":35}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { ArrowLeft, User, Building2, Sparkles, ArrowRight } from 'lucide-react';\nimport { useAppStore } from '@/lib/appStore';\n\nexport default function WelcomePage() {\n    const router = useRouter();\n    const { authStatus, activeRole } = useAppStore();\n\n    // If already authenticated, this page doesn't make sense, but we keep it simple for now.\n\n    return (\n        <div className=\"min-h-screen bg-slate-50 relative overflow-hidden\">\n            {/* Background Decoration */}\n            <div className=\"absolute top-0 left-0 w-full h-96 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-b-[60px] z-0\" />\n\n            <div className=\"relative z-10 max-w-4xl mx-auto px-6 pt-20 pb-20\">\n                <button\n                    onClick={() => router.push('/')}\n                    className=\"mb-8 flex items-center gap-2 text-white/80 hover:text-white font-bold transition-colors\"\n                >\n                    <ArrowLeft size={20} />\n                    トップページに戻る\n                </button>\n\n                {/* Hero */}\n                <div className=\"text-center text-white mb-16 space-y-6\">\n                    <div className=\"inline-flex items-center gap-2 bg-white/20 backdrop-blur-md px-4 py-1.5 rounded-full border border-white/30 text-white font-bold text-xs tracking-wider\">\n                        <Sparkles size={14} />\n                        BETA Ver. 0.9\n                    </div>\n                    <h1 className=\"text-5xl md:text-6xl font-black tracking-tight leading-tight\">\n                        LOGIN\n                    </h1>\n                    <p className=\"text-blue-100 text-lg md:text-xl font-bold max-w-2xl mx-auto leading-relaxed\">\n                        どのような立場でご利用になりますか？\n                    </p>\n                </div>\n\n                {/* Cards Container */}\n                <div className=\"grid md:grid-cols-2 gap-6 max-w-3xl mx-auto\">\n                    {/* Seeker Card */}\n                    <div className=\"bg-white rounded-[32px] p-8 shadow-xl shadow-blue-900/10 hover:shadow-2xl hover:scale-[1.02] transition-all border border-slate-100 group cursor-pointer\" onClick={() => router.push('/login/seeker')}>\n                        <div className=\"w-16 h-16 bg-blue-100 text-blue-600 rounded-2xl flex items-center justify-center mb-6 group-hover:rotate-6 transition-transform\">\n                            <User size={32} />\n                        </div>\n                        <h2 className=\"text-2xl font-black text-slate-800 mb-2\">求職者の方</h2>\n                        <p className=\"text-slate-500 font-medium mb-8 leading-relaxed\">\n                            自分の可能性を広げるクエストに出会い、<br />\n                            愛媛での新しい働き方を見つけましょう。\n                        </p>\n                        <div className=\"flex items-center gap-2 text-blue-600 font-black group-hover:gap-4 transition-all\">\n                            求職者ログイン\n                            <ArrowRight size={20} />\n                        </div>\n                    </div>\n\n                    {/* Company Card */}\n                    <div className=\"bg-white rounded-[32px] p-8 shadow-xl shadow-blue-900/10 hover:shadow-2xl hover:scale-[1.02] transition-all border border-slate-100 group cursor-pointer\" onClick={() => router.push('/login/company')}>\n                        <div className=\"w-16 h-16 bg-slate-900 text-white rounded-2xl flex items-center justify-center mb-6 group-hover:-rotate-6 transition-transform\">\n                            <Building2 size={32} />\n                        </div>\n                        <h2 className=\"text-2xl font-black text-slate-800 mb-2\">企業の方</h2>\n                        <p className=\"text-slate-500 font-medium mb-8 leading-relaxed\">\n                            会社の魅力を動画やクエストで発信し、<br />\n                            共感で繋がる仲間を集めましょう。\n                        </p>\n                        <div className=\"flex items-center gap-2 text-slate-900 font-black group-hover:gap-4 transition-all\">\n                            企業ログイン\n                            <ArrowRight size={20} />\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/LayoutWrapper.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Home' is defined but never used.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Home"},"fix":{"range":[128,133],"text":""},"desc":"Remove unused variable \"Home\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Search' is defined but never used.","line":6,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":33,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Search"},"fix":{"range":[143,151],"text":""},"desc":"Remove unused variable \"Search\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FileEdit' is defined but never used.","line":6,"column":63,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":71,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"FileEdit"},"fix":{"range":[179,189],"text":""},"desc":"Remove unused variable \"FileEdit\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'UserCircle' is defined but never used.","line":6,"column":73,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":83,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"UserCircle"},"fix":{"range":[189,201],"text":""},"desc":"Remove unused variable \"UserCircle\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":11,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":14,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[552,555],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[552,555],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'router' is assigned a value but never used.","line":29,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":17},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":110,"column":25,"nodeType":"JSXOpeningElement","endLine":110,"endColumn":138},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":140,"column":29,"nodeType":"JSXOpeningElement","endLine":144,"endColumn":31},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":160,"column":21,"nodeType":"JSXOpeningElement","endLine":160,"endColumn":91},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":179,"column":29,"nodeType":"JSXOpeningElement","endLine":179,"endColumn":99},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":209,"column":33,"nodeType":"JSXOpeningElement","endLine":213,"endColumn":35}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React from 'react';\nimport Link from 'next/link';\nimport { usePathname } from 'next/navigation';\nimport { Home, Building2, Search, Film, Heart, GraduationCap, FileEdit, UserCircle, LogOut, LogIn, Menu, MessageCircle, Map, Briefcase, TrendingUp, User, ShieldCheck } from 'lucide-react';\nimport { useAppStore } from '@/lib/appStore';\nimport MobileBottomNav from './MobileBottomNav';\nimport ScrollToTop from './ScrollToTop';\nimport DebugRoleSwitcher from './debug/DebugRoleSwitcher';\n\ninterface NavItem {\n    name: string;\n    icon: any;\n    href: string;\n    badge?: number;\n}\n\nexport default function LayoutWrapper({ children }: { children: React.ReactNode }) {\n    const pathname = usePathname();\n    const [isMenuOpen, setIsMenuOpen] = React.useState(false);\n    const { users, currentUserId, chats, authStatus, activeRole, logout } = useAppStore();\n\n    const isAdmin = activeRole === 'admin';\n\n    const currentUser = users.find(u => u.id === currentUserId);\n    const isAuthenticated = authStatus === 'authenticated';\n\n    const router = React.useMemo(() => {\n        // We can't use useRouter here easily if we want to trigger it from the sidebar without moving logic,\n        // but we can just use Link for most things.\n    }, []);\n\n    // Navigation items filtered by auth status\n    const allNavItems: NavItem[] = [\n        { name: 'クエスト情報', icon: Map, href: '/quests' },\n        { name: '動画で探す', icon: Film, href: '/reels' },\n        { name: '企業情報', icon: Building2, href: '/companies' },\n        { name: '求人情報', icon: Briefcase, href: '/jobs' },\n        { name: '気になるリスト', icon: Heart, href: '/saved' },\n        { name: 'メッセージ', icon: MessageCircle, href: '/messages', badge: undefined }, // Badge handled below\n        { name: 'e-ラーニング', icon: GraduationCap, href: '/reskill' },\n        { name: '進捗確認', icon: TrendingUp, href: '/progress' },\n        { name: 'マイページ', icon: User, href: '/mypage' },\n        { name: '管理者画面', icon: ShieldCheck, href: '/admin' },\n    ];\n\n    const authOnlyRoutes = ['/saved', '/messages', '/progress', '/mypage'];\n\n    const navItems = allNavItems.filter(item => {\n        if (!isAuthenticated && authOnlyRoutes.includes(item.href)) return false;\n        if (item.href === '/admin' && !isAdmin) return false;\n        return true;\n    });\n\n    // Update message badge\n    const messageItem = navItems.find(n => n.href === '/messages');\n    if (messageItem && isAuthenticated) {\n        const unreadCount = chats\n            .filter(c => c.userId === currentUserId || c.companyId === currentUserId)\n            .reduce((acc, chat) => acc + chat.messages.filter(m => m.senderId !== currentUserId && !m.isRead).length, 0);\n        if (unreadCount > 0) messageItem.badge = unreadCount;\n    }\n\n    // Check if we are in Company Dashboard\n    const isCompanyDashboard = pathname?.startsWith('/dashboard/company');\n    const isPublicPage = pathname === '/' || pathname === '/welcome' || pathname?.startsWith('/login');\n\n    const [mounted, setMounted] = React.useState(false);\n    React.useEffect(() => setMounted(true), []);\n\n    const handleLogout = () => {\n        logout();\n        window.location.href = '/'; // Simple hard redirect for logout\n    };\n\n    // メニュー項目（PC/モバイル共通）\n    const renderNavItems = (onClick?: () => void) => (\n        <nav className=\"flex-1 p-4 space-y-1 overflow-y-auto\">\n            {navItems.map((item) => (\n                <Link\n                    key={item.href}\n                    href={item.href}\n                    onClick={onClick}\n                    className={`relative flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-bold transition-colors ${pathname === item.href || (item.href !== '/' && pathname?.startsWith(item.href)) ? 'bg-zinc-100 text-eis-navy' : 'text-zinc-500 hover:bg-zinc-50'\n                        }`}\n                >\n                    <item.icon size={20} />\n                    {item.name}\n                    {mounted && item.badge && (\n                        <span className=\"absolute right-4 bg-red-500 text-white text-[10px] w-5 h-5 flex items-center justify-center rounded-full\">\n                            {item.badge}\n                        </span>\n                    )}\n                </Link>\n            ))}\n        </nav>\n    );\n\n    if (isCompanyDashboard || isPublicPage) {\n        return <>{children}</>;\n    }\n\n    return (\n        <div className=\"min-h-screen bg-zinc-50 flex flex-col md:flex-row\">\n            {/* PC Sidebar */}\n            <aside className=\"hidden md:flex w-64 bg-white border-r border-zinc-200 flex-col h-screen sticky top-0\">\n                <div className=\"p-8 border-b border-zinc-100\">\n                    <Link href=\"/\" className=\"w-full flex justify-center items-center group\">\n                        <img src=\"/eis_logo_mark.png\" alt=\"EIS Logo\" className=\"h-10 w-auto group-hover:opacity-80 transition-opacity\" />\n                        <span className=\"font-black text-eis-navy text-xl ml-2 tracking-tighter group-hover:text-blue-600 transition-colors\">Ehime Base</span>\n                    </Link>\n                </div>\n\n                {renderNavItems()}\n\n                <div className=\"px-4 pb-4\">\n                    {isAuthenticated ? (\n                        <button\n                            onClick={handleLogout}\n                            className=\"w-full flex items-center gap-3 px-4 py-3 text-sm font-bold text-white bg-eis-navy rounded-xl hover:bg-slate-800 transition-colors shadow-sm\"\n                        >\n                            <LogOut size={20} />\n                            ログアウト\n                        </button>\n                    ) : (\n                        <Link\n                            href=\"/welcome\"\n                            className=\"w-full flex items-center gap-3 px-4 py-3 text-sm font-bold text-white bg-blue-600 rounded-xl hover:bg-blue-700 transition-colors shadow-sm\"\n                        >\n                            <LogIn size={20} />\n                            ログイン\n                        </Link>\n                    )}\n                </div>\n\n                {isAuthenticated && currentUser && (\n                    <div className=\"p-4 border-t border-zinc-100 mt-auto bg-zinc-50/50\">\n                        <Link href=\"/mypage\" className=\"flex items-center gap-3 px-2 py-2 hover:bg-white rounded-xl transition-all group\">\n                            <img\n                                src={currentUser?.image || 'https://via.placeholder.com/40'}\n                                alt={currentUser?.name}\n                                className=\"w-10 h-10 rounded-full object-cover border border-zinc-200 shadow-sm\"\n                            />\n                            <div className=\"flex flex-col\">\n                                <span className=\"text-sm font-bold text-zinc-700 group-hover:text-blue-600\">{currentUser?.name}</span>\n                                <span className=\"text-[10px] text-zinc-400 font-bold\">{currentUser?.university || 'EIS User'}</span>\n                            </div>\n                        </Link>\n                    </div>\n                )}\n            </aside>\n\n            {/* Mobile Header */}\n            <header className=\"md:hidden h-16 bg-white border-b border-zinc-100 flex items-center justify-between px-6 sticky top-0 z-50\">\n                <button onClick={() => setIsMenuOpen(true)}>\n                    <Menu className=\"text-zinc-600\" />\n                </button>\n                <Link href=\"/\" className=\"flex items-center\">\n                    <img src=\"/eis_logo_mark.png\" alt=\"EIS Logo\" className=\"h-8 w-auto\" />\n                    <span className=\"font-black text-eis-navy text-lg ml-2 tracking-tighter\">Ehime Base</span>\n                </Link>\n                <div className=\"w-6\" /> {/* balance */}\n            </header>\n\n            {/* Mobile Side Menu Overlay */}\n            <div\n                className={`fixed inset-0 bg-black/50 z-[100] transition-opacity duration-300 md:hidden ${isMenuOpen ? 'opacity-100' : 'opacity-0 pointer-events-none'\n                    }`}\n                onClick={() => setIsMenuOpen(false)}\n            >\n                <div\n                    className={`absolute left-0 top-0 bottom-0 w-64 bg-white transition-transform duration-300 ease-out flex flex-col ${isMenuOpen ? 'translate-x-0' : '-translate-x-full'\n                        }`}\n                    onClick={(e) => e.stopPropagation()}\n                >\n                    <div className=\"p-6 border-b border-zinc-100 flex items-center justify-center\">\n                        <Link href=\"/\" className=\"flex items-center\" onClick={() => setIsMenuOpen(false)}>\n                            <img src=\"/eis_logo_mark.png\" alt=\"EIS Logo\" className=\"h-8 w-auto\" />\n                            <span className=\"font-black text-eis-navy text-lg ml-2 tracking-tighter\">Ehime Base</span>\n                        </Link>\n                    </div>\n                    {renderNavItems(() => setIsMenuOpen(false))}\n\n                    <div className=\"px-4 pb-4\">\n                        {isAuthenticated ? (\n                            <button\n                                onClick={() => { setIsMenuOpen(false); handleLogout(); }}\n                                className=\"w-full flex items-center gap-3 px-4 py-3 text-sm font-bold text-white bg-eis-navy rounded-xl\"\n                            >\n                                <LogOut size={20} />\n                                ログアウト\n                            </button>\n                        ) : (\n                            <Link\n                                href=\"/welcome\"\n                                onClick={() => setIsMenuOpen(false)}\n                                className=\"w-full flex items-center gap-3 px-4 py-3 text-sm font-bold text-white bg-blue-600 rounded-xl\"\n                            >\n                                <LogIn size={20} />\n                                ログイン\n                            </Link>\n                        )}\n                    </div>\n\n                    {isAuthenticated && currentUser && (\n                        <div className=\"p-4 border-t border-zinc-100 bg-zinc-50\">\n                            <Link href=\"/mypage\" className=\"flex items-center gap-3 px-2 py-2\" onClick={() => setIsMenuOpen(false)}>\n                                <img\n                                    src={currentUser?.image || 'https://via.placeholder.com/40'}\n                                    alt={currentUser?.name}\n                                    className=\"w-10 h-10 rounded-full object-cover border border-zinc-200\"\n                                />\n                                <div className=\"flex flex-col\">\n                                    <span className=\"text-sm font-bold text-zinc-700\">{currentUser?.name}</span>\n                                    <span className=\"text-[10px] text-zinc-400 font-bold\">{currentUser?.university || 'EIS User'}</span>\n                                </div>\n                            </Link>\n                        </div>\n                    )}\n                </div>\n            </div>\n\n            {/* Main Content */}\n            <main className=\"flex-1 pb-24 md:pb-0 min-h-screen\">\n                {children}\n            </main>\n\n            <ScrollToTop />\n            {/* Mobile Bottom Nav */}\n            <MobileBottomNav />\n            {isAdmin && <DebugRoleSwitcher />}\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/MobileBottomNav.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Home' is defined but never used.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Home"},"fix":{"range":[128,133],"text":""},"desc":"Remove unused variable \"Home\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Video' is defined but never used.","line":6,"column":49,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":54,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Video"},"fix":{"range":[165,172],"text":""},"desc":"Remove unused variable \"Video\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'interactions' is assigned a value but never used.","line":12,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React from 'react';\nimport Link from 'next/link';\nimport { usePathname } from 'next/navigation';\nimport { Home, Briefcase, MessageSquare, Heart, Video, Map, Building2, GraduationCap, TrendingUp, User } from 'lucide-react';\nimport { clsx } from \"clsx\";\nimport { useAppStore } from '@/lib/appStore';\n\nexport default function MobileBottomNav() {\n    const pathname = usePathname();\n    const { interactions, currentUserId } = useAppStore();\n\n    const navItems = [\n        { name: 'クエスト', href: '/quests', icon: Map },\n        { name: '求人', href: '/jobs', icon: Briefcase },\n        { name: '企業', href: '/companies', icon: Building2 },\n        { name: '気になる', href: '/saved', icon: Heart },\n        { name: 'メッセージ', href: '/messages', icon: MessageSquare },\n        { name: '学び', href: '/elearning', icon: GraduationCap },\n        { name: '進捗', href: '/progress', icon: TrendingUp },\n        { name: 'マイページ', href: '/mypage', icon: User },\n    ];\n\n    // Calculate unread messages (mock logic or from store)\n    const unreadCount = useAppStore(state =>\n        state.chats\n            .filter(c => c.userId === currentUserId)\n            .reduce((acc, chat) => acc + chat.messages.filter(m => m.senderId !== currentUserId && !m.isRead).length, 0)\n    );\n\n    if (pathname?.startsWith('/dashboard')) return null;\n\n    return (\n        <div className=\"md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-slate-200 py-2 pb-safe z-50\">\n            <div className=\"flex overflow-x-auto no-scrollbar px-2 gap-2\">\n                {navItems.map((item) => {\n                    const isActive = pathname === item.href || (item.href !== '/' && pathname?.startsWith(item.href));\n                    return (\n                        <Link\n                            key={item.name}\n                            href={item.href}\n                            className={clsx(\n                                \"flex flex-col items-center gap-1 p-2 min-w-[64px] relative transition-colors shrink-0 rounded-lg\",\n                                isActive ? \"text-blue-600 bg-blue-50\" : \"text-slate-400 hover:text-slate-600 hover:bg-slate-50\"\n                            )}\n                        >\n                            <div className=\"relative\">\n                                <item.icon size={22} strokeWidth={isActive ? 2.5 : 2} />\n                                {item.name === 'メッセージ' && unreadCount > 0 && (\n                                    <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-red-500 rounded-full text-[10px] text-white font-bold flex items-center justify-center border-2 border-white\">\n                                        {unreadCount}\n                                    </span>\n                                )}\n                            </div>\n                            <span className=\"text-[9px] font-bold whitespace-nowrap\">{item.name}</span>\n                        </Link>\n                    );\n                })}\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/RoleSwitcher.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'RefreshCcw' is defined but never used.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":20,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"RefreshCcw"},"fix":{"range":[161,203],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'pathname' is assigned a value but never used.","line":11,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":19},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/RoleSwitcher.tsx:15:21\n  13 |     // Prevent hydration mismatch by rendering only after mount\n  14 |     const [mounted, setMounted] = React.useState(false);\n> 15 |     useEffect(() => setMounted(true), []);\n     |                     ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  16 |\n  17 |     if (!mounted) return null;\n  18 |","line":15,"column":21,"nodeType":null,"endLine":15,"endColumn":31}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useEffect } from 'react';\nimport { useAppStore } from '@/lib/appStore';\nimport { useRouter, usePathname } from 'next/navigation';\nimport { RefreshCcw } from 'lucide-react';\n\nexport default function RoleSwitcher() {\n    const { activeRole, switchRole } = useAppStore();\n    const router = useRouter();\n    const pathname = usePathname();\n\n    // Prevent hydration mismatch by rendering only after mount\n    const [mounted, setMounted] = React.useState(false);\n    useEffect(() => setMounted(true), []);\n\n    if (!mounted) return null;\n\n    const handleSwitch = (newRole: 'seeker' | 'company') => {\n        if (activeRole === newRole) return;\n\n        switchRole(newRole);\n\n        if (newRole === 'company') {\n            router.push('/dashboard/company');\n        } else {\n            router.push('/');\n        }\n    };\n\n    return (\n        <div className=\"fixed bottom-4 right-4 z-[60] flex flex-col gap-2\">\n            <div className=\"bg-slate-900 text-white text-[10px] font-bold px-3 py-1 rounded-full shadow-lg border border-slate-700 self-start flex items-center gap-2\">\n                <span className=\"w-2 h-2 rounded-full bg-green-500 animate-pulse\" />\n                DEMO MODE\n            </div>\n            <div className=\"bg-white/90 backdrop-blur border border-slate-200 p-1.5 rounded-2xl shadow-xl flex gap-1\">\n                <button\n                    onClick={() => handleSwitch('seeker')}\n                    className={`px-4 py-2 rounded-xl text-xs font-black transition-all ${activeRole === 'seeker'\n                        ? 'bg-gradient-to-r from-blue-500 to-cyan-400 text-white shadow-md'\n                        : 'text-slate-500 hover:bg-slate-100'\n                        }`}\n                >\n                    求職者 (西村)\n                </button>\n                <button\n                    onClick={() => handleSwitch('company')}\n                    className={`px-4 py-2 rounded-xl text-xs font-black transition-all ${activeRole === 'company'\n                        ? 'bg-gradient-to-r from-slate-800 to-slate-900 text-white shadow-md'\n                        : 'text-slate-500 hover:bg-slate-100'\n                        }`}\n                >\n                    企業 (EIS)\n                </button>\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/ScrollToTop.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/analysis/FortuneAnalysis.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Moon' is defined but never used.","line":6,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":19,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Moon"},"fix":{"range":[145,151],"text":""},"desc":"Remove unused variable \"Moon\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Sun' is defined but never used.","line":6,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":24,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Sun"},"fix":{"range":[151,156],"text":""},"desc":"Remove unused variable \"Sun\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BookOpen' is defined but never used.","line":8,"column":49,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":57,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"BookOpen"},"fix":{"range":[245,255],"text":""},"desc":"Remove unused variable \"BookOpen\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Star' is defined but never used.","line":8,"column":59,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":63,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Star"},"fix":{"range":[255,261],"text":""},"desc":"Remove unused variable \"Star\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowUpRight' is defined but never used.","line":8,"column":65,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":77,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowUpRight"},"fix":{"range":[261,275],"text":""},"desc":"Remove unused variable \"ArrowUpRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'recommendations' is assigned a value but never used.","line":168,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":168,"endColumn":27}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport {\n    Calendar, Moon, Sun, Compass,\n    Sparkles, Info, ArrowRight,\n    MapPin, Briefcase, Heart, Zap, AlertCircle, BookOpen, Star, ArrowUpRight\n} from 'lucide-react';\nimport { useAppStore } from '@/lib/appStore';\nimport { getRecommendations, RecommendationResult } from '@/lib/recommendation';\nimport { JOBS, COMPANIES } from '@/lib/dummyData';\n\nimport { JIKKAN, calculateDayMasterIndex } from '@/lib/fortune';\n\ninterface FortuneResult {\n    dayMaster: string;\n    nature: string;\n    description: string;\n    workStyle: string;\n    luckyEnvironment: string;\n    careerLuck: string;\n    loveLuck: string;\n    moneyLuck: string;\n    suitableJobs: string[];\n    cautions: string;\n    traits: string[];\n}\n\nconst ANALYSIS_MAP: Record<string, FortuneResult> = {\n    '甲': {\n        dayMaster: '甲 (きのえ) - 大樹',\n        nature: '向上心あふれるリーダー',\n        description: '真っ直ぐに伸びる大樹のように、正義感が強く、向上心に溢れています。困難に直面しても屈しない強さと、弱者を守る優しさを持っています。',\n        workStyle: '組織の柱として責任ある立場、新規事業の立ち上げ、教育者',\n        luckyEnvironment: '成長が期待できる環境、良きライバルがいる職場',\n        careerLuck: '若いうちから頭角を現すタイプ。ただし、折れやすく、挫折した際の回復に時間がかかる傾向があります。',\n        loveLuck: '一本気で誠実。相手をリードすることを好みますが、頑固さが災いすることも。',\n        moneyLuck: '着実な収入に縁があります。浪費は少ないですが、見栄を張る出費には注意。',\n        suitableJobs: ['経営者', '政治家', '教育者', '建築家', '林業・造園'],\n        cautions: 'プライドが高く、一度心が折れると立ち直りに時間がかかります。時には周囲の意見に耳を傾け、柔軟に枝を曲げる勇気も必要です。',\n        traits: ['正直', '責任感', '信念']\n    },\n    '乙': {\n        dayMaster: '乙 (きのと) - 草花',\n        nature: '柔軟で粘り強い平和主義者',\n        description: '草花のように柔らかく、周囲との調和を大切にします。一見弱そうに見えても、踏ましても立ち上がる驚異的な粘り強さと環境適応能力を秘めています。',\n        workStyle: 'チームの潤滑油となる調整役、サポート業務、芸術職',\n        luckyEnvironment: '人間関係が良好な職場、美意識を活かせる環境',\n        careerLuck: '集団の中で力を発揮するタイプ。人脈を通じてチャンスが舞い込みやすいです。',\n        loveLuck: '献身的で包容力があります。相手に寄り添いすぎず、自分を保つのがコツ。',\n        moneyLuck: '細かな管理が得意。少しずつ財を蓄える堅実派です。',\n        suitableJobs: ['芸術家', 'デザイナー', '秘書', 'セラピスト', '園芸関連'],\n        cautions: '周囲に合わせすぎて自分を見失い、ストレスを溜め込みやすい傾向があります。自分の本音を言える場所を確保しましょう。',\n        traits: ['協調性', '忍耐力', '感受性']\n    },\n    '丙': {\n        dayMaster: '丙 (ひのえ) - 太陽',\n        nature: '明るく情熱的なムードメーカー',\n        description: '太陽のように明るく、周囲を照らす存在です。感情表現が豊かで、人々を惹きつけるカリスマ性を持っています。隠し事が苦手で、何事もオープンにする潔さがあります。',\n        workStyle: '広報、営業、エンターテインメント、政治・企画',\n        luckyEnvironment: '賑やかで自由な環境、評価が誰の目にも明確な職場',\n        careerLuck: '注目を浴びることで運気が上がります。カリスマ性を活かして大衆を先導する素質があります。',\n        loveLuck: '情熱的でストレート。冷めるのも早い傾向がありますが、交際中は全力で尽くします。',\n        moneyLuck: '入るのも大きいが出るのも大きいタイプ。投資運はありますが、ギャンブルは禁物。',\n        suitableJobs: ['芸能人', '営業プロフェッショナル', '広報・PR', '飲食店経営', '作家'],\n        cautions: '隠し事ができない正直さは長所ですが、時と場合によっては配慮が足りないと見られることも。言葉を選ぶ慎重さを。',\n        traits: ['陽気', '行動力', '裏表がない']\n    },\n    '丁': {\n        dayMaster: '丁 (ひのと) - 灯火',\n        nature: '知的で繊細な戦略家',\n        description: '暗闇を照らす灯火や焚き火のように、内面に情熱を秘め、分析力と洞察力に優れています。礼儀正しく、細かな配慮ができますが、感受性が強く繊細な一面も。',\n        workStyle: '研究、専門技術職、クリエイター、カウンセラー',\n        luckyEnvironment: '落ち着いて集中できる環境、知的な刺激がある職場',\n        careerLuck: '特定の分野を深く掘り下げることで成功します。夜型の生活や、独自のペースで動ける仕事に向きます。',\n        loveLuck: 'ロマンチストで独占欲は強め。一度信頼した相手には深い愛情を注ぎます。',\n        moneyLuck: '一攫千金よりも、技術や資格を活かした安定的な収入が期待できます。',\n        suitableJobs: ['プログラマー', '心理カウンセラー', '伝統工芸士', '脚本家', '占い師'],\n        cautions: '神経質になりやすく、些細なことで悩みすぎる面があります。時には火を休め、リラックスする時間を意識的に作りましょう。',\n        traits: ['洞察力', '礼儀', '秘密主義']\n    },\n    '戊': {\n        dayMaster: '戊 (つちのえ) - 山',\n        nature: '包容力のある安定したサポーター',\n        description: '雄大な山のようにどっしりと構え、周囲に安心感を与えます。忍耐強く、着実に物事を進める安定感があります。一度決めたことは曲げない頑固さも持ち合わせています。',\n        workStyle: '管理職、不動産、建設、インフラ、公務員',\n        luckyEnvironment: '伝統のある組織、長期的な視点を持つ職場、自然に近い場所',\n        careerLuck: '大器晩成型。信頼を積み重ねることで、晩年には大きな成功を収めます。',\n        loveLuck: '不器用ですが一途。結婚後は家庭をしっかりと守る良き伴侶になります。',\n        moneyLuck: '不動産や長期投資との相性が抜群。お金を溜め込む力があります。',\n        suitableJobs: ['不動産業', '建築・土木', '寺院・宗教職', '公務員', '農業'],\n        cautions: '変化への適応が苦手で、頑固になりがちです。新しい考え方や技術を否定せず、受け入れる柔軟性を持つとさらに飛躍します。',\n        traits: ['誠実', '寛大', '保守的']\n    },\n    '己': {\n        dayMaster: '己 (つちのと) - 大地',\n        nature: '多才で努力家な育成者',\n        description: '豊かな大地（田畑）のように、多種多様なものを受け入れ、育む力を持っています。多趣味で器用であり、多くのことを同時にこなせますが、内面は複雑で葛藤しやすい一面も。',\n        workStyle: '教育、人事、実務管理、技術職、料理・工芸',\n        luckyEnvironment: '変化のある環境、学びや成長が共有される職場',\n        careerLuck: '人の才能を見出し、育てることに長けています。縁の下の力持ちとして重宝されますが、実力も備わっています。',\n        loveLuck: '世話焼きで愛情深い。ただし、相手に干渉しすぎてしまう点には注意が必要です。',\n        moneyLuck: 'やりくり上手。貯蓄だけでなく、知識や人脈への投資で財を広げます。',\n        suitableJobs: ['教師', '保育士', '経理・財務', '陶芸家', '料理人'],\n        cautions: '人のために尽くしすぎて、自分自身の面倒を後回しにしがちです。たまには遠慮せずに自分の欲求を優先する日を作りましょう。',\n        traits: ['多才', '勤勉', '現実的']\n    },\n    '庚': {\n        dayMaster: '庚 (かのえ) - 鋼鉄',\n        nature: '決断力のある開拓者',\n        description: '鋭い刀剣や鋼鉄のように、意志が強く決断力に優れています。変化を恐れず、自らの道を切り開く強さがあります。正義感が強く、曲がったことが大嫌いな潔い性格です。',\n        workStyle: '警察、軍隊、外科医、プロジェクトリーダー、司法',\n        luckyEnvironment: '実力主義の仕事、スピード感のある職場、競争がある環境',\n        careerLuck: '厳しい環境に身を置くほど、能力が磨かれます。困難な状況を突破する役割に最適。',\n        loveLuck: '一目惚れしやすく情熱的。恋愛においても勝ち負けを意識してしまう癖があります。',\n        moneyLuck: '勝負運が強く、短期間で大きな富を得る可能性があります。大きな買い物にも臆しません。',\n        suitableJobs: ['警察官', '裁判官', '外科医', '金融トレーダー', 'スポーツ選手'],\n        cautions: '言葉が鋭くなりやすく、思わぬところで人を傷つけてしまうことがあります。正論であっても、伝え方には優しさを添えて。',\n        traits: ['果敢', '信念', '単刀直入']\n    },\n    '辛': {\n        dayMaster: '辛 (かのと) - 宝石',\n        nature: '美意識の高い完璧主義者',\n        description: '磨けば輝く宝石や貴金属のように、独自の美学を持ち、細部までこだわり抜く力があります。繊細で気高い精神を持っていますが、傷つきやすく、プライドを大切にします。',\n        workStyle: 'デザイン、宝石・宝飾、美容、品質管理、金融',\n        luckyEnvironment: '洗練された空間、質が求められる環境、個性が尊重される職場',\n        careerLuck: 'ブランド力や自分自身の価値を高める仕事で成功します。独自のネットワークを築く名手です。',\n        loveLuck: '理想が高く、こだわりが強い。自分を大切にしてくれる洗練されたパートナーを求めます。',\n        moneyLuck: '資産形成に優れたセンスを持ちます。良いものを見極める目があり、無駄遣いは少ないです。',\n        suitableJobs: ['ジュエリーデザイナー', '美容師', 'エステティシャン', '時計職人', '会計士'],\n        cautions: '完璧を求めすぎるあまり、自分にも他人にも厳しくなりすぎてしまいます。妥協することや「ほどほど」を知ることで心が楽になります。',\n        traits: ['繊細', '品位', '自尊心']\n    },\n    '壬': {\n        dayMaster: '壬 (みずのえ) - 大河',\n        nature: 'ダイナミックで知的な自由人',\n        description: '大河や海のように、スケールが大きく自由な発想を持っています。知恵が回り、どんな状況にも適応する柔軟さがありますが、一度怒ると手がつけられない激しさも秘めています。',\n        workStyle: '貿易、海外関連、マスコミ、企画戦略、運輸',\n        luckyEnvironment: '変化の激しい業界、制約の少ない環境、グローバルな職場',\n        careerLuck: '広い世界で活躍すべき人。止まることなく流れ続けることで、運気が好転します。',\n        loveLuck: '恋多き人。自由奔放で刺激を求めますが、根は思慮深く、深い愛も理解しています。',\n        moneyLuck: '経済の大きな流れを読むのが得意。流動資産を活用して財を増やします。',\n        suitableJobs: ['外交官', 'ジャーナリスト', '航海士', '企画ディレクター', 'イベントプロデューサー'],\n        cautions: '一つの場所に留まり続けると運気が淀みます。定期的な環境の変化や旅行などで心をリフレッシュすることを忘れずに。',\n        traits: ['聡明', '豪放', '適応力']\n    },\n    '癸': {\n        dayMaster: '癸 (みずのと) - 雨露',\n        nature: '思慮深く献身的な癒やし手',\n        description: '万物を潤す雨露のように、物静かで慈愛に満ちています。直感力に優れ、人々の心に寄り添うことが得意です。一見おとなしいですが、コツコツと物事を進める持続力があります。',\n        workStyle: '教育、哲学、介護、福祉、カウンセリング、クリエイティブ',\n        luckyEnvironment: '温かい人間関係の環境、感性を活かせる職場、水に関わる場所',\n        careerLuck: '着実な積み重ねで信頼を築きます。参謀役として、トップを支える役割で本領を発揮します。',\n        loveLuck: '純粋で尽くすタイプ。相手との精神的な繋がりを何よりも重視します。',\n        moneyLuck: '派手さはありませんが、地道な節約と管理で、将来の蓄えを確実に築きます。',\n        suitableJobs: ['心理学者', '社会福祉士', '図書館司書', '書道家', '研究員'],\n        cautions: '空気を読みすぎて自己犠牲に走りがちです。自分の意見を飲み込まず、適切な形でアウトプットする習慣をつけましょう。',\n        traits: ['純粋', '直感', '謙虚']\n    }\n};\n\nexport default function FortuneAnalysis() {\n    const { setAnalysisResults, courses, fetchCourses } = useAppStore();\n    const [step, setStep] = useState(0); // 0: Input, 1: Result\n    const [birthDate, setBirthDate] = useState('');\n    const [result, setResult] = useState<FortuneResult | null>(null);\n    const [recommendations, setRecommendations] = useState<RecommendationResult | null>(null);\n\n    useEffect(() => {\n        if (courses.length === 0) {\n            fetchCourses();\n        }\n    }, [courses.length, fetchCourses]);\n\n    const calculateFortune = () => {\n        if (!birthDate) return;\n\n        const index = calculateDayMasterIndex(birthDate);\n        const stem = JIKKAN[index];\n        const res = ANALYSIS_MAP[stem];\n        setResult(res);\n\n        // Analysis結果を保存\n        setAnalysisResults({\n            fortune: {\n                dayMaster: res.dayMaster,\n                traits: res.traits\n            }\n        });\n\n        // ユーザープロフィールにも生年月日を保存\n        const currentUserId = useAppStore.getState().currentUserId;\n        if (currentUserId) {\n            useAppStore.getState().updateUser(currentUserId, { birthDate });\n        }\n\n        // Get recommendations\n        const recs = getRecommendations(\n            {\n                fortune: {\n                    dayMaster: res.dayMaster,\n                    traits: res.traits\n                }\n            },\n            JOBS,\n            courses,\n            COMPANIES\n        );\n        setRecommendations(recs);\n\n        setStep(1);\n    };\n\n    return (\n        <div className=\"bg-white rounded-[3rem] p-8 md:p-12 border border-slate-200 shadow-xl overflow-hidden relative\">\n            <div className=\"absolute right-[-5%] top-[-5%] text-purple-50\">\n                <Compass size={300} aria-hidden=\"true\" />\n            </div>\n\n            <AnimatePresence mode=\"wait\">\n                {step === 0 ? (\n                    <motion.div\n                        key=\"input\"\n                        initial={{ opacity: 0, y: 20 }}\n                        animate={{ opacity: 1, y: 0 }}\n                        exit={{ opacity: 0, y: -20 }}\n                        className=\"relative z-10 text-center space-y-8\"\n                    >\n                        <div className=\"w-16 h-16 bg-purple-100 text-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-6\">\n                            <Calendar size={32} />\n                        </div>\n                        <div>\n                            <h2 className=\"text-3xl font-black text-slate-900 tracking-tight mb-4\">資質診断 (四柱推命)</h2>\n                            <p className=\"text-slate-600 font-bold max-w-md mx-auto\">\n                                生年月日に刻まれた資質を読み解き、あなたの本来の性格や向いている環境を分析します。\n                            </p>\n                        </div>\n\n                        <div className=\"max-w-xs mx-auto space-y-4\">\n                            <div className=\"text-left\">\n                                <label className=\"text-[10px] font-black text-slate-600 uppercase tracking-widest ml-4 mb-2 block\">\n                                    生年月日を入力\n                                </label>\n                                <input\n                                    type=\"date\"\n                                    value={birthDate}\n                                    onChange={(e) => setBirthDate(e.target.value)}\n                                    className=\"w-full px-6 py-4 bg-white border-2 border-slate-200 rounded-2xl font-bold text-slate-900 focus:border-purple-500 transition-all outline-none\"\n                                />\n                            </div>\n                            <button\n                                onClick={calculateFortune}\n                                disabled={!birthDate}\n                                className=\"w-full bg-purple-600 text-white font-black py-4 rounded-2xl hover:bg-purple-500 transition-all active:scale-95 shadow-xl shadow-purple-500/20 disabled:opacity-50 disabled:grayscale flex items-center justify-center gap-2\"\n                            >\n                                分析を実行する <Sparkles size={18} />\n                            </button>\n                        </div>\n                    </motion.div>\n                ) : result && (\n                    <motion.div\n                        key=\"result\"\n                        initial={{ opacity: 0, scale: 0.95 }}\n                        animate={{ opacity: 1, scale: 1 }}\n                        className=\"relative z-10\"\n                    >\n                        <div className=\"flex flex-col md:flex-row gap-10 items-start\">\n                            <div className=\"md:w-1/3 text-center space-y-6\">\n                                <div className=\"w-32 h-32 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-[2.5rem] flex items-center justify-center mx-auto shadow-2xl shadow-purple-500/30\">\n                                    <span className=\"text-4xl text-white font-black\">{result.dayMaster.charAt(0)}</span>\n                                </div>\n                                <div>\n                                    <h3 className=\"text-2xl font-black text-slate-900\">{result.dayMaster}</h3>\n                                    <p className=\"text-purple-600 font-black mt-1\">{result.nature}</p>\n                                </div>\n                                <div className=\"flex flex-wrap justify-center gap-2\">\n                                    {result.traits.map(trait => (\n                                        <span key={trait} className=\"bg-slate-800 text-white px-3 py-1.5 rounded-full text-[10px] font-black border border-slate-700 shadow-sm\">\n                                            #{trait}\n                                        </span>\n                                    ))}\n                                </div>\n                            </div>\n\n                            <div className=\"flex-1 space-y-8\">\n                                <div className=\"bg-slate-100/80 p-8 rounded-[2rem] border border-slate-200\">\n                                    <h4 className=\"flex items-center gap-2 text-slate-900 font-black mb-4 text-lg\">\n                                        <Info size={20} className=\"text-purple-600\" /> 本質的な性格\n                                    </h4>\n                                    <p className=\"text-slate-800 font-bold leading-relaxed text-lg\">{result.description}</p>\n                                </div>\n\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                                    <div className=\"p-6 bg-blue-50/50 border border-blue-100 rounded-3xl shadow-sm\">\n                                        <h5 className=\"flex items-center gap-2 text-xs font-black text-blue-700 mb-3\">\n                                            <Briefcase size={14} /> 向いている仕事スタイル\n                                        </h5>\n                                        <p className=\"text-base font-black text-slate-900 leading-relaxed\">{result.workStyle}</p>\n                                    </div>\n                                    <div className=\"p-6 bg-emerald-50/50 border border-emerald-100 rounded-3xl shadow-sm\">\n                                        <h5 className=\"flex items-center gap-2 text-xs font-black text-emerald-700 mb-3\">\n                                            <MapPin size={14} /> 運気が上がる環境\n                                        </h5>\n                                        <p className=\"text-base font-black text-slate-900 leading-relaxed\">{result.luckyEnvironment}</p>\n                                    </div>\n                                </div>\n\n                                <div className=\"space-y-4\">\n                                    <div className=\"p-6 bg-slate-100/50 border border-slate-200 rounded-3xl\">\n                                        <h5 className=\"flex items-center gap-2 text-xs font-black text-slate-500 mb-3\">\n                                            <Briefcase size={14} /> 特に向いている職業例\n                                        </h5>\n                                        <div className=\"flex flex-wrap gap-2\">\n                                            {result.suitableJobs.map((job, i) => (\n                                                <span key={i} className=\"px-4 py-1.5 bg-white border-2 border-slate-200 rounded-full text-xs font-black text-slate-800 shadow-sm\">\n                                                    {job}\n                                                </span>\n                                            ))}\n                                        </div>\n                                    </div>\n\n                                    <div className=\"p-6 bg-red-100/50 border border-red-200 rounded-3xl\">\n                                        <h5 className=\"flex items-center gap-2 text-sm font-black text-red-700 mb-3\">\n                                            <AlertCircle size={16} /> 気をつけたほうがいいところ\n                                        </h5>\n                                        <p className=\"text-base font-bold text-slate-800 leading-relaxed\">{result.cautions}</p>\n                                    </div>\n\n                                    <div className=\"p-6 bg-blue-100/50 border border-blue-200 rounded-3xl\">\n                                        <h5 className=\"flex items-center gap-2 text-sm font-black text-blue-700 mb-3\">\n                                            <Zap size={16} /> 仕事・成功の運勢\n                                        </h5>\n                                        <p className=\"text-base font-bold text-slate-800 leading-relaxed\">{result.careerLuck}</p>\n                                    </div>\n                                    <div className=\"p-6 bg-pink-100/50 border border-pink-200 rounded-3xl\">\n                                        <h5 className=\"flex items-center gap-2 text-sm font-black text-pink-700 mb-3\">\n                                            <Heart size={16} /> 対人・恋愛の運勢\n                                        </h5>\n                                        <p className=\"text-base font-bold text-slate-800 leading-relaxed\">{result.loveLuck}</p>\n                                    </div>\n                                    <div className=\"p-6 bg-amber-100/50 border border-amber-200 rounded-3xl\">\n                                        <h5 className=\"flex items-center gap-2 text-sm font-black text-amber-700 mb-3\">\n                                            <ArrowRight size={16} /> 金運・財産\n                                        </h5>\n                                        <p className=\"text-base font-bold text-slate-800 leading-relaxed\">{result.moneyLuck}</p>\n                                    </div>\n                                </div>\n\n                                <button\n                                    onClick={() => setStep(0)}\n                                    className=\"text-slate-400 font-bold hover:text-slate-900 transition-colors flex items-center gap-2\"\n                                >\n                                    別の生年月日で試す <ArrowRight size={16} />\n                                </button>\n                            </div>\n                        </div>\n                    </motion.div>\n                )}\n            </AnimatePresence>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/analysis/StrengthsDiscovery.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BarChart3' is defined but never used.","line":7,"column":36,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":45,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"BarChart3"},"fix":{"range":[190,201],"text":""},"desc":"Remove unused variable \"BarChart3\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport {\n    Zap, Target, Users, Lightbulb,\n    ArrowRight, ArrowLeft, Trophy, BarChart3,\n    CheckCircle2, Sparkles\n} from 'lucide-react';\nimport { toast } from 'sonner';\nimport { useAppStore } from '@/lib/appStore';\n\ninterface Question {\n    id: number;\n    text: string;\n    category: 'executing' | 'influencing' | 'relationship' | 'strategic';\n}\n\nconst QUESTIONS: Question[] = [\n    { id: 1, text: \"計画を立てるよりも、まずは行動に移すことが得意だ\", category: 'executing' },\n    { id: 2, text: \"他人の感情や考えていることに敏感に気づく方だ\", category: 'relationship' },\n    { id: 3, text: \"周囲の人を説得して、自分の考えに賛同してもらうのが好きだ\", category: 'influencing' },\n    { id: 4, text: \"複雑な問題の背後にあるパターンや法則を見つけるのが得意だ\", category: 'strategic' },\n    { id: 5, text: \"一度決めたことは、最後までやり遂げないと気が済まない\", category: 'executing' },\n    { id: 6, text: \"初対面の人ともすぐに打ち解け、信頼関係を築ける\", category: 'relationship' },\n    { id: 7, text: \"チームを導き、目標達成に向けて鼓舞することにやりがいを感じる\", category: 'influencing' },\n    { id: 8, text: \"将来起こりうるリスクや可能性を常に先読みして動いている\", category: 'strategic' },\n    { id: 9, text: \"効率的な方法を常に探し、無駄を省くことに喜びを感じる\", category: 'executing' },\n    { id: 10, text: \"困っている人がいると、自分のことのように寄り添いサポートしたいと思う\", category: 'relationship' },\n    { id: 11, text: \"プレゼンテーションやスピーチで、自分の意見を伝えることが得意だ\", category: 'influencing' },\n    { id: 12, text: \"新しいアイデアやコンセプトを考えることが、何よりも楽しい\", category: 'strategic' },\n];\n\nconst CATEGORY_NAMES = {\n    executing: { label: '実行力', icon: Zap, color: 'text-emerald-500', bg: 'bg-emerald-50' },\n    influencing: { label: '影響力', icon: Target, color: 'text-blue-500', bg: 'bg-blue-50' },\n    relationship: { label: '人間関係構築力', icon: Users, color: 'text-rose-500', bg: 'bg-rose-50' },\n    strategic: { label: '戦略的思考', icon: Lightbulb, color: 'text-amber-500', bg: 'bg-amber-50' },\n};\n\nexport default function StrengthsDiscovery() {\n    const { setAnalysisResults } = useAppStore();\n    const [currentStep, setCurrentStep] = useState(0); // 0: Start, 1: Quiz, 2: Result\n    const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);\n    const [answers, setAnswers] = useState<Record<number, number>>({});\n    const [results, setResults] = useState<Record<string, number> | null>(null);\n\n    const handleAnswer = (score: number) => {\n        const newAnswers = { ...answers, [QUESTIONS[currentQuestionIndex].id]: score };\n        setAnswers(newAnswers);\n\n        if (currentQuestionIndex < QUESTIONS.length - 1) {\n            setCurrentQuestionIndex(currentQuestionIndex + 1);\n        } else {\n            calculateResults(newAnswers);\n            setCurrentStep(2);\n        }\n    };\n\n    const calculateResults = (finalAnswers: Record<number, number>) => {\n        const scores: Record<string, number> = {\n            executing: 0,\n            influencing: 0,\n            relationship: 0,\n            strategic: 0\n        };\n\n        const counts: Record<string, number> = {\n            executing: 0,\n            influencing: 0,\n            relationship: 0,\n            strategic: 0\n        };\n\n        QUESTIONS.forEach(q => {\n            if (finalAnswers[q.id]) {\n                scores[q.category] += finalAnswers[q.id];\n                counts[q.category] += 5; // Max score per question is 5\n            }\n        });\n\n        const normalizedScores: Record<string, number> = {};\n        Object.keys(scores).forEach(cat => {\n            normalizedScores[cat] = Math.round((scores[cat] / counts[cat]) * 100);\n        });\n\n        setResults(normalizedScores);\n    };\n\n    if (currentStep === 0) {\n        return (\n            <div className=\"bg-white rounded-[3rem] p-10 md:p-16 border border-slate-200 shadow-xl text-center\">\n                <div className=\"w-20 h-20 bg-blue-100 text-blue-600 rounded-3xl flex items-center justify-center mx-auto mb-8 animate-bounce-slow\">\n                    <Sparkles size={40} />\n                </div>\n                <h2 className=\"text-3xl md:text-4xl font-black text-slate-900 mb-6 tracking-tight\">\n                    あなたの「隠れた強み」を<br />今すぐ発見しましょう\n                </h2>\n                <p className=\"text-slate-500 font-bold text-lg mb-10 max-w-xl mx-auto leading-relaxed\">\n                    12問の質問に答えるだけで、あなたの強み（実行力・影響力・人間関係・戦略性）を可視化します。自分自身の魅力を再発見しましょう。\n                </p>\n                <button\n                    onClick={() => setCurrentStep(1)}\n                    className=\"group bg-slate-900 text-white font-black px-10 py-5 rounded-[2rem] flex items-center justify-center gap-3 mx-auto hover:bg-slate-800 transition-all active:scale-95 shadow-2xl shadow-slate-900/20\"\n                >\n                    診断を開始する <ArrowRight className=\"group-hover:translate-x-1 transition-transform\" />\n                </button>\n            </div>\n        );\n    }\n\n    if (currentStep === 1) {\n        const question = QUESTIONS[currentQuestionIndex];\n        const progress = ((currentQuestionIndex + 1) / QUESTIONS.length) * 100;\n\n        return (\n            <div className=\"bg-white rounded-[3rem] p-8 md:p-16 border border-slate-200 shadow-xl min-h-[500px] flex flex-col justify-between\">\n                <div>\n                    <div className=\"flex items-center justify-between mb-8\">\n                        <span className=\"text-sm font-black text-slate-400 uppercase tracking-widest\">Question {currentQuestionIndex + 1} / {QUESTIONS.length}</span>\n                        <div className=\"flex-1 h-2 bg-slate-100 rounded-full mx-6 overflow-hidden\">\n                            <motion.div\n                                className=\"h-full bg-blue-600\"\n                                initial={{ width: 0 }}\n                                animate={{ width: `${progress}%` }}\n                            />\n                        </div>\n                    </div>\n\n                    <AnimatePresence mode=\"wait\">\n                        <motion.div\n                            key={currentQuestionIndex}\n                            initial={{ x: 20, opacity: 0 }}\n                            animate={{ x: 0, opacity: 1 }}\n                            exit={{ x: -20, opacity: 0 }}\n                            className=\"space-y-10\"\n                        >\n                            <h3 className=\"text-2xl md:text-3xl font-black text-slate-900 leading-tight\">\n                                {question.text}\n                            </h3>\n\n                            <div className=\"grid grid-cols-1 md:grid-cols-5 gap-3\">\n                                {[1, 2, 3, 4, 5].map((score) => (\n                                    <button\n                                        key={score}\n                                        onClick={() => handleAnswer(score)}\n                                        className=\"py-6 rounded-3xl border-2 border-slate-100 hover:border-blue-600 hover:bg-blue-50 transition-all font-black text-slate-500 hover:text-blue-600 group\"\n                                    >\n                                        <div className=\"text-xs uppercase tracking-widest mb-1 opacity-50 group-hover:opacity-100\">\n                                            {score === 1 ? '全く違う' : score === 5 ? 'まさにその通り' : ''}\n                                        </div>\n                                        <div className=\"text-2xl\">{score}</div>\n                                    </button>\n                                ))}\n                            </div>\n                        </motion.div>\n                    </AnimatePresence>\n                </div>\n\n                {currentQuestionIndex > 0 && (\n                    <button\n                        onClick={() => setCurrentQuestionIndex(currentQuestionIndex - 1)}\n                        className=\"mt-10 self-start flex items-center gap-2 text-slate-400 font-bold hover:text-slate-900 transition-colors\"\n                    >\n                        <ArrowLeft size={18} /> 前の質問に戻る\n                    </button>\n                )}\n            </div>\n        );\n    }\n\n    if (currentStep === 2 && results) {\n        return (\n            <div className=\"space-y-8 animate-in fade-in slide-in-from-bottom-5 duration-700\">\n                <div className=\"bg-white rounded-[3rem] p-10 md:p-16 border border-slate-200 shadow-xl overflow-hidden relative\">\n                    <div className=\"absolute right-[-10%] top-[-10%] text-blue-50 -rotate-12\">\n                        <Trophy size={400} />\n                    </div>\n\n                    <div className=\"relative z-10 text-center mb-12\">\n                        <div className=\"inline-flex items-center gap-2 bg-blue-50 text-blue-600 px-4 py-1.5 rounded-full text-xs font-black uppercase tracking-widest mb-4 border border-blue-100\">\n                            <CheckCircle2 size={16} /> 診断完了\n                        </div>\n                        <h2 className=\"text-3xl md:text-5xl font-black text-slate-900 tracking-tight\">あなたの強み分析結果</h2>\n                    </div>\n\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 relative z-10\">\n                        {Object.entries(CATEGORY_NAMES).map(([key, info]) => (\n                            <div key={key} className=\"bg-slate-50 p-8 rounded-[2rem] border border-slate-100 group hover:shadow-lg transition-all\">\n                                <div className=\"flex items-center justify-between mb-6\">\n                                    <div className={`${info.bg} ${info.color} p-4 rounded-2xl`}>\n                                        <info.icon size={28} />\n                                    </div>\n                                    <span className={`text-2xl font-black ${info.color}`}>{results[key]}%</span>\n                                </div>\n                                <h3 className=\"text-xl font-black text-slate-900 mb-2\">{info.label}</h3>\n                                <div className=\"h-2 bg-white rounded-full overflow-hidden\">\n                                    <motion.div\n                                        className={`h-full ${info.bg.replace('bg-', 'bg-').split('-')[0] === 'bg' ? info.color.replace('text-', 'bg-') : 'bg-blue-600'}`}\n                                        initial={{ width: 0 }}\n                                        animate={{ width: `${results[key]}%` }}\n                                        transition={{ duration: 1, delay: 0.5 }}\n                                    />\n                                </div>\n                            </div>\n                        ))}\n                    </div>\n\n                    <div className=\"mt-12 p-8 bg-slate-900 rounded-3xl text-white relative z-10\">\n                        <div className=\"flex items-center gap-4 mb-4\">\n                            <div className=\"bg-white/10 p-2 rounded-xl\">\n                                <Lightbulb className=\"text-amber-400\" />\n                            </div>\n                            <h3 className=\"text-xl font-black\">アドバイス</h3>\n                        </div>\n                        <p className=\"text-slate-400 font-bold leading-relaxed\">\n                            {results.executing > 70 ? 'あなたは圧倒的な行動力の持ち主です。目標を明確にすることで、さらに大きな成果を出せるでしょう。' :\n                                results.strategic > 70 ? 'あなたは分析力と先見の明に優れています。プロジェクトの初期段階や改善提案で力を発揮します。' :\n                                    'あなたのバランスの取れた強みは、あらゆるチームでの潤滑油となります。まずは自分が最もワクワクすることから始めてみましょう。'}\n                        </p>\n                    </div>\n                </div>\n\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                    <button\n                        onClick={() => {\n                            setCurrentStep(0);\n                            setCurrentQuestionIndex(0);\n                            setAnswers({});\n                        }}\n                        className=\"bg-white border border-slate-200 text-slate-900 font-black py-5 rounded-3xl hover:bg-slate-50 transition-all shadow-sm\"\n                    >\n                        もう一度診断する\n                    </button>\n                    <button\n                        onClick={() => {\n                            setAnalysisResults({ strengths: results });\n                            toast.success('結果をプロフィールに保存しました');\n                        }}\n                        className=\"md:col-span-2 bg-blue-600 text-white font-black py-5 rounded-3xl hover:bg-blue-500 transition-all shadow-lg shadow-blue-100 flex items-center justify-center gap-2\"\n                    >\n                        結果をプロフィールに反映する <CheckCircle2 size={20} />\n                    </button>\n                </div>\n            </div>\n        );\n    }\n\n    return null;\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/auth/LoginPromptModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useAppStore' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":21,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"useAppStore"},"fix":{"range":[15,60],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useAppStore } from \"@/lib/appStore\";\nimport { useRouter } from \"next/navigation\";\nimport { X } from \"lucide-react\";\n\ninterface LoginPromptModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    message?: string;\n}\n\nexport function LoginPromptModal({ isOpen, onClose, message = \"この機能を利用するにはログインが必要です\" }: LoginPromptModalProps) {\n    const router = useRouter();\n\n    if (!isOpen) return null;\n\n    return (\n        <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4\" onClick={onClose}>\n            <div className=\"bg-white rounded-3xl p-8 max-w-md w-full shadow-2xl transform transition-all\" onClick={(e) => e.stopPropagation()}>\n                <div className=\"flex justify-end mb-4\">\n                    <button onClick={onClose} className=\"text-slate-400 hover:text-slate-600 transition-colors\">\n                        <X size={24} />\n                    </button>\n                </div>\n\n                <div className=\"text-center mb-8\">\n                    <div className=\"w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-6\">\n                        <svg className=\"w-10 h-10 text-blue-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\" />\n                        </svg>\n                    </div>\n\n                    <h3 className=\"text-2xl font-black text-slate-800 mb-3\">ログインが必要です</h3>\n                    <p className=\"text-slate-600 font-medium mb-2\">{message}</p>\n                    <p className=\"text-sm text-slate-500\">まずはアカウントを作成して、Ehime Baseの全ての機能を体験してみませんか？</p>\n                </div>\n\n                <div className=\"space-y-3\">\n                    <button\n                        onClick={() => router.push('/welcome')}\n                        className=\"w-full bg-blue-600 text-white py-4 rounded-xl font-black hover:bg-blue-700 transition-all shadow-lg hover:shadow-xl active:scale-95\"\n                    >\n                        アカウントを作成する\n                    </button>\n                    <button\n                        onClick={() => router.push('/login/seeker')}\n                        className=\"w-full bg-slate-100 text-slate-700 py-4 rounded-xl font-black hover:bg-slate-200 transition-all active:scale-95\"\n                    >\n                        すでにアカウントをお持ちの方\n                    </button>\n                </div>\n\n                <p className=\"text-center text-xs text-slate-400 mt-6\">\n                    無料で簡単に始められます\n                </p>\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/chat/ChatDetailModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MapPin' is defined but never used.","line":2,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":19,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"MapPin"},"fix":{"range":[62,70],"text":""},"desc":"Remove unused variable \"MapPin\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Activity' is defined but never used.","line":2,"column":64,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":72,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Activity"},"fix":{"range":[113,123],"text":""},"desc":"Remove unused variable \"Activity\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertCircle' is defined but never used.","line":2,"column":97,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":108,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"AlertCircle"},"fix":{"range":[146,159],"text":""},"desc":"Remove unused variable \"AlertCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'partnerId' is defined but never used.","line":23,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":14},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/chat/ChatDetailModal.tsx:44:13\n  42 |     useEffect(() => {\n  43 |         if (isOpen) {\n> 44 |             setAlias(settings?.alias || '');\n     |             ^^^^^^^^ Avoid calling setState() directly within an effect\n  45 |             setMemo(settings?.memo || '');\n  46 |         }\n  47 |     }, [isOpen, settings]);","line":44,"column":13,"nodeType":null,"endLine":44,"endColumn":21},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":96,"column":37,"nodeType":"JSXOpeningElement","endLine":96,"endColumn":132},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":100,"column":29,"nodeType":"JSXOpeningElement","endLine":100,"endColumn":153},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/chat/ChatDetailModal.tsx:189:30\n  187 |                         <label className=\"text-xs font-bold text-slate-500 mb-2 block uppercase tracking-wider\">優先度</label>\n  188 |                         <div className=\"flex gap-2\">\n> 189 |                             <PriorityButton level=\"high\" label=\"高\" color=\"red\" />\n      |                              ^^^^^^^^^^^^^^ This component is created during render\n  190 |                             <PriorityButton level=\"medium\" label=\"中\" color=\"orange\" />\n  191 |                             <PriorityButton level=\"low\" label=\"低\" color=\"blue\" />\n  192 |                         </div>\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/chat/ChatDetailModal.tsx:68:28\n  66 |     if (!isOpen) return null;\n  67 |\n> 68 |     const PriorityButton = ({ level, label, color }: { level: 'high' | 'medium' | 'low', label: string, color: string }) => (\n     |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 69 |         <button\n     | ^^^^^^^^^^^^^^^\n> 70 |             onClick={() => setPriority(settings?.priority === level ? null : level)}\n     …\n     | ^^^^^^^^^^^^^^^\n> 77 |         </button>\n     | ^^^^^^^^^^^^^^^\n> 78 |     );\n     | ^^^^^^ The component is created during render here\n  79 |\n  80 |     return (\n  81 |         <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4 animate-in fade-in duration-200\">","line":189,"column":30,"nodeType":null,"endLine":189,"endColumn":44},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/chat/ChatDetailModal.tsx:190:30\n  188 |                         <div className=\"flex gap-2\">\n  189 |                             <PriorityButton level=\"high\" label=\"高\" color=\"red\" />\n> 190 |                             <PriorityButton level=\"medium\" label=\"中\" color=\"orange\" />\n      |                              ^^^^^^^^^^^^^^ This component is created during render\n  191 |                             <PriorityButton level=\"low\" label=\"低\" color=\"blue\" />\n  192 |                         </div>\n  193 |                     </div>\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/chat/ChatDetailModal.tsx:68:28\n  66 |     if (!isOpen) return null;\n  67 |\n> 68 |     const PriorityButton = ({ level, label, color }: { level: 'high' | 'medium' | 'low', label: string, color: string }) => (\n     |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 69 |         <button\n     | ^^^^^^^^^^^^^^^\n> 70 |             onClick={() => setPriority(settings?.priority === level ? null : level)}\n     …\n     | ^^^^^^^^^^^^^^^\n> 77 |         </button>\n     | ^^^^^^^^^^^^^^^\n> 78 |     );\n     | ^^^^^^ The component is created during render here\n  79 |\n  80 |     return (\n  81 |         <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4 animate-in fade-in duration-200\">","line":190,"column":30,"nodeType":null,"endLine":190,"endColumn":44},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/chat/ChatDetailModal.tsx:191:30\n  189 |                             <PriorityButton level=\"high\" label=\"高\" color=\"red\" />\n  190 |                             <PriorityButton level=\"medium\" label=\"中\" color=\"orange\" />\n> 191 |                             <PriorityButton level=\"low\" label=\"低\" color=\"blue\" />\n      |                              ^^^^^^^^^^^^^^ This component is created during render\n  192 |                         </div>\n  193 |                     </div>\n  194 |\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/chat/ChatDetailModal.tsx:68:28\n  66 |     if (!isOpen) return null;\n  67 |\n> 68 |     const PriorityButton = ({ level, label, color }: { level: 'high' | 'medium' | 'low', label: string, color: string }) => (\n     |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 69 |         <button\n     | ^^^^^^^^^^^^^^^\n> 70 |             onClick={() => setPriority(settings?.priority === level ? null : level)}\n     …\n     | ^^^^^^^^^^^^^^^\n> 77 |         </button>\n     | ^^^^^^^^^^^^^^^\n> 78 |     );\n     | ^^^^^^ The component is created during render here\n  79 |\n  80 |     return (\n  81 |         <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4 animate-in fade-in duration-200\">","line":191,"column":30,"nodeType":null,"endLine":191,"endColumn":44}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { X, MapPin, User as UserIcon, Building2, ExternalLink, Activity, Pin, Ban, Mail, Check, AlertCircle, Edit2 } from 'lucide-react';\nimport { useAppStore, User } from '@/lib/appStore';\nimport { Company } from '@/lib/dummyData';\n\ninterface ChatDetailModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    chatId: string;\n    partnerName: string;\n    partnerImage: string;\n    partnerId: string;\n    isCompany: boolean; // True if the PARTNER is a company\n    partnerData?: User | Company;\n}\n\nexport default function ChatDetailModal({\n    isOpen,\n    onClose,\n    chatId,\n    partnerName,\n    partnerImage,\n    partnerId,\n    isCompany,\n    partnerData\n}: ChatDetailModalProps) {\n    const {\n        currentUserId,\n        currentCompanyId,\n        activeRole,\n        updateChatSettings,\n        getChatSettingsHelper\n    } = useAppStore();\n\n    const myselfId = activeRole === 'seeker' ? currentUserId : currentCompanyId;\n    const settings = getChatSettingsHelper(myselfId, chatId);\n\n    const [alias, setAlias] = useState('');\n    const [memo, setMemo] = useState('');\n    const [isEditingAlias, setIsEditingAlias] = useState(false);\n\n    useEffect(() => {\n        if (isOpen) {\n            setAlias(settings?.alias || '');\n            setMemo(settings?.memo || '');\n        }\n    }, [isOpen, settings]);\n\n    const handleSaveAlias = () => {\n        updateChatSettings(myselfId, chatId, { alias });\n        setIsEditingAlias(false);\n    };\n\n    const handleSaveMemo = (val: string) => {\n        setMemo(val);\n        // Debounce? For now direct save is okay for MVP or save on blur. \n        // Let's save on blur or specific changes to avoid too many writes if expensive, but here it's local state fast.\n        updateChatSettings(myselfId, chatId, { memo: val });\n    };\n\n    const togglePin = () => updateChatSettings(myselfId, chatId, { isPinned: !settings?.isPinned });\n    const toggleBlock = () => updateChatSettings(myselfId, chatId, { isBlocked: !settings?.isBlocked });\n    const toggleUnread = () => updateChatSettings(myselfId, chatId, { isUnreadManual: !settings?.isUnreadManual });\n    const setPriority = (p: 'high' | 'medium' | 'low' | null) => updateChatSettings(myselfId, chatId, { priority: p });\n\n    if (!isOpen) return null;\n\n    const PriorityButton = ({ level, label, color }: { level: 'high' | 'medium' | 'low', label: string, color: string }) => (\n        <button\n            onClick={() => setPriority(settings?.priority === level ? null : level)}\n            className={`flex-1 py-2 rounded-lg border text-xs font-bold transition-all ${settings?.priority === level\n                ? `bg-${color}-100 border-${color}-500 text-${color}-600`\n                : 'bg-white border-slate-200 text-slate-500 hover:bg-slate-50'\n                }`}\n        >\n            {label}\n        </button>\n    );\n\n    return (\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4 animate-in fade-in duration-200\">\n            <div className=\"bg-white rounded-3xl shadow-2xl w-full max-w-md overflow-hidden animate-in zoom-in-95 duration-200\">\n                {/* Header / Profile Cover */}\n                <div className=\"bg-slate-100 p-6 flex flex-col items-center relative\">\n                    <button onClick={onClose} className=\"absolute top-4 right-4 p-2 bg-white/50 hover:bg-white rounded-full transition-colors\">\n                        <X size={20} className=\"text-slate-600\" />\n                    </button>\n\n                    {/* Priority Badge on Avatar (Bottom-Left) */}\n                    <div className=\"relative mb-4\">\n                        {isCompany ? (\n                            <div className={`w-24 h-24 rounded-2xl flex items-center justify-center text-4xl shadow-lg ${partnerImage.startsWith('bg-') ? partnerImage : 'bg-white'}`}>\n                                {partnerImage.startsWith('bg-') ? (\n                                    <Building2 className=\"text-white w-12 h-12\" />\n                                ) : (\n                                    <img src={partnerImage} alt={partnerName} className=\"w-full h-full object-cover rounded-2xl\" />\n                                )}\n                            </div>\n                        ) : (\n                            <img src={partnerImage} alt={partnerName} className=\"w-24 h-24 rounded-full object-cover shadow-lg border-4 border-white\" />\n                        )}\n                        {settings?.priority && (\n                            <div className={`absolute -bottom-2 -left-2 px-2 py-1 rounded-lg border-2 border-white text-xs font-bold text-white shadow-sm flex items-center justify-center z-10\n                                ${settings.priority === 'high' ? 'bg-red-500' : settings.priority === 'medium' ? 'bg-orange-500' : 'bg-blue-500'}\n                            `}>\n                                {settings.priority === 'high' ? '高' : settings.priority === 'medium' ? '中' : '低'}\n                            </div>\n                        )}\n                    </div>\n\n                    {/* Name & Alias */}\n                    <div className=\"w-full text-center\">\n                        {isEditingAlias ? (\n                            <div className=\"flex items-center justify-center gap-2 mb-1\">\n                                <input\n                                    className=\"text-center font-bold text-lg bg-white border border-slate-300 rounded px-2 py-1 outline-none focus:border-blue-500 w-2/3\"\n                                    value={alias}\n                                    onChange={(e) => setAlias(e.target.value)}\n                                    placeholder=\"表示名を変更\"\n                                    autoFocus\n                                />\n                                <button onClick={handleSaveAlias} className=\"p-1 bg-blue-500 text-white rounded hover:bg-blue-600\"><Check size={16} /></button>\n                            </div>\n                        ) : (\n                            <h2\n                                className=\"text-xl font-bold text-slate-900 flex items-center justify-center gap-2 cursor-pointer hover:opacity-70 group\"\n                                onClick={() => { setAlias(settings?.alias || partnerName); setIsEditingAlias(true); }}\n                                title=\"クリックして表示名を編集\"\n                            >\n                                {settings?.alias || partnerName}\n                                <div className=\"p-1.5 rounded-full bg-slate-100 text-slate-400 group-hover:bg-slate-200 group-hover:text-slate-600 transition-colors\">\n                                    <Edit2 size={14} />\n                                </div>\n                            </h2>\n                        )}\n\n                        {(settings?.alias && settings.alias !== partnerName) && (\n                            <p className=\"text-xs text-slate-500\">元: {partnerName}</p>\n                        )}\n\n                        {/* Basic Info Tags */}\n                        {partnerData && (\n                            <div className=\"flex flex-wrap gap-2 justify-center mt-3\">\n                                {!isCompany && (partnerData as User).age && (\n                                    <span className=\"px-2 py-0.5 bg-slate-200 text-slate-600 text-xs rounded-full\">{(partnerData as User).age}歳</span>\n                                )}\n                                {!isCompany && (partnerData as User).university && (\n                                    <span className=\"px-2 py-0.5 bg-slate-200 text-slate-600 text-xs rounded-full\">{(partnerData as User).university}</span>\n                                )}\n                                {isCompany && (partnerData as Company).industry && (\n                                    <span className=\"px-2 py-0.5 bg-slate-200 text-slate-600 text-xs rounded-full\">{(partnerData as Company).industry}</span>\n                                )}\n                            </div>\n                        )}\n                    </div>\n                </div>\n\n                {/* Actions Grid */}\n                <div className=\"p-6 space-y-6\">\n                    {/* Quick Core Actions */}\n                    <div className=\"grid grid-cols-3 gap-3\">\n                        <button\n                            onClick={togglePin}\n                            className={`flex flex-col items-center gap-1 p-3 rounded-xl transition-all ${settings?.isPinned ? 'bg-blue-50 text-blue-600 ring-2 ring-blue-500 ring-inset' : 'bg-slate-50 text-slate-600 hover:bg-slate-100'}`}\n                        >\n                            <Pin size={20} className={settings?.isPinned ? 'fill-current' : ''} />\n                            <span className=\"text-xs font-bold\">ピン留め</span>\n                        </button>\n                        <button\n                            onClick={toggleUnread}\n                            className={`flex flex-col items-center gap-1 p-3 rounded-xl transition-all ${settings?.isUnreadManual ? 'bg-orange-50 text-orange-600 ring-2 ring-orange-500 ring-inset' : 'bg-slate-50 text-slate-600 hover:bg-slate-100'}`}\n                        >\n                            <Mail size={20} className={settings?.isUnreadManual ? 'fill-current' : ''} />\n                            <span className=\"text-xs font-bold\">未読にする</span>\n                        </button>\n                        <button\n                            onClick={toggleBlock}\n                            className={`flex flex-col items-center gap-1 p-3 rounded-xl transition-all ${settings?.isBlocked ? 'bg-red-50 text-red-600 ring-2 ring-red-500 ring-inset' : 'bg-slate-50 text-slate-600 hover:bg-slate-100'}`}\n                        >\n                            <Ban size={20} />\n                            <span className=\"text-xs font-bold\">ブロック</span>\n                        </button>\n                    </div>\n\n                    {/* Priority Selector */}\n                    <div>\n                        <label className=\"text-xs font-bold text-slate-500 mb-2 block uppercase tracking-wider\">優先度</label>\n                        <div className=\"flex gap-2\">\n                            <PriorityButton level=\"high\" label=\"高\" color=\"red\" />\n                            <PriorityButton level=\"medium\" label=\"中\" color=\"orange\" />\n                            <PriorityButton level=\"low\" label=\"低\" color=\"blue\" />\n                        </div>\n                    </div>\n\n                    {/* Memo */}\n                    <div>\n                        <label className=\"text-xs font-bold text-slate-500 mb-2 block uppercase tracking-wider\">メモ (100文字)</label>\n                        <textarea\n                            className=\"w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none\"\n                            rows={3}\n                            maxLength={100}\n                            placeholder=\"このユーザーに関するメモを入力...\"\n                            value={memo}\n                            onChange={(e) => handleSaveMemo(e.target.value)}\n                        />\n                        <div className=\"text-right text-[10px] text-slate-400 mt-1\">{memo.length}/100</div>\n                    </div>\n\n                    {/* Detail Link */}\n                    <div className=\"pt-2 border-t border-slate-100\">\n                        {isCompany ? (\n                            <a\n                                href=\"#\" // Link to Company Detail Page (needs actual implementation/route)\n                                className=\"block w-full py-3 bg-slate-900 text-white text-center font-bold rounded-xl hover:bg-slate-800 transition-colors flex items-center justify-center gap-2\"\n                            >\n                                <ExternalLink size={16} />\n                                企業情報を見る\n                            </a>\n                        ) : (\n                            <div className=\"bg-slate-50 p-4 rounded-xl\">\n                                <h4 className=\"font-bold text-sm mb-2 flex items-center gap-2\">\n                                    <UserIcon size={16} /> プロフィール概要\n                                </h4>\n                                <p className=\"text-xs text-slate-600 line-clamp-3\">{(partnerData as User)?.bio || '情報なし'}</p>\n                                <div className=\"mt-2 flex flex-wrap gap-1\">\n                                    {(partnerData as User)?.tags?.slice(0, 3).map(tag => (\n                                        <span key={tag} className=\"text-[10px] bg-white border border-slate-200 px-1.5 py-0.5 rounded text-slate-500\">#{tag}</span>\n                                    ))}\n                                </div>\n                            </div>\n                        )}\n                    </div>\n                </div>\n            </div>\n        </div >\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/chat/UnifiedChatInterface.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Trash2' is defined but never used.","line":4,"column":122,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":128,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Trash2"},"fix":{"range":[203,211],"text":""},"desc":"Remove unused variable \"Trash2\"."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/chat/UnifiedChatInterface.tsx:40:9\n  38 |     const [mounted, setMounted] = useState(false);\n  39 |     useEffect(() => {\n> 40 |         setMounted(true);\n     |         ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  41 |     }, []);\n  42 |\n  43 |     // Determine which chats to show based on role","line":40,"column":9,"nodeType":null,"endLine":40,"endColumn":19},{"ruleId":"react-hooks/preserve-manual-memoization","severity":2,"message":"Compilation Skipped: Existing memoization could not be preserved\n\nReact Compiler has skipped optimizing this component because the existing manual memoization could not be preserved. The inferred dependencies did not match the manually specified dependencies, which could cause the value to change more or less frequently than expected. The inferred dependency was `getSettings`, but the source dependencies were [chats, activeFilter, chatSettings, myselfId, chatSortBy, chatFilterPriority]. Inferred different dependency than source.\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/chat/UnifiedChatInterface.tsx:64:36\n   62 |\n   63 |     // Filter & Sort Chats\n>  64 |     const processedChats = useMemo(() => {\n      |                                    ^^^^^^^\n>  65 |         return chats.filter(chat => {\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n>  66 |             const s = getSettings(chat.id);\n      …\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 102 |         });\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 103 |     }, [chats, activeFilter, chatSettings, myselfId, chatSortBy, chatFilterPriority]);\n      | ^^^^^^ Could not preserve existing manual memoization\n  104 |\n  105 |     const selectedChat = chats.find(c => c.id === selectedChatId);\n  106 |","line":64,"column":36,"nodeType":null,"endLine":103,"endColumn":6},{"ruleId":"react-hooks/preserve-manual-memoization","severity":2,"message":"Compilation Skipped: Existing memoization could not be preserved\n\nReact Compiler has skipped optimizing this component because the existing manual memoization could not be preserved. The inferred dependencies did not match the manually specified dependencies, which could cause the value to change more or less frequently than expected. The inferred dependency was `getSettings`, but the source dependencies were [chats, activeFilter, chatSettings, myselfId, chatSortBy, chatFilterPriority]. Inferred different dependency than source.\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/chat/UnifiedChatInterface.tsx:64:36\n   62 |\n   63 |     // Filter & Sort Chats\n>  64 |     const processedChats = useMemo(() => {\n      |                                    ^^^^^^^\n>  65 |         return chats.filter(chat => {\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n>  66 |             const s = getSettings(chat.id);\n      …\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 102 |         });\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 103 |     }, [chats, activeFilter, chatSettings, myselfId, chatSortBy, chatFilterPriority]);\n      | ^^^^^^ Could not preserve existing manual memoization\n  104 |\n  105 |     const selectedChat = chats.find(c => c.id === selectedChatId);\n  106 |","line":64,"column":36,"nodeType":null,"endLine":103,"endColumn":6},{"ruleId":"react-hooks/preserve-manual-memoization","severity":2,"message":"Compilation Skipped: Existing memoization could not be preserved\n\nReact Compiler has skipped optimizing this component because the existing manual memoization could not be preserved. The inferred dependencies did not match the manually specified dependencies, which could cause the value to change more or less frequently than expected. The inferred dependency was `getSettings`, but the source dependencies were [chats, activeFilter, chatSettings, myselfId, chatSortBy, chatFilterPriority]. Inferred different dependency than source.\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/chat/UnifiedChatInterface.tsx:64:36\n   62 |\n   63 |     // Filter & Sort Chats\n>  64 |     const processedChats = useMemo(() => {\n      |                                    ^^^^^^^\n>  65 |         return chats.filter(chat => {\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n>  66 |             const s = getSettings(chat.id);\n      …\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 102 |         });\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 103 |     }, [chats, activeFilter, chatSettings, myselfId, chatSortBy, chatFilterPriority]);\n      | ^^^^^^ Could not preserve existing manual memoization\n  104 |\n  105 |     const selectedChat = chats.find(c => c.id === selectedChatId);\n  106 |","line":64,"column":36,"nodeType":null,"endLine":103,"endColumn":6},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has a missing dependency: 'getSettings'. Either include it or remove the dependency array.","line":103,"column":8,"nodeType":"ArrayExpression","endLine":103,"endColumn":85,"suggestions":[{"desc":"Update the dependencies array to be: [chats, getSettings, activeFilter, chatFilterPriority, myselfId, chatSortBy]","fix":{"range":[3906,3983],"text":"[chats, getSettings, activeFilter, chatFilterPriority, myselfId, chatSortBy]"}}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/chat/UnifiedChatInterface.tsx:131:21\n  129 |                 const unreadMsgs = chat.messages.filter(m => m.senderId !== myselfId && !m.isRead);\n  130 |                 if (unreadMsgs.length > 0) {\n> 131 |                     setUnreadBoundaryMessageId(unreadMsgs[0].id);\n      |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  132 |                 } else {\n  133 |                     setUnreadBoundaryMessageId(null);\n  134 |                 }","line":131,"column":21,"nodeType":null,"endLine":131,"endColumn":47},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":393,"column":45,"nodeType":"JSXOpeningElement","endLine":393,"endColumn":176},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":473,"column":45,"nodeType":"JSXOpeningElement","endLine":473,"endColumn":137},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":501,"column":61,"nodeType":"JSXOpeningElement","endLine":501,"endColumn":167},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":537,"column":75,"nodeType":"Identifier","messageId":"unusedVar","endLine":537,"endColumn":76},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":554,"column":85,"nodeType":"JSXOpeningElement","endLine":558,"endColumn":87},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":652,"column":49,"nodeType":"JSXOpeningElement","endLine":652,"endColumn":137}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useRef, useEffect, useState, useMemo } from 'react';\nimport { Search, MoreHorizontal, Send, Paperclip, Phone, ChevronLeft, MessageSquare, FileText, Download, X, Copy, Reply, Trash2, RotateCcw, Pin, Ban, ChevronDown } from 'lucide-react';\nimport { useAppStore, ChatThread, Attachment } from '@/lib/appStore';\nimport MobileBottomNav from '@/components/MobileBottomNav';\nimport ChatDetailModal from './ChatDetailModal';\n\ninterface UnifiedChatInterfaceProps {\n    mode: 'fullscreen' | 'embedded'; // fullscreen for Seeker, embedded for Company Dashboard\n    initialChatId?: string;\n}\n\nexport default function UnifiedChatInterface({ mode, initialChatId }: UnifiedChatInterfaceProps) {\n    const {\n        getUserChats,\n        getCompanyChats,\n        currentUserId,\n        currentCompanyId,\n        activeRole,\n        companies,\n        users,\n        sendMessage,\n        markAsRead,\n        deleteMessage,\n        getChatSettingsHelper,\n        chatSettings, // Subscribe to settings updates\n        updateChatSettings,\n        // Chat Preferences\n        chatSortBy,\n        chatFilterPriority,\n        isCompactMode,\n        setChatSortBy,\n        toggleChatFilterPriority,\n        setCompactMode\n    } = useAppStore();\n\n    const [mounted, setMounted] = useState(false);\n    useEffect(() => {\n        setMounted(true);\n    }, []);\n\n    // Determine which chats to show based on role\n    const chats = activeRole === 'seeker'\n        ? getUserChats(currentUserId)\n        : getCompanyChats(currentCompanyId);\n\n    const [selectedChatId, setSelectedChatId] = React.useState<string | null>(initialChatId || chats[0]?.id || null);\n\n    // UI State\n    const [inputText, setInputText] = React.useState('');\n    const [attachment, setAttachment] = React.useState<Attachment | null>(null);\n    const [replyToId, setReplyToId] = React.useState<string | null>(null);\n    const [activeFilter, setActiveFilter] = useState<'all' | 'unread' | 'blocked'>('all');\n    const [showDetailModal, setShowDetailModal] = useState(false);\n    const [isSettingsOpen, setIsSettingsOpen] = useState(false);\n\n    const myselfId = activeRole === 'seeker' ? currentUserId : currentCompanyId;\n\n    // Helper to get settings\n    const getSettings = (chatId: string) => getChatSettingsHelper(myselfId, chatId);\n\n    // Filter & Sort Chats\n    const processedChats = useMemo(() => {\n        return chats.filter(chat => {\n            const s = getSettings(chat.id);\n            const isBlocked = s?.isBlocked;\n\n            if (activeFilter === 'blocked') return isBlocked;\n            if (isBlocked) return false; // Hide blocked in All/Unread\n\n            // Priority Filter (Apply to All/Unread)\n            const effectivePriority = s?.priority || 'medium';\n            if (!chatFilterPriority.includes(effectivePriority)) return false;\n\n            if (activeFilter === 'unread') {\n                const unreadCount = chat.messages.filter(m => m.senderId !== myselfId && !m.isRead).length;\n                return unreadCount > 0 || s?.isUnreadManual;\n            }\n            return true;\n        }).sort((a, b) => {\n            const sA = getSettings(a.id);\n            const sB = getSettings(b.id);\n\n            // 1. Pinned\n            if (sA?.isPinned !== sB?.isPinned) return (sA?.isPinned ? -1 : 1);\n\n            // 2. Priority Sort\n            if (chatSortBy === 'priority') {\n                const getPrioScore = (p: string | null | undefined) => {\n                    if (p === 'high') return 3;\n                    if (p === 'low') return 1;\n                    return 2; // medium or undefined\n                };\n                const pA = getPrioScore(sA?.priority);\n                const pB = getPrioScore(sB?.priority);\n                if (pA !== pB) return pB - pA; // Descending\n            }\n\n            // 3. Updated\n            return b.updatedAt - a.updatedAt;\n        });\n    }, [chats, activeFilter, chatSettings, myselfId, chatSortBy, chatFilterPriority]);\n\n    const selectedChat = chats.find(c => c.id === selectedChatId);\n\n    // Context Menu State\n    const [contextMenu, setContextMenu] = useState<{ x: number, y: number, messageId: string, isMe: boolean } | null>(null);\n    const [partialCopyText, setPartialCopyText] = useState<string | null>(null);\n    const [unreadBoundaryMessageId, setUnreadBoundaryMessageId] = useState<string | null>(null);\n    const contextMenuRef = useRef<HTMLDivElement>(null);\n    const prevChatIdRef = useRef<string | null>(null);\n\n    const fileInputRef = useRef<HTMLInputElement>(null);\n    const messagesEndRef = useRef<HTMLDivElement>(null);\n\n    // Scroll to bottom on new message\n    useEffect(() => {\n        if (messagesEndRef.current) {\n            messagesEndRef.current.scrollIntoView({ behavior: 'smooth' });\n        }\n    }, [selectedChat?.messages]);\n\n    // Mark as read & Logic for Unread Separator\n    useEffect(() => {\n        if (selectedChatId && selectedChatId !== prevChatIdRef.current) {\n            const chat = chats.find(c => c.id === selectedChatId);\n            if (chat) {\n                const unreadMsgs = chat.messages.filter(m => m.senderId !== myselfId && !m.isRead);\n                if (unreadMsgs.length > 0) {\n                    setUnreadBoundaryMessageId(unreadMsgs[0].id);\n                } else {\n                    setUnreadBoundaryMessageId(null);\n                }\n\n                markAsRead(selectedChatId, myselfId);\n                updateChatSettings(myselfId, selectedChatId, { isUnreadManual: false });\n            }\n            prevChatIdRef.current = selectedChatId;\n        }\n    }, [selectedChatId, chats, markAsRead, myselfId, updateChatSettings]);\n\n    // Close context menu on click outside\n    useEffect(() => {\n        const handleClickOutside = (e: MouseEvent) => {\n            if (contextMenuRef.current && !contextMenuRef.current.contains(e.target as Node)) {\n                setContextMenu(null);\n            }\n        };\n        document.addEventListener('click', handleClickOutside);\n        return () => document.removeEventListener('click', handleClickOutside);\n    }, []);\n\n\n    const handleSend = () => {\n        if ((!inputText.trim() && !attachment) || !selectedChatId) return;\n        sendMessage(selectedChatId, myselfId, inputText, attachment || undefined, replyToId || undefined);\n        setInputText('');\n        setAttachment(null);\n        setReplyToId(null);\n    };\n\n    const handleFileSelect = (e: React.ChangeEvent<HTMLInputElement>) => {\n        if (e.target.files && e.target.files[0]) {\n            const file = e.target.files[0];\n            const isImage = file.type.startsWith('image/');\n            const newAttachment: Attachment = {\n                id: `att_${Date.now()}`,\n                type: isImage ? 'image' : 'file',\n                url: URL.createObjectURL(file),\n                name: file.name,\n                size: `${(file.size / 1024).toFixed(1)} KB`\n            };\n            setAttachment(newAttachment);\n        }\n    };\n\n    const handleContextMenu = (e: React.MouseEvent, messageId: string, senderId: string) => {\n        e.preventDefault();\n\n        // Prevent menu from going off-screen\n        const menuWidth = 224;\n        const maxX = window.innerWidth - menuWidth - 24;\n        const x = Math.min(e.clientX, maxX);\n        const y = e.clientY;\n\n        setContextMenu({\n            x,\n            y,\n            messageId,\n            isMe: senderId === myselfId\n        });\n    };\n\n    const handleCopy = (text: string) => {\n        navigator.clipboard.writeText(text);\n        setContextMenu(null);\n    };\n\n    const handleReply = (messageId: string) => {\n        setReplyToId(messageId);\n        setContextMenu(null);\n    };\n\n    const deleteMsg = (messageId: string) => {\n        if (selectedChatId) {\n            deleteMessage(selectedChatId, messageId);\n        }\n        setContextMenu(null);\n    };\n\n    const handlePartialCopy = () => {\n        const msg = selectedChat?.messages.find(m => m.id === contextMenu?.messageId);\n        if (msg?.text) {\n            setPartialCopyText(msg.text);\n        }\n        setContextMenu(null);\n    };\n\n\n    const getChatPartner = (chat: ChatThread) => {\n        let partner = { name: '', image: '', isImageColor: false };\n        if (activeRole === 'seeker') {\n            const c = companies.find(c => c.id === chat.companyId);\n            partner = {\n                name: c?.name || 'Unknown Company',\n                image: c?.logoColor || 'bg-slate-400',\n                isImageColor: true\n            };\n        } else {\n            const u = users.find(u => u.id === chat.userId);\n            partner = {\n                name: u?.name || 'Unknown User',\n                image: u?.image || '',\n                isImageColor: false\n            };\n        }\n\n        // Apply Chat Settings Alias\n        const s = getSettings(chat.id);\n        if (s?.alias) {\n            partner.name = s.alias;\n        }\n        return partner;\n    };\n\n    // --- Layout Classes ---\n    // --- Layout Classes ---\n    // User requested unified UI, so we remove the \"card\" styling from embedded mode\n    const containerClasses = mode === 'fullscreen'\n        ? \"flex bg-slate-50 min-h-screen pb-20 md:pb-0\"\n        : \"flex bg-slate-50 h-full relative\";\n\n    const sidebarClasses = mode === 'fullscreen'\n        ? `w-full md:w-80 bg-white border-r border-slate-200 flex flex-col h-screen fixed md:relative z-20 transition-transform ${selectedChatId ? '-translate-x-full md:translate-x-0' : 'translate-x-0'}`\n        : \"w-80 bg-white border-r border-slate-200 flex flex-col shrink-0\";\n\n    const chatAreaClasses = mode === 'fullscreen'\n        ? `flex-1 flex flex-col h-screen fixed inset-0 z-30 bg-white md:relative md:bg-transparent transition-transform duration-300 ${selectedChatId ? 'translate-x-0' : 'translate-x-full md:translate-x-0'}`\n        : \"flex-1 flex flex-col bg-slate-50 overflow-hidden\";\n\n    if (!mounted) return null;\n\n    return (\n        <div className={containerClasses}>\n            {/* Sidebar (Chat List) */}\n            <div className={sidebarClasses}>\n                <div className=\"p-4 border-b border-slate-100 mt-14 md:mt-0\">\n                    <h1 className=\"text-xl md:text-2xl font-black text-slate-800 mb-4\">\n                        メッセージ\n                    </h1>\n                    <div className=\"relative mb-4\">\n                        <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400\" size={16} />\n                        <input\n                            type=\"text\"\n                            placeholder={activeRole === 'seeker' ? \"企業名で検索\" : \"求職者名で検索\"}\n                            className=\"w-full pl-9 pr-4 py-2 rounded-xl bg-slate-100 text-slate-800 text-sm font-bold focus:outline-none placeholder:text-slate-400\"\n                        />\n                    </div>\n                    {/* Tabs & Toggle */}\n                    <div className=\"flex items-center gap-2\">\n                        <div className=\"flex-1 flex p-1 bg-slate-100 rounded-lg\">\n                            {(['all', 'unread', 'blocked'] as const).map(f => (\n                                <button\n                                    key={f}\n                                    onClick={() => setActiveFilter(f)}\n                                    className={`flex-1 py-1.5 text-xs font-bold rounded-md transition-all ${activeFilter === f\n                                        ? 'bg-white text-slate-800 shadow-sm'\n                                        : 'text-slate-400 hover:text-slate-600'\n                                        }`}\n                                >\n                                    {f === 'all' && 'すべて'}\n                                    {f === 'unread' && '未読'}\n                                    {f === 'blocked' && 'ブロック'}\n                                </button>\n                            ))}\n                        </div>\n                        <button\n                            onClick={() => setIsSettingsOpen(!isSettingsOpen)}\n                            className={`p-2 rounded-lg transition-colors ${isSettingsOpen ? 'bg-slate-200 text-slate-800' : 'text-slate-400 hover:bg-slate-100'}`}\n                        >\n                            <ChevronDown size={18} className={`transition-transform duration-200 ${isSettingsOpen ? 'rotate-180' : ''}`} />\n                        </button>\n                    </div>\n\n                    {/* Accordion Panel */}\n                    <div className={`overflow-hidden transition-all duration-300 ease-in-out ${isSettingsOpen ? 'max-h-48 opacity-100 mt-4' : 'max-h-0 opacity-0'}`}>\n                        <div className=\"bg-slate-50 rounded-xl p-3 border border-slate-100 space-y-3\">\n                            {/* Sort */}\n                            <div className=\"flex items-center justify-between\">\n                                <span className=\"text-xs font-bold text-slate-500\">並び替え</span>\n                                <div className=\"flex bg-white rounded-lg p-0.5 border border-slate-200\">\n                                    <button\n                                        onClick={() => setChatSortBy('date')}\n                                        className={`px-3 py-1 text-[10px] font-bold rounded-md transition-colors ${chatSortBy === 'date' ? 'bg-slate-100 text-slate-800' : 'text-slate-400 hover:text-slate-600'}`}\n                                    >\n                                        更新順\n                                    </button>\n                                    <button\n                                        onClick={() => setChatSortBy('priority')}\n                                        className={`px-3 py-1 text-[10px] font-bold rounded-md transition-colors ${chatSortBy === 'priority' ? 'bg-red-50 text-red-500' : 'text-slate-400 hover:text-slate-600'}`}\n                                    >\n                                        優先度順\n                                    </button>\n                                </div>\n                            </div>\n\n                            {/* Priority Filter */}\n                            <div className=\"flex items-center justify-between\">\n                                <span className=\"text-xs font-bold text-slate-500\">表示優先度</span>\n                                <div className=\"flex gap-2\">\n                                    {(['high', 'medium', 'low'] as const).map(p => (\n                                        <label key={p} className=\"flex items-center gap-1 cursor-pointer select-none\">\n                                            <input\n                                                type=\"checkbox\"\n                                                checked={chatFilterPriority.includes(p)}\n                                                onChange={() => toggleChatFilterPriority(p)}\n                                                className=\"rounded border-slate-300 text-blue-600 focus:ring-0 w-3 h-3\"\n                                            />\n                                            <span className={`text-[10px] font-bold ${p === 'high' ? 'text-red-500' : p === 'medium' ? 'text-orange-500' : 'text-blue-500'}`}>\n                                                {p === 'high' ? '高' : p === 'medium' ? '中' : '低'}\n                                            </span>\n                                        </label>\n                                    ))}\n                                </div>\n                            </div>\n\n                            {/* Compact Mode */}\n                            <div className=\"flex items-center justify-between\">\n                                <span className=\"text-xs font-bold text-slate-500\">コンパクト表示</span>\n                                <button\n                                    onClick={() => setCompactMode(!isCompactMode)}\n                                    className={`relative inline-flex h-5 w-9 items-center rounded-full transition-colors ${isCompactMode ? 'bg-blue-500' : 'bg-slate-200'}`}\n                                >\n                                    <span className={`inline-block h-3 w-3 transform rounded-full bg-white transition transition-transform ${isCompactMode ? 'translate-x-5' : 'translate-x-1'}`} />\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div className=\"flex-1 overflow-y-auto\">\n                    {processedChats.length > 0 ? (\n                        processedChats.map(chat => {\n                            const partner = getChatPartner(chat);\n                            const lastMsg = chat.messages[chat.messages.length - 1];\n                            const settings = getSettings(chat.id);\n\n                            // Unread Logic\n                            const sysUnread = chat.messages.filter(m => m.senderId !== myselfId && !m.isRead).length;\n                            const isUnread = sysUnread > 0 || settings?.isUnreadManual;\n                            const unreadCount = sysUnread;\n\n                            return (\n                                <div\n                                    key={chat.id}\n                                    onClick={() => setSelectedChatId(chat.id)}\n                                    className={`${isCompactMode ? 'p-2' : 'p-4'} flex gap-3 hover:bg-slate-50 cursor-pointer transition-colors border-b border-slate-50 relative ${selectedChatId === chat.id ? 'bg-blue-50/50' : ''}`}\n                                >\n                                    {/* Icon with Badges */}\n                                    <div\n                                        className=\"relative cursor-pointer hover:scale-105 transition-transform shrink-0\"\n                                        onClick={(e) => {\n                                            e.stopPropagation();\n                                            setSelectedChatId(chat.id);\n                                            setShowDetailModal(true);\n                                        }}\n                                    >\n                                        {partner.isImageColor ? (\n                                            <div className={`${isCompactMode ? 'w-10 h-10 text-sm' : 'w-12 h-12 text-lg'} rounded-xl flex items-center justify-center text-white font-bold ${partner.image}`}>\n                                                {partner.name.slice(0, 1)}\n                                            </div>\n                                        ) : (\n                                            <img src={partner.image} alt={partner.name} className={`${isCompactMode ? 'w-10 h-10' : 'w-12 h-12'} rounded-full object-cover`} />\n                                        )}\n\n                                        {/* Priority Badge (Bottom-Left) */}\n                                        {settings?.priority && (\n                                            <div className={`absolute -bottom-1 -left-1 px-1 rounded-md border border-white text-[8px] font-bold text-white shadow-sm flex items-center justify-center z-10\n                                                ${settings.priority === 'high' ? 'bg-red-500' : settings.priority === 'medium' ? 'bg-orange-500' : 'bg-blue-500'}\n                                            `}>\n                                                {settings.priority === 'high' ? '高' : settings.priority === 'medium' ? '中' : '低'}\n                                            </div>\n                                        )}\n                                    </div>\n\n                                    <div className=\"flex-1 min-w-0\">\n                                        <div className=\"flex justify-between items-start mb-1\">\n                                            <h4 className=\"font-black text-slate-800 text-sm truncate flex items-center gap-1\">\n                                                {settings?.isPinned && <Pin size={12} className=\"text-blue-500 fill-current\" />}\n                                                {partner.name}\n                                            </h4>\n                                            <span className=\"text-[10px] text-slate-400 font-bold whitespace-nowrap\">\n                                                {lastMsg ? new Date(lastMsg.timestamp).getHours() + ':' + String(new Date(lastMsg.timestamp).getMinutes()).padStart(2, '0') : ''}\n                                            </span>\n                                        </div>\n                                        <div className=\"flex justify-between items-end\">\n                                            <p className={`text-xs text-slate-500 font-medium line-clamp-1 flex-1 ${isCompactMode ? 'text-[10px]' : ''}`}>\n                                                {settings?.isBlocked ? (\n                                                    <span className=\"text-red-500 flex items-center gap-1\"><Ban size={12} /> ブロック中</span>\n                                                ) : (\n                                                    <>\n                                                        {lastMsg?.senderId === myselfId ? 'あなた: ' : ''}\n                                                        {lastMsg?.text || (lastMsg?.attachment ? (lastMsg.attachment.type === 'image' ? '画像が送信されました' : 'ファイルが送信されました') : 'メッセージなし')}\n                                                    </>\n                                                )}\n                                            </p>\n\n                                            {/* Unread Badge (Right Side) */}\n                                            {isUnread && (\n                                                <div className=\"ml-2 shrink-0\">\n                                                    <div className=\"min-w-[18px] h-[18px] bg-red-500 rounded-full flex items-center justify-center text-white text-[10px] font-bold px-1 shadow-sm\">\n                                                        {unreadCount > 0 ? unreadCount : '1'}\n                                                    </div>\n                                                </div>\n                                            )}\n                                        </div>\n                                    </div>\n                                </div>\n                            );\n                        })\n                    ) : (\n                        <div className=\"flex flex-col items-center justify-center h-64 text-slate-400 space-y-4\">\n                            <MessageSquare className=\"w-12 h-12 opacity-20\" />\n                            <p className=\"text-xs font-bold\">まだメッセージはありません</p>\n                        </div>\n                    )}\n                </div>\n            </div>\n\n            {/* Chat Area */}\n            <div className={chatAreaClasses}>\n                {selectedChat ? (\n                    (() => {\n                        const partner = getChatPartner(selectedChat);\n                        return (\n                            <>\n                                {/* Header */}\n                                <div className=\"h-16 border-b border-slate-100 flex items-center justify-between px-4 bg-white/90 backdrop-blur-md sticky top-0 z-10 transition-all duration-300\">\n                                    <div\n                                        className=\"flex items-center gap-3 cursor-pointer hover:opacity-70 transition-opacity\"\n                                        onClick={() => setShowDetailModal(true)}\n                                    >\n                                        {mode === 'fullscreen' && (\n                                            <button onClick={(e) => { e.stopPropagation(); setSelectedChatId(null); }} className=\"md:hidden text-slate-400 mr-2\">\n                                                <ChevronLeft size={24} />\n                                            </button>\n                                        )}\n                                        {partner.isImageColor ? (\n                                            <div className={`w-8 h-8 rounded-lg flex items-center justify-center text-white font-bold text-xs ${partner.image}`}>\n                                                {partner.name.slice(0, 1)}\n                                            </div>\n                                        ) : (\n                                            <img src={partner.image} alt={partner.name} className=\"w-8 h-8 rounded-full object-cover\" />\n                                        )}\n                                        <span className=\"font-black text-slate-800 truncate max-w-[200px]\">{partner.name}</span>\n                                    </div>\n                                    <div className=\"flex items-center gap-4 text-slate-400\">\n                                        <button className=\"hover:text-blue-600\"><Phone size={20} /></button>\n                                        <button className=\"hover:text-slate-600\"><MoreHorizontal size={20} /></button>\n                                    </div>\n                                </div>\n\n                                {/* Messages */}\n                                <div className=\"flex-1 overflow-y-auto p-4 md:p-6 flex flex-col-reverse gap-6 bg-slate-50/50 relative\">\n                                    {/* Bottom spacer */}\n                                    <div ref={messagesEndRef} className=\"h-0\" />\n\n                                    {[...selectedChat.messages].reverse().map(msg => {\n                                        const isMe = msg.senderId === myselfId;\n                                        const replyToMsg = msg.replyToId ? selectedChat.messages.find(m => m.id === msg.replyToId) : null;\n\n                                        return (\n                                            <React.Fragment key={msg.id}>\n                                                <div id={`msg-${msg.id}`} className={`flex gap-2 md:gap-3 ${isMe ? 'justify-end' : 'justify-start'} group`}>\n                                                    {!isMe && (\n                                                        partner.isImageColor ? (\n                                                            <div className={`w-8 h-8 rounded-lg flex items-center justify-center text-white font-bold text-xs mt-1 shrink-0 ${partner.image}`}>\n                                                                {partner.name.slice(0, 1)}\n                                                            </div>\n                                                        ) : (\n                                                            <img src={partner.image} alt={partner.name} className=\"w-8 h-8 rounded-full object-cover mt-1 shrink-0\" />\n                                                        )\n                                                    )}\n\n                                                    <div className={`flex flex-col ${isMe ? 'items-end' : 'items-start'} max-w-[85%] md:max-w-sm`}>\n                                                        {/* Reply Quote */}\n                                                        {replyToMsg && (\n                                                            <div\n                                                                className={`text-[10px] text-slate-500 bg-black/5 px-2 py-1 rounded-t-lg mb-0.5 border-l-2 border-slate-300 w-full truncate cursor-pointer hover:bg-black/10 transition-colors`}\n                                                                onClick={(e) => {\n                                                                    e.stopPropagation();\n                                                                    document.getElementById(`msg-${replyToMsg.id}`)?.scrollIntoView({ behavior: 'smooth', block: 'center' });\n                                                                }}\n                                                            >\n                                                                <span className=\"font-bold mr-1\">Reply to:</span>\n                                                                {replyToMsg.text || (replyToMsg.attachment ? `[${replyToMsg.attachment.type === 'image' ? '画像' : 'ファイル'}] ${replyToMsg.attachment.name}` : 'メッセージ')}\n                                                            </div>\n                                                        )}\n\n                                                        <div className=\"flex items-end gap-2\">\n                                                            {/* Timestamp/Read (Left side for ME) */}\n                                                            {isMe && (\n                                                                <div className=\"flex flex-col items-end text-[10px] text-slate-400 font-bold leading-tight mb-1\">\n                                                                    {msg.isRead && <span className=\"text-slate-400\">既読</span>}\n                                                                    <span>{new Date(msg.timestamp).getHours()}:{String(new Date(msg.timestamp).getMinutes()).padStart(2, '0')}</span>\n                                                                </div>\n                                                            )}\n\n                                                            {/* Message Bubble */}\n                                                            <div\n                                                                className={`p-3 md:p-4 rounded-2xl shadow-sm text-sm font-medium relative cursor-pointer select-text\n                                                                ${isMe\n                                                                        ? 'bg-gradient-to-tr from-blue-600 to-blue-500 text-white rounded-tr-none'\n                                                                        : 'bg-white text-slate-900 border border-slate-100 rounded-tl-none'\n                                                                    }`}\n                                                                onContextMenu={(e) => handleContextMenu(e, msg.id, msg.senderId)}\n                                                                onClick={(e) => {\n                                                                    if (window.getSelection()?.toString()) return;\n                                                                    handleReply(msg.id);\n                                                                }}\n                                                            >\n                                                                {/* Attachment Display */}\n                                                                {msg.attachment && (\n                                                                    <div className=\"mb-2\">\n                                                                        {msg.attachment.type === 'image' ? (\n                                                                            <div className=\"relative group inline-block\">\n                                                                                <a\n                                                                                    href={msg.attachment.url}\n                                                                                    target=\"_blank\"\n                                                                                    rel=\"noopener noreferrer\"\n                                                                                    className=\"block cursor-zoom-in\"\n                                                                                    onClick={(e) => e.stopPropagation()}\n                                                                                >\n                                                                                    <img\n                                                                                        src={msg.attachment.url}\n                                                                                        alt=\"attachment\"\n                                                                                        className=\"rounded-lg max-h-48 object-cover border border-black/10\"\n                                                                                    />\n                                                                                </a>\n                                                                                <a\n                                                                                    href={msg.attachment.url}\n                                                                                    download={msg.attachment.name}\n                                                                                    className=\"absolute top-2 right-2 p-1.5 bg-black/50 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-black/70 backdrop-blur-sm\"\n                                                                                    title=\"Download\"\n                                                                                    onClick={(e) => e.stopPropagation()}\n                                                                                >\n                                                                                    <Download size={16} />\n                                                                                </a>\n                                                                            </div>\n                                                                        ) : (\n                                                                            <div className={`flex items-center gap-3 p-3 rounded-xl ${isMe ? 'bg-white/20' : 'bg-slate-50'}`}>\n                                                                                <a\n                                                                                    href={msg.attachment.url}\n                                                                                    target=\"_blank\"\n                                                                                    rel=\"noopener noreferrer\"\n                                                                                    className=\"flex items-center gap-3 flex-1 min-w-0 hover:opacity-80 transition-opacity cursor-pointer\"\n                                                                                    onClick={(e) => e.stopPropagation()}\n                                                                                >\n                                                                                    <div className=\"p-2 bg-white rounded-lg text-blue-500 shadow-sm\">\n                                                                                        <FileText size={20} />\n                                                                                    </div>\n                                                                                    <div className=\"flex-1 min-w-0 text-left\">\n                                                                                        <p className=\"truncate font-bold text-xs\">{msg.attachment.name}</p>\n                                                                                        <p className=\"text-[10px] opacity-70\">{msg.attachment.size}</p>\n                                                                                    </div>\n                                                                                </a>\n                                                                                <a\n                                                                                    href={msg.attachment.url}\n                                                                                    download={msg.attachment.name}\n                                                                                    className=\"p-2 hover:bg-black/10 rounded-full transition-colors shrink-0\"\n                                                                                    onClick={(e) => e.stopPropagation()}\n                                                                                >\n                                                                                    <Download size={16} />\n                                                                                </a>\n                                                                            </div>\n                                                                        )}\n                                                                    </div>\n                                                                )}\n                                                                {msg.text}\n                                                            </div>\n\n                                                            {/* Timestamp (Right side for Other) */}\n                                                            {!isMe && (\n                                                                <div className=\"flex flex-col items-start text-[10px] text-slate-400 font-bold leading-tight mb-1\">\n                                                                    <span>{new Date(msg.timestamp).getHours()}:{String(new Date(msg.timestamp).getMinutes()).padStart(2, '0')}</span>\n                                                                </div>\n                                                            )}\n                                                        </div>\n                                                    </div>\n                                                </div>\n\n                                                {/* Unread Separator */}\n                                                {msg.id === unreadBoundaryMessageId && (\n                                                    <div className=\"w-full flex items-center justify-center my-6 animate-in fade-in zoom-in duration-300\">\n                                                        <span className=\"bg-red-50 text-red-500 text-[10px] font-bold px-4 py-1 rounded-full border border-red-100 shadow-sm flex items-center gap-2\">\n                                                            <span className=\"w-1.5 h-1.5 rounded-full bg-red-500 animate-pulse\" />\n                                                            ここから未読メッセージ\n                                                        </span>\n                                                    </div>\n                                                )}\n                                            </React.Fragment>\n                                        );\n                                    })}\n                                </div>\n\n                                {/* Context Menu Portal/Overlay */}\n\n\n                                {/* Input */}\n                                <div className={`p-4 bg-white border-t border-slate-100 ${mode === 'fullscreen' ? 'fixed bottom-0 w-full md:relative md:w-auto z-40 pb-safe md:pb-4' : 'sticky bottom-0 z-20'}`}>\n                                    {/* Reply Preview */}\n                                    {replyToId && (\n                                        <div className=\"mb-2 flex items-center justify-between p-2 bg-slate-100 border-l-4 border-blue-500 rounded-r-lg\">\n                                            <div className=\"text-xs text-slate-600 truncate max-w-[80%]\">\n                                                <span className=\"font-bold block text-blue-600\">Reply to:</span>\n                                                {(() => {\n                                                    const m = selectedChat.messages.find(msg => msg.id === replyToId);\n                                                    if (!m) return '';\n                                                    return m.text || (m.attachment ? `[${m.attachment.type === 'image' ? '画像' : 'ファイル'}] ${m.attachment.name}` : 'メッセージ');\n                                                })()}\n                                            </div>\n                                            <button onClick={() => setReplyToId(null)} className=\"p-1 hover:bg-slate-200 rounded-full text-slate-400\">\n                                                <X size={16} />\n                                            </button>\n                                        </div>\n                                    )}\n\n                                    {/* Attachment Preview Area */}\n                                    {attachment && (\n                                        <div className=\"mb-4 flex items-center gap-3 p-2 bg-slate-50 rounded-xl border border-slate-200\">\n                                            {attachment.type === 'image' ? (\n                                                <img src={attachment.url} alt=\"preview\" className=\"w-12 h-12 rounded-lg object-cover\" />\n                                            ) : (\n                                                <div className=\"w-12 h-12 bg-white rounded-lg flex items-center justify-center text-blue-500\">\n                                                    <FileText size={24} />\n                                                </div>\n                                            )}\n                                            <div className=\"flex-1 min-w-0\">\n                                                <p className=\"text-sm font-bold truncate text-slate-700\">{attachment.name}</p>\n                                                <p className=\"text-xs text-slate-400\">{attachment.size}</p>\n                                            </div>\n                                            <button onClick={() => setAttachment(null)} className=\"p-1 hover:bg-slate-200 rounded-full text-slate-500\">\n                                                <X size={16} />\n                                            </button>\n                                        </div>\n                                    )}\n\n                                    <div className=\"flex gap-2 items-end max-w-4xl mx-auto\">\n                                        <input\n                                            type=\"file\"\n                                            ref={fileInputRef}\n                                            onChange={handleFileSelect}\n                                            className=\"hidden\"\n                                            accept=\"image/*,.pdf,.doc,.docx\"\n                                        />\n                                        <button\n                                            onClick={() => fileInputRef.current?.click()}\n                                            className=\"p-3 text-slate-400 hover:bg-slate-100 rounded-xl transition-colors hidden md:block\"\n                                        >\n                                            <Paperclip size={20} />\n                                        </button>\n                                        <div className=\"flex-1 bg-slate-100 rounded-2xl p-1 flex items-center\">\n                                            <textarea\n                                                value={inputText}\n                                                onChange={(e) => setInputText(e.target.value)}\n                                                onKeyDown={(e) => {\n                                                    if (e.key === 'Enter' && (e.metaKey || e.ctrlKey)) {\n                                                        e.preventDefault();\n                                                        handleSend();\n                                                    }\n                                                }}\n                                                placeholder=\"メッセージを入力...\"\n                                                rows={1}\n                                                className=\"w-full bg-transparent border-none focus:ring-0 resize-none text-sm font-medium p-2 max-h-32 text-slate-800 placeholder:text-slate-400 outline-none leading-relaxed\"\n                                            />\n                                        </div>\n                                        <button\n                                            onClick={handleSend}\n                                            className=\"p-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors shadow-lg shadow-blue-200\"\n                                        >\n                                            <Send size={20} />\n                                        </button>\n                                    </div>\n                                </div>\n                            </>\n                        );\n                    })()\n                ) : (\n                    <div className=\"hidden md:flex flex-1 flex-col items-center justify-center text-slate-400 space-y-4\">\n                        <div className=\"w-20 h-20 bg-slate-100 rounded-full flex items-center justify-center\">\n                            <MessageSquare className=\"w-8 h-8 text-slate-300\" />\n                        </div>\n                        <p className=\"font-bold\">チャットを選択して会話を始めましょう</p>\n                    </div>\n                )}\n            </div>\n\n            {/* Context Menu Portal/Overlay */}\n            {contextMenu && (\n                <div\n                    className=\"fixed z-50 bg-white rounded-xl shadow-xl border border-slate-100 py-1 w-56 animate-in fade-in zoom-in-95 duration-100\"\n                    style={{ top: contextMenu.y, left: contextMenu.x }}\n                    ref={contextMenuRef}\n                >\n                    <button\n                        onClick={() => handleReply(contextMenu.messageId)}\n                        className=\"w-full text-left px-4 py-2 hover:bg-slate-50 text-slate-700 text-sm font-bold flex items-center gap-2\"\n                    >\n                        <Reply size={16} /> 返信\n                    </button>\n                    <button\n                        onClick={handlePartialCopy}\n                        className=\"w-full text-left px-4 py-2 hover:bg-slate-50 text-slate-700 text-sm font-bold flex items-center gap-2\"\n                    >\n                        <FileText size={16} /> 部分コピー\n                    </button>\n                    <button\n                        onClick={() => handleCopy(selectedChat?.messages.find(m => m.id === contextMenu.messageId)?.text || '')}\n                        className=\"w-full text-left px-4 py-2 hover:bg-slate-50 text-slate-700 text-sm font-bold flex items-center gap-2\"\n                    >\n                        <Copy size={16} /> 全文コピー\n                    </button>\n                    <div className=\"h-px bg-slate-100 my-1\"></div>\n                    {contextMenu.isMe && (\n                        <button\n                            onClick={() => deleteMsg(contextMenu.messageId)}\n                            className=\"w-full text-left px-4 py-2 hover:bg-red-50 text-red-600 text-sm font-bold flex items-center gap-2\"\n                        >\n                            <RotateCcw size={16} /> 送信取り消し\n                        </button>\n                    )}\n                </div>\n            )}\n\n            {/* Partial Copy Overlay */}\n            {partialCopyText && (\n                <div className=\"fixed inset-0 z-[60] bg-black/80 flex items-center justify-center p-4 animate-in fade-in duration-200\" onClick={() => setPartialCopyText(null)}>\n                    <div className=\"bg-white rounded-2xl p-6 max-w-lg w-full shadow-2xl space-y-4\" onClick={e => e.stopPropagation()}>\n                        <div className=\"flex justify-between items-center border-b border-slate-100 pb-2\">\n                            <h3 className=\"font-bold text-slate-800\">テキスト選択</h3>\n                            <button onClick={() => setPartialCopyText(null)} className=\"p-1 hover:bg-slate-100 rounded-full text-slate-500\">\n                                <X size={20} />\n                            </button>\n                        </div>\n                        <div className=\"bg-slate-50 p-4 rounded-xl text-slate-800 text-lg leading-relaxed select-text font-medium max-h-[60vh] overflow-y-auto\">\n                            {partialCopyText}\n                        </div>\n                        <div className=\"text-center text-xs text-slate-400 font-bold\">\n                            テキストを選択してコピーしてください\n                        </div>\n                    </div>\n                </div>\n            )}\n\n            {selectedChat && (\n                <ChatDetailModal\n                    isOpen={showDetailModal}\n                    onClose={() => setShowDetailModal(false)}\n                    chatId={selectedChat.id}\n                    partnerName={getChatPartner(selectedChat).name}\n                    partnerImage={getChatPartner(selectedChat).image}\n                    partnerId={activeRole === 'seeker' ? selectedChat.companyId : selectedChat.userId}\n                    isCompany={activeRole === 'seeker'}\n                    partnerData={activeRole === 'seeker'\n                        ? companies.find(c => c.id === selectedChat.companyId)\n                        : users.find(u => u.id === selectedChat.userId)\n                    }\n                />\n            )}\n\n            {mode === 'fullscreen' && <MobileBottomNav />}\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/debug/DebugAccountSwitcher.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'RefreshCw' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":19,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"RefreshCw"},"fix":{"range":[100,110],"text":""},"desc":"Remove unused variable \"RefreshCw\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React from 'react';\nimport { useAuth } from '@/context/AuthContext';\nimport { RefreshCw, User, Building2 } from 'lucide-react';\n\nexport default function DebugAccountSwitcher() {\n    const { role, setRole } = useAuth();\n\n    return (\n        <div className=\"fixed bottom-24 right-6 z-[9999] flex flex-col gap-2 scale-90 origin-bottom-right md:scale-100\">\n            <div className=\"bg-white/80 backdrop-blur-md border border-zinc-200 p-2 rounded-2xl shadow-2xl flex flex-col gap-1\">\n                <div className=\"px-3 py-1 text-[10px] font-black text-zinc-400 uppercase tracking-widest border-b border-zinc-100 mb-1\">\n                    Debug Mode\n                </div>\n\n                <button\n                    onClick={() => setRole('seeker')}\n                    className={`flex items-center gap-2 px-4 py-2 rounded-xl transition-all ${role === 'seeker'\n                            ? 'bg-blue-500 text-white shadow-lg shadow-blue-500/30'\n                            : 'text-zinc-500 hover:bg-zinc-100'\n                        }`}\n                >\n                    <User size={16} />\n                    <span className=\"text-xs font-bold\">求職者</span>\n                </button>\n\n                <button\n                    onClick={() => setRole('company')}\n                    className={`flex items-center gap-2 px-4 py-2 rounded-xl transition-all ${role === 'company'\n                            ? 'bg-orange-500 text-white shadow-lg shadow-orange-500/30'\n                            : 'text-zinc-500 hover:bg-zinc-100'\n                        }`}\n                >\n                    <Building2 size={16} />\n                    <span className=\"text-xs font-bold\">企業</span>\n                </button>\n\n                <div className=\"mt-1 px-3 py-1 bg-zinc-100 rounded-lg text-[10px] text-zinc-500 text-center font-bold\">\n                    Role: {role.toUpperCase()}\n                </div>\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/debug/DebugRoleSwitcher.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/game/ActionGame.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Heart' is defined but never used.","line":6,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":20,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Heart"},"fix":{"range":[192,199],"text":""},"desc":"Remove unused variable \"Heart\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertCircle' is defined but never used.","line":6,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":33,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"AlertCircle"},"fix":{"range":[199,212],"text":""},"desc":"Remove unused variable \"AlertCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'toast' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":15,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"toast"},"fix":{"range":[236,267],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { useGameStore } from '@/lib/gameStore';\nimport { Zap, Heart, AlertCircle } from 'lucide-react';\nimport { toast } from 'sonner';\n\nexport default function ActionGame() {\n    const { stats, updateStats, addExperience, advanceWeek, setGameMode } = useGameStore();\n    const [gameState, setGameState] = useState<'intro' | 'playing' | 'gameover' | 'result'>('intro');\n    const [score, setScore] = useState(0);\n    const [isJumping, setIsJumping] = useState(false);\n    const [obstacles, setObstacles] = useState<{ id: number; x: number; type: string }[]>([]);\n    const gameLoopRef = useRef<number>(undefined);\n    const lastId = useRef(0);\n\n    const jump = (e?: React.MouseEvent) => {\n        if (e) e.stopPropagation();\n        if (!isJumping && gameState === 'playing') {\n            setIsJumping(true);\n            setTimeout(() => setIsJumping(false), 600);\n        }\n    };\n\n    const startGame = () => {\n        setGameState('playing');\n        setScore(0);\n        setObstacles([]);\n        gameLoop();\n    };\n\n    const gameLoop = () => {\n        setObstacles(prev => {\n            const next = prev\n                .map(o => ({ ...o, x: o.x - 5 }))\n                .filter(o => o.x > -100);\n\n            // Add new obstacle\n            if (next.length === 0 || (next[next.length - 1].x < 700 && Math.random() < 0.02)) {\n                lastId.current++;\n                next.push({ id: lastId.current, x: 1000, type: Math.random() > 0.5 ? 'stress' : 'exam' });\n            }\n\n            // Collision check\n            const collision = next.find(o => o.x > 100 && o.x < 200 && !isJumping);\n            if (collision) {\n                setGameState('result');\n                return next;\n            }\n\n            return next;\n        });\n\n        setScore(prev => prev + 1);\n        gameLoopRef.current = requestAnimationFrame(gameLoop);\n    };\n\n    useEffect(() => {\n        if (gameState !== 'playing') {\n            if (gameLoopRef.current) cancelAnimationFrame(gameLoopRef.current);\n        }\n        return () => {\n            if (gameLoopRef.current) cancelAnimationFrame(gameLoopRef.current);\n        };\n    }, [gameState]);\n\n    const handleFinish = () => {\n        const stressRelief = Math.floor(score / 100);\n        updateStats({ stress: Math.max(0, stats.stress - stressRelief), stamina: Math.max(0, stats.stamina - 15) });\n        addExperience(Math.floor(score / 40) + 5);\n        advanceWeek();\n        setGameMode('strategy');\n    };\n\n    return (\n        <div className=\"fixed inset-0 z-[100] bg-slate-950 flex flex-col items-center justify-center p-6 overflow-hidden\" onClick={jump}>\n            {/* Environment */}\n            <div className=\"absolute inset-0 z-0 bg-gradient-to-b from-blue-900/20 to-slate-950\" />\n\n            <AnimatePresence mode=\"wait\">\n                {gameState === 'intro' && (\n                    <motion.div\n                        initial={{ opacity: 0, scale: 0.9 }}\n                        animate={{ opacity: 1, scale: 1 }}\n                        className=\"relative z-10 bg-slate-900 p-12 rounded-[4rem] text-center border border-white/10 space-y-8\"\n                    >\n                        <div className=\"w-24 h-24 bg-purple-600 rounded-3xl flex items-center justify-center mx-auto shadow-2xl\">\n                            <Zap size={48} className=\"text-white\" />\n                        </div>\n                        <div className=\"space-y-4\">\n                            <h2 className=\"text-4xl font-black text-white italic tracking-tighter\">単位回避 RUN!</h2>\n                            <p className=\"text-slate-400 font-bold\">画面タップでジャンプ！<br />迫りくる単位の追撃から逃げ切れ！</p>\n                        </div>\n                        <button\n                            onClick={(e) => { e.stopPropagation(); startGame(); }}\n                            className=\"w-full bg-purple-600 hover:bg-purple-500 text-white font-black py-6 rounded-[2.5rem] transition-all shadow-xl\"\n                        >\n                            RUN START!\n                        </button>\n                    </motion.div>\n                )}\n\n                {gameState === 'playing' && (\n                    <div className=\"w-full max-w-4xl h-96 relative border-b-4 border-white/20\">\n                        {/* Score */}\n                        <div className=\"absolute top-0 right-0 text-4xl font-black text-white italic\">\n                            {score}m\n                        </div>\n\n                        {/* Player */}\n                        <motion.div\n                            animate={{ y: isJumping ? -150 : 0 }}\n                            transition={{ duration: 0.3, ease: \"easeOut\" }}\n                            className=\"absolute bottom-0 left-[150px] w-20 h-24 flex items-center justify-center\"\n                        >\n                            <div className=\"text-6xl\">🏃</div>\n                        </motion.div>\n\n                        {/* Obstacles */}\n                        {obstacles.map(o => (\n                            <div\n                                key={o.id}\n                                style={{ transform: `translateX(${o.x}px)` }}\n                                className=\"absolute bottom-2 w-16 h-16 flex items-center justify-center text-5xl\"\n                            >\n                                {o.type === 'stress' ? '😰' : '📄'}\n                            </div>\n                        ))}\n                    </div>\n                )}\n\n                {gameState === 'result' && (\n                    <motion.div\n                        initial={{ opacity: 0, scale: 0.9 }}\n                        animate={{ opacity: 1, scale: 1 }}\n                        className=\"relative z-10 bg-slate-900 p-12 rounded-[4rem] text-center border border-white/10 space-y-10\"\n                    >\n                        <div className=\"space-y-4\">\n                            <h2 className=\"text-3xl font-black text-white\">RECORDS</h2>\n                            <div className=\"text-7xl font-black text-purple-500\">{score}m</div>\n                        </div>\n\n                        <div className=\"grid grid-cols-2 gap-4\">\n                            <div className=\"bg-white/5 p-6 rounded-3xl border border-white/5\">\n                                <div className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-1\">ストレス解消</div>\n                                <div className=\"text-2xl font-black text-emerald-400\">-{Math.floor(score / 100)}%</div>\n                            </div>\n                            <div className=\"bg-white/5 p-6 rounded-3xl border border-white/5\">\n                                <div className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-1\">経験値</div>\n                                <div className=\"text-2xl font-black text-blue-400\">+{Math.floor(score / 50)} EXP</div>\n                            </div>\n                        </div>\n\n                        <button\n                            onClick={(e) => { e.stopPropagation(); handleFinish(); }}\n                            className=\"w-full bg-purple-600 hover:bg-purple-500 text-white font-black py-6 rounded-[2.5rem] transition-all shadow-xl\"\n                        >\n                            リザルトを確認\n                        </button>\n                    </motion.div>\n                )}\n            </AnimatePresence>\n\n            {gameState === 'playing' && (\n                <div className=\"mt-20 text-white/20 font-black animate-pulse uppercase tracking-[0.5em]\">\n                    Tap anywhere to JUMP!\n                </div>\n            )}\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/game/ActionMenuPart.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Zap' is defined but never used.","line":6,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":35,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Zap"},"fix":{"range":[217,222],"text":""},"desc":"Remove unused variable \"Zap\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendingUp' is defined but never used.","line":6,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":47,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"TrendingUp"},"fix":{"range":[222,234],"text":""},"desc":"Remove unused variable \"TrendingUp\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { useGameStore, type GameStats } from '@/lib/gameStore';\nimport { Sparkles, ArrowRight, Zap, TrendingUp, Search, Users, Briefcase, Coffee, UserCircle } from 'lucide-react';\nimport Image from 'next/image';\n\ninterface ActionDescription {\n    title: string;\n    icon: React.ReactNode;\n    color: string;\n    bg: string;\n    stats: Partial<GameStats>;\n    message: string;\n}\n\nconst ACTION_DESCRIPTIONS: Record<string, ActionDescription> = {\n    research: {\n        title: '企業研究',\n        icon: <Search size={40} />,\n        color: 'bg-indigo-600',\n        bg: '/game/bg/library.png',\n        stats: { skill: 5, knowledge: 3, stamina: -20, stress: 10 },\n        message: '愛媛の企業の強みや文化について理解を深めました！'\n    },\n    interview: {\n        title: '模擬面接',\n        icon: <Users size={40} />,\n        color: 'bg-orange-600',\n        bg: '/game/bg/office.png',\n        stats: { adaptability: 5, charm: 3, stamina: -25, stress: 15 },\n        message: 'みかん先輩との練習で、受け答えに自信がつきました！'\n    },\n    intern: {\n        title: '短期インターン',\n        icon: <Briefcase size={40} />,\n        color: 'bg-purple-600',\n        bg: '/game/bg/office_modern.png',\n        stats: { skill: 10, adaptability: 5, stamina: -50, stress: 30 },\n        message: '実際に現場を体験し、プロのスキルを肌で感じました。'\n    },\n    analyze: {\n        title: '自己分析',\n        icon: <UserCircle size={40} />,\n        color: 'bg-orange-400',\n        bg: '/game/bg/room.png',\n        stats: { adaptability: 3, skill: 2, stress: -5, stamina: -15 },\n        message: '自分の「本当の強み」が少しずつ見えてきました。'\n    },\n    rest: {\n        title: '休息',\n        icon: <Coffee size={40} />,\n        color: 'bg-white text-slate-900',\n        bg: '/game/bg/cafe.png',\n        stats: { stamina: 40, stress: -20 },\n        message: 'ゆっくり休んで、心身ともにリフレッシュしました！'\n    }\n};\n\nexport default function ActionMenuPart() {\n    const { currentActionType, updateStats, advanceWeek, addExperience, setGameMode, setActionType } = useGameStore();\n    const [phase, setPhase] = useState<'anim' | 'result'>('anim');\n    const action = currentActionType ? ACTION_DESCRIPTIONS[currentActionType] : null;\n\n    useEffect(() => {\n        if (!action) {\n            setGameMode('strategy');\n            return;\n        }\n\n        const timer = setTimeout(() => {\n            setPhase('result');\n            // Update stats when entering result phase\n            updateStats(action.stats);\n            addExperience(20);\n            advanceWeek();\n        }, 2000);\n\n        return () => clearTimeout(timer);\n    }, [action, currentActionType, updateStats, addExperience, advanceWeek, setGameMode]);\n\n    if (!action) return null;\n\n    const handleFinish = () => {\n        setActionType(null);\n        setGameMode('strategy');\n    };\n\n    return (\n        <div className=\"fixed inset-0 z-[100] bg-slate-950 flex flex-col items-center justify-center p-6 select-none\">\n            {/* Background */}\n            <AnimatePresence mode=\"wait\">\n                <motion.div\n                    key={action.bg}\n                    initial={{ opacity: 0 }}\n                    animate={{ opacity: 0.4 }}\n                    className=\"absolute inset-0 z-0\"\n                >\n                    <Image src={action.bg} alt=\"bg\" fill className=\"object-cover blur-[2px]\" />\n                </motion.div>\n            </AnimatePresence>\n            <div className=\"absolute inset-0 bg-gradient-to-b from-slate-950/60 to-slate-950 z-0\" />\n\n            <AnimatePresence mode=\"wait\">\n                {phase === 'anim' ? (\n                    <motion.div\n                        key=\"anim\"\n                        initial={{ opacity: 0, scale: 0.8 }}\n                        animate={{ opacity: 1, scale: 1 }}\n                        exit={{ opacity: 0, scale: 1.1 }}\n                        className=\"relative z-10 text-center space-y-8\"\n                    >\n                        <motion.div\n                            animate={{\n                                scale: [1, 1.2, 1],\n                                rotate: [0, 5, -5, 0]\n                            }}\n                            transition={{ repeat: Infinity, duration: 2 }}\n                            className={`${action.color} w-32 h-32 rounded-[2.5rem] flex items-center justify-center mx-auto shadow-2xl relative`}\n                        >\n                            {action.icon}\n                            <motion.div\n                                animate={{ opacity: [0, 1, 0], scale: [0.8, 1.5, 0.8] }}\n                                transition={{ repeat: Infinity, duration: 1.5 }}\n                                className=\"absolute inset-0 rounded-[2.5rem] bg-white/20\"\n                            />\n                        </motion.div>\n                        <div className=\"space-y-2\">\n                            <h2 className=\"text-4xl font-black text-white italic tracking-tighter\">{action.title}中...</h2>\n                            <p className=\"text-slate-400 font-bold uppercase tracking-[0.4em] text-xs\">Processing Strategy</p>\n                        </div>\n                    </motion.div>\n                ) : (\n                    <motion.div\n                        key=\"result\"\n                        initial={{ opacity: 0, y: 40 }}\n                        animate={{ opacity: 1, y: 0 }}\n                        className=\"relative z-10 bg-slate-900/80 backdrop-blur-3xl p-10 md:p-12 rounded-[4rem] border border-white/10 text-center max-w-lg w-full space-y-10 shadow-2xl\"\n                    >\n                        <div className=\"inline-flex items-center gap-2 bg-blue-600 text-white px-5 py-2 rounded-full text-xs font-black tracking-widest uppercase mb-2\">\n                            <Sparkles size={14} /> Result\n                        </div>\n\n                        <div className=\"space-y-4\">\n                            <h2 className=\"text-4xl font-black text-white\">{action.title} 完了！</h2>\n                            <p className=\"text-slate-300 font-bold\">{action.message}</p>\n                        </div>\n\n                        <div className=\"grid grid-cols-2 gap-4\">\n                            {Object.entries(action.stats).map(([key, val]) => {\n                                if (!val || val === 0) return null;\n                                const numVal = val as number;\n                                const isPositive = numVal > 0;\n                                const labels: Record<string, string> = {\n                                    knowledge: '知識', skill: '技術', adaptability: '対応力',\n                                    charm: '魅力', stamina: '体力', stress: 'ストレス', money: '所持金',\n                                    patience: '忍耐', experience: '経験値', level: 'レベル'\n                                };\n                                const label = labels[key] || key;\n\n                                return (\n                                    <div key={key} className=\"bg-white/5 p-4 rounded-3xl border border-white/5 flex flex-col items-center justify-center\">\n                                        <div className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-1\">{label as string}</div>\n                                        <div className={`text-xl font-black ${isPositive ? 'text-emerald-400' : 'text-red-400'}`}>\n                                            {isPositive ? `+${numVal}` : numVal}\n                                        </div>\n                                    </div>\n                                );\n                            })}\n                            <div className=\"bg-white/5 p-4 rounded-3xl border border-white/5 flex flex-col items-center justify-center\">\n                                <div className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-1\">経験値</div>\n                                <div className=\"text-xl font-black text-blue-400\">+20 EXP</div>\n                            </div>\n                        </div>\n\n                        <button\n                            onClick={handleFinish}\n                            className=\"w-full bg-white text-slate-950 font-black py-6 rounded-[2.5rem] flex items-center justify-center gap-3 transition-all hover:bg-blue-50 active:scale-95 shadow-xl text-xl\"\n                        >\n                            戦略画面へ戻る <ArrowRight size={22} />\n                        </button>\n                    </motion.div>\n                )}\n            </AnimatePresence>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/game/NovelPart.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'playerGender' is assigned a value but never used.","line":11,"column":77,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":89},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/game/NovelPart.tsx:19:13\n  17 |     useEffect(() => {\n  18 |         if (step?.bg) {\n> 19 |             setLastBg(step.bg);\n     |             ^^^^^^^^^ Avoid calling setState() directly within an effect\n  20 |         }\n  21 |     }, [step?.bg]);\n  22 |","line":19,"column":13,"nodeType":null,"endLine":19,"endColumn":22},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":37,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":37,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1282,1285],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1282,1285],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'i' is defined but never used.","line":85,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":85,"endColumn":43}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { useGameStore } from '@/lib/gameStore';\nimport { SCENARIOS } from '@/lib/gameScenarios';\nimport { ArrowRight, ChevronRight } from 'lucide-react';\nimport Image from 'next/image';\n\nexport default function NovelPart() {\n    const { currentScenarioId, scenarioIndex, setScenarioIndex, playerName, playerGender, updateStats, setPlayerGender, setGameMode } = useGameStore();\n    const [lastBg, setLastBg] = useState<string | null>(null);\n\n    const scenario = currentScenarioId ? SCENARIOS[currentScenarioId] : null;\n    const step = scenario ? scenario[scenarioIndex] : null;\n\n    useEffect(() => {\n        if (step?.bg) {\n            setLastBg(step.bg);\n        }\n    }, [step?.bg]);\n\n    if (!scenario || !step) return null;\n\n    const handleNext = () => {\n        if (step.choices) return; // Wait for choice\n\n        if (scenarioIndex < scenario.length - 1) {\n            setScenarioIndex(scenarioIndex + 1);\n            const nextStep = scenario[scenarioIndex + 1];\n            if (nextStep.onEnter) {\n                nextStep.onEnter!({ updateStats, setPlayerGender, setGameMode });\n            }\n        }\n    };\n\n    const handleChoice = (choice: any) => {\n        if (choice.action) {\n            choice.action({ updateStats, setPlayerGender, setGameMode });\n        }\n        if (choice.targetIndex !== undefined) {\n            setScenarioIndex(choice.targetIndex);\n        } else if (scenarioIndex < scenario.length - 1) {\n            setScenarioIndex(scenarioIndex + 1);\n            const nextStep = scenario[scenarioIndex + 1];\n            if (nextStep.onEnter) {\n                nextStep.onEnter!({ updateStats, setPlayerGender, setGameMode });\n            }\n        }\n    };\n\n    // Auto-replace placeholders like {name}\n    const processedText = step.text.replace('{name}', playerName);\n\n    return (\n        <div className=\"fixed inset-0 z-[100] bg-slate-950 overflow-hidden select-none cursor-pointer\" onClick={handleNext}>\n            {/* Background Layer */}\n            <AnimatePresence mode=\"wait\">\n                {lastBg && (\n                    <motion.div\n                        key={lastBg}\n                        initial={{ opacity: 0, scale: 1.05 }}\n                        animate={{ opacity: 1, scale: 1 }}\n                        exit={{ opacity: 0 }}\n                        transition={{ duration: 0.8 }}\n                        className=\"absolute inset-0 z-0\"\n                    >\n                        <Image\n                            src={lastBg}\n                            alt=\"background\"\n                            fill\n                            className=\"object-cover\"\n                            priority\n                        />\n                        {/* Vignette & Gradient Overlay */}\n                        <div className=\"absolute inset-0 bg-gradient-to-t from-slate-950/80 via-transparent to-transparent\" />\n                        <div className=\"absolute inset-0 shadow-[inset_0_0_150px_rgba(0,0,0,0.6)]\" />\n                    </motion.div>\n                )}\n            </AnimatePresence>\n\n            {/* Characters Layer */}\n            <div className=\"absolute inset-x-0 bottom-0 top-0 z-10 flex items-end justify-center pointer-events-none px-4 md:px-20 lg:px-40\">\n                <AnimatePresence>\n                    {step.chara?.map((c, i) => (\n                        <motion.div\n                            key={`${c.name}-${c.image}`}\n                            initial={{ opacity: 0, y: 30, x: c.side === 'left' ? -100 : c.side === 'right' ? 100 : 0 }}\n                            animate={{\n                                opacity: 1,\n                                y: 0,\n                                x: c.side === 'left' ? -50 : c.side === 'right' ? 50 : 0,\n                                scale: 1\n                            }}\n                            exit={{ opacity: 0, y: 30 }}\n                            transition={{ type: 'spring', damping: 25, stiffness: 120 }}\n                            className=\"relative w-full max-w-[500px] lg:max-w-[700px] h-[85%] lg:h-[95%] flex items-end drop-shadow-[0_20px_50px_rgba(0,0,0,0.5)]\"\n                        >\n                            <Image\n                                src={`/game/chara/${c.name}/${c.image}`}\n                                alt={c.name}\n                                fill\n                                className=\"object-contain object-bottom\"\n                                priority\n                            />\n                        </motion.div>\n                    ))}\n                </AnimatePresence>\n            </div>\n\n            {/* UI Layer */}\n            <div className=\"absolute inset-0 z-20 flex flex-col justify-end p-4 md:p-8 lg:p-12\">\n                {/* Choices (Centered) */}\n                <AnimatePresence>\n                    {step.choices && (\n                        <motion.div\n                            initial={{ opacity: 0, y: 20 }}\n                            animate={{ opacity: 1, y: 0 }}\n                            className=\"mb-12 space-y-4 max-w-2xl mx-auto w-full relative z-30\"\n                        >\n                            {step.choices.map((choice, i) => (\n                                <button\n                                    key={i}\n                                    onClick={(e) => {\n                                        e.stopPropagation();\n                                        handleChoice(choice);\n                                    }}\n                                    className=\"w-full bg-blue-600/90 hover:bg-blue-500 backdrop-blur-2xl text-white font-black py-4 md:py-6 px-8 rounded-3xl text-lg md:text-xl shadow-[0_20px_40px_rgba(0,0,0,0.3)] border border-white/20 transition-all active:scale-95 flex items-center justify-between group\"\n                                >\n                                    <span className=\"flex-1 text-center\">{choice.text}</span>\n                                    <ChevronRight className=\"group-hover:translate-x-1 transition-transform opacity-50\" />\n                                </button>\n                            ))}\n                        </motion.div>\n                    )}\n                </AnimatePresence>\n\n                {/* Message Box */}\n                {!step.choices && (\n                    <motion.div\n                        initial={{ opacity: 0, y: 20 }}\n                        animate={{ opacity: 1, y: 0 }}\n                        className=\"max-w-6xl mx-auto w-full bg-slate-900/90 backdrop-blur-3xl border border-white/10 rounded-[2rem] md:rounded-[2.5rem] p-8 md:p-10 shadow-[0_30px_100px_rgba(0,0,0,0.8)] relative overflow-hidden\"\n                    >\n                        {/* Speaker Name Tag */}\n                        {step.speaker && (\n                            <div className=\"absolute top-0 left-8 md:left-12 -translate-y-1/2 bg-blue-600 px-6 md:px-10 py-2 rounded-full text-white font-black text-xs md:text-sm tracking-[0.2em] shadow-2xl skew-x-[-12deg]\">\n                                <span className=\"inline-block skew-x-[12deg]\">{step.speaker}</span>\n                            </div>\n                        )}\n\n                        {/* Text Container */}\n                        <div className=\"text-xl md:text-2xl lg:text-3xl font-bold text-slate-100 leading-[1.8] tracking-tight min-h-[4.5em] px-2\">\n                            {processedText}\n                        </div>\n\n                        {/* Next Arrow Indicator */}\n                        <div className=\"absolute bottom-6 right-8 md:right-12\">\n                            <motion.div\n                                animate={{ x: [0, 5, 0] }}\n                                transition={{ repeat: Infinity, duration: 1.5 }}\n                            >\n                                <ArrowRight size={28} className=\"text-blue-400 drop-shadow-[0_0_10px_rgba(59,130,246,0.5)]\" />\n                            </motion.div>\n                        </div>\n                    </motion.div>\n                )}\n\n                {/* Spacer to keep it off the very edge on mobile */}\n                <div className=\"h-4 md:h-8\" />\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/game/QuizPart.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle2' is defined but never used.","line":6,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":29,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CheckCircle2"},"fix":{"range":[186,200],"text":""},"desc":"Remove unused variable \"CheckCircle2\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'XCircle' is defined but never used.","line":6,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":38,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"XCircle"},"fix":{"range":[200,209],"text":""},"desc":"Remove unused variable \"XCircle\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { useGameStore } from '@/lib/gameStore';\nimport { Timer, CheckCircle2, XCircle, Trophy } from 'lucide-react';\nimport { toast } from 'sonner';\n\ninterface Question {\n    q: string;\n    c: string;\n    w1: string;\n    w2: string;\n}\n\nconst CAFE_QUESTIONS: Question[] = [\n    { q: \"お客様が来るの尊敬語は？\", c: \"お見えになる\", w1: \"参られる\", w2: \"来られる\" },\n    { q: \"資料を見るの謙譲語は？\", c: \"拝見する\", w1: \"ご覧になる\", w2: \"見させていただく\" },\n    { q: \"言うの尊敬語は？\", c: \"おっしゃる\", w1: \"申される\", w2: \"言われる\" },\n    { q: \"知っているの謙譲語は？\", c: \"存じている\", w1: \"ご存知だ\", w2: \"知っておる\" },\n    { q: \"座るの尊敬語は？\", c: \"お掛けになる\", w1: \"座られる\", w2: \"着席される\" },\n    { q: \"会社に行くの謙譲語は？\", c: \"伺う\", w1: \"参る\", w2: \"行かれる\" },\n    { q: \"見るの尊敬語は？\", c: \"ご覧になる\", w1: \"拝見する\", w2: \"見られる\" },\n    { q: \"聞くの謙譲語は？\", c: \"伺う\", w1: \"お聞きになる\", w2: \"聞かれる\" },\n    { q: \"食べるの尊敬語は？\", c: \"召し上がる\", w1: \"いただく\", w2: \"食べられる\" },\n    { q: \"するの謙譲語は？\", c: \"いたす\", w1: \"なさる\", w2: \"される\" },\n];\n\nconst STUDY_QUESTIONS: Question[] = [\n    { q: \"愛媛県の県庁所在地は？\", c: \"松山市\", w1: \"今治市\", w2: \"西条市\" },\n    { q: \"「坊つちやん」を書いた作家は？\", c: \"夏目漱石\", w1: \"正岡子規\", w2: \"森鴎外\" },\n    { q: \"日本最古の温泉と言われるのは？\", c: \"道後温泉\", w1: \"有馬温泉\", w2: \"別府温泉\" },\n    { q: \"愛媛県で生産量日本一を誇るのは？\", c: \"真珠\", w1: \"レモン\", w2: \"ブドウ\" },\n    { q: \"今治市が生産量日本一なのは？\", c: \"タオル\", w1: \"紙\", w2: \"造船\" },\n];\n\nexport default function QuizPart() {\n    const { currentActionType, updateStats, advanceWeek, addExperience, setGameMode, setActionType } = useGameStore();\n    const [step, setStep] = useState<'intro' | 'play' | 'result'>('intro');\n    const [currentIdx, setCurrentIdx] = useState(0);\n    const [score, setScore] = useState(0);\n    const [timeLeft, setTimeLeft] = useState(15);\n    const [selectedQuestions, setSelectedQuestions] = useState<Question[]>([]);\n    const [currentOptions, setCurrentOptions] = useState<string[]>([]);\n\n    const prepareQuestion = React.useCallback((q: Question) => {\n        const opts = [q.c, q.w1, q.w2].sort(() => Math.random() - 0.5);\n        setCurrentOptions(opts);\n        setTimeLeft(15);\n    }, []);\n\n    const startQuiz = () => {\n        const questionSet = currentActionType === 'study' ? STUDY_QUESTIONS : CAFE_QUESTIONS;\n        const shuffled = [...questionSet].sort(() => Math.random() - 0.5).slice(0, 5);\n        setSelectedQuestions(shuffled);\n        prepareQuestion(shuffled[0]);\n        setStep('play');\n    };\n\n    const handleAnswer = React.useCallback((ans: string) => {\n        const isCorrect = ans === selectedQuestions[currentIdx].c;\n        if (isCorrect) {\n            setScore(prev => prev + 1);\n            toast.success('正解！', { duration: 1000 });\n        } else {\n            toast.error('不正解...', { duration: 1000 });\n        }\n\n        if (currentIdx < 4) {\n            setCurrentIdx(prev => prev + 1);\n            prepareQuestion(selectedQuestions[currentIdx + 1]);\n        } else {\n            setStep('result');\n        }\n    }, [selectedQuestions, currentIdx, prepareQuestion]);\n\n    useEffect(() => {\n        if (step === 'play') {\n            const timer = setInterval(() => {\n                setTimeLeft((prev) => {\n                    if (prev <= 1) {\n                        handleAnswer(''); // Timeout\n                        return 15;\n                    }\n                    return prev - 1;\n                });\n            }, 1000);\n            return () => clearInterval(timer);\n        }\n    }, [step, currentIdx, handleAnswer]);\n\n    const handleFinish = () => {\n        if (currentActionType === 'study') {\n            const know = score * 3 + 2;\n            updateStats({ knowledge: useGameStore.getState().stats.knowledge + know, stamina: useGameStore.getState().stats.stamina - 15 });\n        } else {\n            const pay = score * 1200 + 1000;\n            updateStats({ money: useGameStore.getState().stats.money + pay, stamina: useGameStore.getState().stats.stamina - 30, stress: useGameStore.getState().stats.stress + 10 });\n        }\n        addExperience(score * 20 + 10);\n        advanceWeek();\n        setActionType(null);\n        setGameMode('strategy');\n    };\n\n    return (\n        <div className=\"fixed inset-0 z-[100] bg-slate-950 flex items-center justify-center p-6\">\n            <AnimatePresence mode=\"wait\">\n                {step === 'intro' && (\n                    <motion.div\n                        initial={{ opacity: 0, scale: 0.9 }}\n                        animate={{ opacity: 1, scale: 1 }}\n                        exit={{ opacity: 0, scale: 1.1 }}\n                        className=\"bg-slate-900 p-10 rounded-[3rem] border border-white/10 text-center max-w-md w-full space-y-8\"\n                    >\n                        <div className=\"w-20 h-20 bg-orange-500 rounded-3xl flex items-center justify-center mx-auto shadow-2xl\">\n                            <Trophy size={40} className=\"text-white\" />\n                        </div>\n                        <div className=\"space-y-4\">\n                            <h2 className=\"text-3xl font-black text-white\">{currentActionType === 'study' ? '読書する' : 'カフェのアルバイト'}</h2>\n                            <p className=\"text-slate-400 font-bold\">\n                                {currentActionType === 'study'\n                                    ? '愛媛に関する知識を深めましょう！全5問です。'\n                                    : '正しい敬語を選んで、お客様を丁寧に応対しましょう！全5問です。'}\n                            </p>\n                        </div>\n                        <button\n                            onClick={startQuiz}\n                            className={`w-full ${currentActionType === 'study' ? 'bg-blue-600 hover:bg-blue-500' : 'bg-orange-600 hover:bg-orange-500'} text-white font-black py-5 rounded-3xl transition-all`}\n                        >\n                            {currentActionType === 'study' ? '読書開始' : 'アルバイト開始'}\n                        </button>\n                    </motion.div>\n                )}\n\n                {step === 'play' && (\n                    <motion.div\n                        key={currentIdx}\n                        initial={{ opacity: 0, x: 50 }}\n                        animate={{ opacity: 1, x: 0 }}\n                        exit={{ opacity: 0, x: -50 }}\n                        className=\"max-w-2xl w-full space-y-8\"\n                    >\n                        <div className=\"flex items-center justify-between\">\n                            <div className=\"bg-white/10 px-6 py-2 rounded-full text-white font-black\">\n                                Question {currentIdx + 1} / 5\n                            </div>\n                            <div className=\"flex items-center gap-2 bg-red-500/20 px-6 py-2 rounded-full text-red-500 font-black border border-red-500/20\">\n                                <Timer size={20} />\n                                <span>{timeLeft}s</span>\n                            </div>\n                        </div>\n\n                        <div className=\"bg-slate-900 p-12 rounded-[3rem] border border-white/10 shadow-2xl\">\n                            <h3 className=\"text-2xl font-black text-white text-center leading-relaxed\">\n                                {selectedQuestions[currentIdx].q}\n                            </h3>\n                        </div>\n\n                        <div className=\"grid grid-cols-1 gap-4\">\n                            {currentOptions.map((opt, i) => (\n                                <button\n                                    key={i}\n                                    onClick={() => handleAnswer(opt)}\n                                    className=\"bg-slate-800 hover:bg-blue-600 p-6 rounded-[2rem] text-white font-black text-xl transition-all border border-white/5 hover:border-blue-400 active:scale-95\"\n                                >\n                                    {opt}\n                                </button>\n                            ))}\n                        </div>\n                    </motion.div>\n                )}\n\n                {step === 'result' && (\n                    <motion.div\n                        initial={{ opacity: 0, scale: 0.9 }}\n                        animate={{ opacity: 1, scale: 1 }}\n                        className=\"bg-slate-900 p-12 rounded-[4rem] border border-white/10 text-center max-w-lg w-full space-y-10\"\n                    >\n                        <div className=\"space-y-4\">\n                            <h2 className=\"text-5xl font-black text-white italic\">RESULT</h2>\n                            <div className=\"text-8xl font-black text-blue-500\">{score} <span className=\"text-2xl text-slate-500\">/ 5</span></div>\n                        </div>\n\n                        <div className=\"grid grid-cols-2 gap-4\">\n                            <div className=\"bg-white/5 p-6 rounded-3xl border border-white/5\">\n                                <div className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-1\">\n                                    {currentActionType === 'study' ? '知識' : '報酬'}\n                                </div>\n                                <div className={`text-2xl font-black ${currentActionType === 'study' ? 'text-blue-400' : 'text-emerald-400'}`}>\n                                    {currentActionType === 'study' ? `+${score * 3 + 2}` : `+${score * 1200 + 1000}円`}\n                                </div>\n                            </div>\n                            <div className=\"bg-white/5 p-6 rounded-3xl border border-white/5\">\n                                <div className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-1\">経験値</div>\n                                <div className=\"text-2xl font-black text-blue-400\">+{score * 20 + 10} EXP</div>\n                            </div>\n                        </div>\n\n                        <button\n                            onClick={handleFinish}\n                            className=\"w-full bg-blue-600 hover:bg-blue-500 text-white font-black py-6 rounded-[2rem] transition-all shadow-2xl shadow-blue-600/20\"\n                        >\n                            戦略画面へ戻る\n                        </button>\n                    </motion.div>\n                )}\n            </AnimatePresence>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/jobs/JobPostForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Plus' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Plus"},"fix":{"range":[105,110],"text":""},"desc":"Remove unused variable \"Plus\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Trash2' is defined but never used.","line":5,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":29,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Trash2"},"fix":{"range":[116,124],"text":""},"desc":"Remove unused variable \"Trash2\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle' is defined but never used.","line":5,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":42,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CheckCircle"},"fix":{"range":[124,137],"text":""},"desc":"Remove unused variable \"CheckCircle\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState } from 'react';\nimport { motion } from 'framer-motion';\nimport { Plus, Video, Trash2, CheckCircle } from 'lucide-react';\n\nexport default function JobPostForm() {\n    const [step, setStep] = useState(1);\n\n    return (\n        <div className=\"max-w-4xl mx-auto p-6 bg-white dark:bg-zinc-900 rounded-3xl shadow-2xl border border-zinc-200 dark:border-zinc-800\">\n            <div className=\"mb-8\">\n                <h2 className=\"text-3xl font-bold text-zinc-900 dark:text-zinc-100\">求人をクエストとして公開する</h2>\n                <p className=\"text-zinc-500 dark:text-zinc-400 mt-2\">あなたの会社の「歪み」を愛してくれる冒険者を探しましょう。</p>\n            </div>\n\n            {/* ステップナビゲーション */}\n            <div className=\"flex gap-4 mb-10\">\n                {[1, 2, 3].map((s) => (\n                    <div\n                        key={s}\n                        className={`h-1 flex-1 rounded-full transition-all duration-500 ${step >= s ? 'bg-orange-500' : 'bg-zinc-200 dark:bg-zinc-700'\n                            }`}\n                    />\n                ))}\n            </div>\n\n            <form className=\"space-y-8\">\n                {step === 1 && (\n                    <motion.div\n                        initial={{ opacity: 0, x: 20 }}\n                        animate={{ opacity: 1, x: 0 }}\n                        className=\"space-y-6\"\n                    >\n                        <div>\n                            <label className=\"block text-sm font-medium mb-2\">求人タイトル（クエスト名）</label>\n                            <input\n                                type=\"text\"\n                                className=\"w-full p-4 rounded-xl bg-zinc-50 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 focus:ring-2 focus:ring-orange-500 outline-none\"\n                                placeholder=\"例：歴史ある老舗のデジタルトランスフォーメーションを担う\"\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium mb-2\">求人カテゴリ</label>\n                            <select className=\"w-full p-4 rounded-xl bg-zinc-50 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 outline-none\">\n                                <option>中途採用</option>\n                                <option>新卒採用</option>\n                                <option>体験JOB（お試しワーク）</option>\n                                <option>インターンシップ</option>\n                                <option>アルバイト</option>\n                            </select>\n                        </div>\n                    </motion.div>\n                )}\n\n                {step === 2 && (\n                    <motion.div\n                        initial={{ opacity: 0, x: 20 }}\n                        animate={{ opacity: 1, x: 0 }}\n                        className=\"space-y-6\"\n                    >\n                        <div className=\"p-6 bg-orange-50 dark:bg-orange-950/20 rounded-2xl border border-orange-100 dark:border-orange-900/50\">\n                            <h3 className=\"font-bold text-orange-800 dark:text-orange-400 mb-2 underline declaration-orange-500\">RJP：現実的な仕事の事前提示</h3>\n                            <p className=\"text-sm text-orange-700 dark:text-orange-300\">\n                                あえて「自社の不完全な部分」を伝えてください。それが最高の誠実さになり、相性抜群の人が集まるための魔法になります。\n                            </p>\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium mb-2\">私たちの「歪み」（都合の悪い真実）</label>\n                            <textarea\n                                className=\"w-full p-4 h-32 rounded-xl bg-zinc-50 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 focus:ring-2 focus:ring-orange-500 outline-none\"\n                                placeholder=\"例：正直、残業は月20時間ほどあります。また、古い慣習が残っており、システム化されていない部分も多いです。\"\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium mb-2\">それをどう魅力に変えてほしいか</label>\n                            <textarea\n                                className=\"w-full p-4 h-32 rounded-xl bg-zinc-50 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 focus:ring-2 focus:ring-orange-500 outline-none\"\n                                placeholder=\"例：そのカオスな状況を楽しめる方に、自由な発想で改革をリードしてほしいです。\"\n                            />\n                        </div>\n                    </motion.div>\n                )}\n\n                {step === 3 && (\n                    <motion.div\n                        initial={{ opacity: 0, x: 20 }}\n                        animate={{ opacity: 1, x: 0 }}\n                        className=\"space-y-6\"\n                    >\n                        <div className=\"border-2 border-dashed border-zinc-300 dark:border-zinc-700 rounded-3xl p-12 text-center group hover:border-orange-500 transition-colors cursor-pointer\">\n                            <div className=\"bg-zinc-100 dark:bg-zinc-800 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform\">\n                                <Video className=\"text-zinc-500 group-hover:text-orange-500\" />\n                            </div>\n                            <p className=\"font-medium text-lg\">リール用ショート動画をアップロード</p>\n                            <p className=\"text-zinc-500 mt-2 text-sm\">またはファイルをドラッグ＆ドロップ</p>\n                        </div>\n                    </motion.div>\n                )}\n\n                <div className=\"flex justify-between pt-6\">\n                    {step > 1 && (\n                        <button\n                            type=\"button\"\n                            onClick={() => setStep(step - 1)}\n                            className=\"px-8 py-3 rounded-xl font-medium text-zinc-600 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors\"\n                        >\n                            戻る\n                        </button>\n                    )}\n                    <button\n                        type=\"button\"\n                        onClick={() => step < 3 ? setStep(step + 1) : alert('公開申請しました！')}\n                        className=\"ml-auto px-10 py-3 rounded-xl bg-orange-500 hover:bg-orange-600 text-white font-bold shadow-lg shadow-orange-500/30 transition-all hover:scale-105\"\n                    >\n                        {step === 3 ? 'クエストを公開する' : '次へ進む'}\n                    </button>\n                </div>\n            </form>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/jobs/ReelScroller.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Info' is defined but never used.","line":5,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":44,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Info"},"fix":{"range":[150,156],"text":""},"desc":"Remove unused variable \"Info\"."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":33,"column":21,"nodeType":"JSXOpeningElement","endLine":37,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Heart, MessageCircle, Share2, Info, ChevronUp, ChevronDown, Zap } from 'lucide-react';\nimport { JOBS, COMPANIES } from '@/lib/dummyData';\n\nexport default function ReelScroller() {\n    const [index, setIndex] = useState(0);\n\n    // 体験JOBと注目の求人を表示\n    const displayJobs = JOBS.filter(j => j.isExperience || j.category === '中途' || j.category === '新卒');\n\n    const nextReel = () => index < displayJobs.length - 1 && setIndex(index + 1);\n    const prevReel = () => index > 0 && setIndex(index - 1);\n\n    const job = displayJobs[index];\n    const company = COMPANIES.find(c => c.id === job.companyId);\n\n    return (\n        <div className=\"relative w-full max-w-md h-[75vh] md:h-[80vh] mx-auto bg-black rounded-[3rem] overflow-hidden shadow-2xl border-4 border-zinc-900 mt-4 md:mt-10\">\n            <AnimatePresence mode=\"wait\">\n                <motion.div\n                    key={job.id}\n                    initial={{ y: 300, opacity: 0 }}\n                    animate={{ y: 0, opacity: 1 }}\n                    exit={{ y: -300, opacity: 0 }}\n                    transition={{ type: \"spring\", stiffness: 100, damping: 20 }}\n                    className=\"absolute inset-0 p-8 flex flex-col justify-end text-white overflow-hidden\"\n                >\n                    {/* Background Gradient & Overlay */}\n                    <div className={`absolute inset-0 opacity-60 ${company?.logoColor || 'bg-zinc-800'}`} />\n                    <img\n                        src={company?.image}\n                        alt={company?.name}\n                        className=\"absolute inset-0 w-full h-full object-cover mix-blend-overlay opacity-50\"\n                    />\n                    <div className=\"absolute inset-0 bg-gradient-to-b from-black/20 via-transparent to-black/80\" />\n\n                    <div className=\"relative z-10 space-y-4\">\n                        <div className=\"flex items-center gap-2\">\n                            <span className=\"px-3 py-1 bg-white/20 backdrop-blur-md rounded-full text-[10px] font-black ring-1 ring-white/30 uppercase tracking-wider\">\n                                {job.category}\n                            </span>\n                            {job.isExperience && (\n                                <span className=\"px-3 py-1 bg-orange-500 rounded-full text-[10px] font-black flex items-center gap-1\">\n                                    <Zap size={10} />\n                                    体験クエスト\n                                </span>\n                            )}\n                        </div>\n\n                        <div>\n                            <span className=\"text-xs font-bold text-zinc-300 tracking-wide uppercase\">\n                                {company?.name}\n                            </span>\n                            <h3 className=\"text-3xl md:text-4xl font-extrabold leading-tight mt-1 drop-shadow-lg\">\n                                {job.title}\n                            </h3>\n                        </div>\n\n                        <div className=\"bg-black/20 backdrop-blur-sm p-4 rounded-2xl border border-white/10\">\n                            <p className=\"text-white text-xs font-bold mb-1 opacity-70 underline decoration-orange-500\">\n                                あえて不完全な部分を明かします\n                            </p>\n                            <p className=\"text-zinc-100 text-[11px] leading-relaxed italic line-clamp-2\">\n                                「{company?.rjpNegatives}」\n                            </p>\n                        </div>\n\n                        <div className=\"flex items-center gap-3 pt-2\">\n                            <button className=\"flex-1 bg-white text-black font-black py-4 rounded-2xl hover:bg-zinc-200 transition-all active:scale-95 shadow-lg\">\n                                詳細を覗く\n                            </button>\n                            <button className=\"w-14 h-14 bg-white/10 backdrop-blur-md rounded-2xl flex items-center justify-center hover:bg-white/20 transition-colors\">\n                                <Heart className=\"text-white\" />\n                            </button>\n                        </div>\n                    </div>\n\n                    {/* 右側アクションエリア */}\n                    <div className=\"absolute right-4 bottom-24 flex flex-col items-center gap-6 z-10\">\n                        <div className=\"flex flex-col items-center gap-1\">\n                            <div className=\"p-3 bg-white/10 rounded-full backdrop-blur-md hover:bg-white/20 cursor-pointer\"><Share2 size={24} /></div>\n                            <span className=\"text-[10px] font-bold\">シェア</span>\n                        </div>\n                        <div className=\"flex flex-col items-center gap-1\">\n                            <div className=\"p-3 bg-white/10 rounded-full backdrop-blur-md hover:bg-white/20 cursor-pointer\"><MessageCircle size={24} /></div>\n                            <span className=\"text-[10px] font-bold\">相談する</span>\n                        </div>\n                    </div>\n                </motion.div>\n            </AnimatePresence>\n\n            {/* スワイプ制御用ボタン（本来はタッチジェスチャー） */}\n            <div className=\"absolute left-1/2 -translate-x-1/2 top-4 z-20 flex flex-col gap-2\">\n                <button onClick={prevReel} className=\"p-2 bg-black/40 rounded-full backdrop-blur-sm hover:bg-black/60\"><ChevronUp /></button>\n                <button onClick={nextReel} className=\"p-2 bg-black/40 rounded-full backdrop-blur-sm hover:bg-black/60\"><ChevronDown /></button>\n            </div>\n\n            {/* プログレスドット */}\n            <div className=\"absolute left-4 top-1/2 -translate-y-1/2 flex flex-col gap-2 z-20\">\n                {displayJobs.map((_, i) => (\n                    <div key={i} className={`w-1 h-6 rounded-full transition-all ${i === index ? 'bg-white h-10' : 'bg-white/20'}`} />\n                ))}\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/modals/ConsultModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'User' is defined but never used.","line":2,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":23,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"User"},"fix":{"range":[57,63],"text":""},"desc":"Remove unused variable \"User\"."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":62,"column":33,"nodeType":"JSXOpeningElement","endLine":66,"endColumn":35}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { X, Send, User, Pencil } from 'lucide-react';\nimport { useUserStore } from '@/lib/store';\nimport { EditProfileModal } from './EditProfileModal';\n\ninterface ConsultModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onConfirm: () => void;\n    companyName: string;\n}\n\nexport function ConsultModal({ isOpen, onClose, onConfirm, companyName }: ConsultModalProps) {\n    const { userProfile } = useUserStore();\n    const [isEditModalOpen, setIsEditModalOpen] = useState(false);\n\n    if (!isOpen) return null;\n\n    return (\n        <>\n            <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4\">\n                {/* Backdrop */}\n                <div\n                    className=\"absolute inset-0 bg-black/40 backdrop-blur-sm\"\n                    onClick={onClose}\n                />\n\n                {/* Modal Content */}\n                <div className=\"relative w-full max-w-md bg-white rounded-3xl shadow-xl overflow-hidden animate-in fade-in zoom-in duration-200\">\n                    {/* Header */}\n                    <div className=\"bg-zinc-50 border-b border-zinc-100 p-4 flex items-center justify-between\">\n                        <h3 className=\"font-bold text-zinc-800\">カジュアル面談を希望する</h3>\n                        <button\n                            onClick={onClose}\n                            className=\"p-1 hover:bg-zinc-200 rounded-full transition-colors text-zinc-400\"\n                        >\n                            <X size={20} />\n                        </button>\n                    </div>\n\n                    <div className=\"p-6 space-y-6\">\n                        <div className=\"text-center space-y-2\">\n                            <p className=\"text-zinc-600 font-bold\">\n                                {companyName}の担当者と<br />チャットを開始しますか？\n                            </p>\n                            <p className=\"text-xs text-zinc-400\">\n                                以下のプロフィール情報が担当者に共有されます。\n                            </p>\n                        </div>\n\n                        {/* Profile Preview Card */}\n                        <div className=\"bg-blue-50 border border-blue-100 rounded-xl p-4 relative group\">\n                            <button\n                                onClick={() => setIsEditModalOpen(true)}\n                                className=\"absolute top-3 right-3 p-1.5 bg-white rounded-full border border-blue-100 text-blue-500 hover:bg-blue-600 hover:text-white transition-colors shadow-sm\"\n                                title=\"プロフィールを編集\"\n                            >\n                                <Pencil size={14} />\n                            </button>\n\n                            <div className=\"flex items-center gap-4\">\n                                <img\n                                    src={userProfile.avatar}\n                                    alt={userProfile.name}\n                                    className=\"w-14 h-14 rounded-full object-cover border-2 border-white shadow-sm\"\n                                />\n                                <div className=\"flex-1 min-w-0\">\n                                    <div className=\"flex items-center gap-2\">\n                                        <span className=\"font-black text-zinc-800 text-lg\">{userProfile.name}</span>\n                                        <span className=\"text-xs font-bold text-zinc-500 bg-white px-2 py-0.5 rounded-full border border-blue-100\">\n                                            {userProfile.age}歳\n                                        </span>\n                                    </div>\n                                    <p className=\"text-xs text-zinc-500 mt-1 font-medium\">{userProfile.location}</p>\n                                    <div className=\"flex flex-wrap gap-1 mt-2\">\n                                        {userProfile.tags.map(tag => (\n                                            <span key={tag} className=\"text-[10px] bg-white text-blue-600 px-1.5 py-0.5 rounded border border-blue-100 font-bold\">\n                                                {tag}\n                                            </span>\n                                        ))}\n                                    </div>\n                                    {/* Display Bio Preview if exists */}\n                                    {userProfile.bio && (\n                                        <p className=\"text-[10px] text-zinc-400 mt-2 line-clamp-2 border-t border-blue-100/50 pt-2\">\n                                            {userProfile.bio}\n                                        </p>\n                                    )}\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Actions */}\n                        <div className=\"flex gap-3 pt-2\">\n                            <button\n                                onClick={onClose}\n                                className=\"flex-1 py-3 px-4 rounded-xl font-bold text-zinc-500 hover:bg-zinc-50 transition-colors\"\n                            >\n                                キャンセル\n                            </button>\n                            <button\n                                onClick={onConfirm}\n                                className=\"flex-1 py-3 px-4 rounded-xl font-bold bg-eis-navy text-white hover:bg-zinc-800 transition-colors flex items-center justify-center gap-2 shadow-lg shadow-zinc-200\"\n                            >\n                                <Send size={18} />\n                                カジュアル面談希望\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <EditProfileModal\n                isOpen={isEditModalOpen}\n                onClose={() => setIsEditModalOpen(false)}\n            />\n        </>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/modals/EditProfileModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":294,"column":87,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":294,"endColumn":90,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17199,17202],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17199,17202],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { X, Save, Plus } from 'lucide-react';\nimport { useUserStore, UserProfile } from '@/lib/store';\nimport { toast } from 'sonner';\n\ninterface EditProfileModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n}\n\nexport function EditProfileModal({ isOpen, onClose }: EditProfileModalProps) {\n    const { userProfile, updateUserProfile } = useUserStore();\n\n    // Local state for form\n    const [formData, setFormData] = useState<UserProfile>(userProfile);\n    const [newTag, setNewTag] = useState('');\n    const [newQual, setNewQual] = useState('');\n\n    // Skill Input State\n    const [newSkillName, setNewSkillName] = useState('');\n    const [newSkillLevel, setNewSkillLevel] = useState<'beginner' | 'intermediate' | 'advanced'>('intermediate');\n\n    // Work History Input State\n    const [newWork, setNewWork] = useState({ company: '', role: '', duration: '', description: '' });\n\n    React.useEffect(() => {\n        if (isOpen) {\n            setFormData(userProfile);\n        }\n    }, [isOpen, userProfile]);\n\n    if (!isOpen) return null;\n\n    const handleSave = () => {\n        updateUserProfile(formData);\n        toast.success('プロフィールを更新しました');\n        onClose();\n    };\n\n    const addTag = () => {\n        if (newTag.trim() && !formData.tags.includes(newTag.trim())) {\n            setFormData({ ...formData, tags: [...formData.tags, newTag.trim()] });\n            setNewTag('');\n        }\n    };\n    const removeTag = (tag: string) => setFormData({ ...formData, tags: formData.tags.filter(t => t !== tag) });\n\n    const addQual = () => {\n        if (newQual.trim() && !formData.qualifications?.includes(newQual.trim())) {\n            setFormData({ ...formData, qualifications: [...(formData.qualifications || []), newQual.trim()] });\n            setNewQual('');\n        }\n    };\n    const removeQual = (q: string) => setFormData({ ...formData, qualifications: formData.qualifications?.filter(t => t !== q) });\n\n    const addSkill = () => {\n        if (newSkillName.trim()) {\n            setFormData({\n                ...formData,\n                skills: [...(formData.skills || []), { name: newSkillName.trim(), level: newSkillLevel }]\n            });\n            setNewSkillName('');\n        }\n    };\n    const removeSkill = (index: number) => {\n        const newSkills = [...(formData.skills || [])];\n        newSkills.splice(index, 1);\n        setFormData({ ...formData, skills: newSkills });\n    };\n\n    const addWork = () => {\n        if (newWork.company.trim()) {\n            setFormData({\n                ...formData,\n                workHistory: [...(formData.workHistory || []), newWork]\n            });\n            setNewWork({ company: '', role: '', duration: '', description: '' });\n        }\n    };\n    const removeWork = (index: number) => {\n        const newHist = [...(formData.workHistory || [])];\n        newHist.splice(index, 1);\n        setFormData({ ...formData, workHistory: newHist });\n    };\n\n    return (\n        <div className=\"fixed inset-0 z-[60] flex items-center justify-center p-4\">\n            <div className=\"absolute inset-0 bg-black/40 backdrop-blur-sm\" onClick={onClose} />\n\n            <div className=\"relative w-full max-w-2xl bg-white rounded-3xl shadow-xl overflow-hidden animate-in fade-in zoom-in duration-200 flex flex-col max-h-[90vh]\">\n                <div className=\"bg-zinc-50 border-b border-zinc-100 p-4 flex items-center justify-between shrink-0\">\n                    <h3 className=\"font-bold text-zinc-800\">プロフィール編集</h3>\n                    <button onClick={onClose} className=\"p-1 hover:bg-zinc-200 rounded-full transition-colors text-zinc-400\">\n                        <X size={20} />\n                    </button>\n                </div>\n\n                <div className=\"p-6 overflow-y-auto space-y-8\">\n                    {/* Basic Info */}\n                    <section className=\"space-y-4\">\n                        <h4 className=\"font-black text-zinc-700 border-b pb-2\">基本情報</h4>\n                        <div className=\"grid grid-cols-2 gap-4\">\n                            <div>\n                                <label className=\"text-xs font-bold text-zinc-500 mb-1 block\">お名前</label>\n                                <input\n                                    type=\"text\"\n                                    value={formData.name}\n                                    onChange={e => setFormData({ ...formData, name: e.target.value })}\n                                    className=\"w-full bg-zinc-50 border border-zinc-200 rounded-xl px-3 py-2 text-sm font-bold text-zinc-800 focus:outline-none focus:border-eis-navy\"\n                                />\n                            </div>\n                            <div>\n                                <label className=\"text-xs font-bold text-zinc-500 mb-1 block\">年齢</label>\n                                <input\n                                    type=\"number\"\n                                    value={formData.age}\n                                    onChange={e => setFormData({ ...formData, age: Number(e.target.value) })}\n                                    className=\"w-full bg-zinc-50 border border-zinc-200 rounded-xl px-3 py-2 text-sm font-bold text-zinc-800 focus:outline-none focus:border-eis-navy\"\n                                />\n                            </div>\n                        </div>\n                        <div>\n                            <label className=\"text-xs font-bold text-zinc-500 mb-1 block\">居住地</label>\n                            <input\n                                type=\"text\"\n                                value={formData.location}\n                                onChange={e => setFormData({ ...formData, location: e.target.value })}\n                                className=\"w-full bg-zinc-50 border border-zinc-200 rounded-xl px-3 py-2 text-sm font-bold text-zinc-800 focus:outline-none focus:border-eis-navy\"\n                            />\n                        </div>\n                        <div>\n                            <label className=\"text-xs font-bold text-zinc-500 mb-1 block\">自己紹介</label>\n                            <textarea\n                                value={formData.bio || ''}\n                                onChange={e => setFormData({ ...formData, bio: e.target.value })}\n                                rows={3}\n                                className=\"w-full bg-zinc-50 border border-zinc-200 rounded-xl px-3 py-2 text-sm font-medium text-zinc-800 focus:outline-none focus:border-eis-navy resize-none\"\n                                placeholder=\"経歴や意気込みなどを入力してください\"\n                            />\n                        </div>\n                        <div>\n                            <label className=\"text-xs font-bold text-zinc-500 mb-1 block\">ポートフォリオURL</label>\n                            <input\n                                type=\"url\"\n                                value={formData.portfolioUrl || ''}\n                                onChange={e => setFormData({ ...formData, portfolioUrl: e.target.value })}\n                                className=\"w-full bg-zinc-50 border border-zinc-200 rounded-xl px-3 py-2 text-sm font-medium text-blue-600 focus:outline-none focus:border-eis-navy\"\n                                placeholder=\"https://...\"\n                            />\n                        </div>\n                    </section>\n\n                    {/* Education */}\n                    <section className=\"space-y-4\">\n                        <h4 className=\"font-black text-zinc-700 border-b pb-2\">学歴</h4>\n                        <div className=\"grid grid-cols-2 gap-4\">\n                            <div className=\"col-span-2\">\n                                <label className=\"text-xs font-bold text-zinc-500 mb-1 block\">学校名</label>\n                                <input\n                                    type=\"text\"\n                                    value={formData.university || ''}\n                                    onChange={e => setFormData({ ...formData, university: e.target.value })}\n                                    className=\"w-full bg-zinc-50 border border-zinc-200 rounded-xl px-3 py-2 text-sm font-bold text-zinc-800\"\n                                />\n                            </div>\n                            <div>\n                                <label className=\"text-xs font-bold text-zinc-500 mb-1 block\">学部</label>\n                                <input\n                                    type=\"text\"\n                                    value={formData.faculty || ''}\n                                    onChange={e => setFormData({ ...formData, faculty: e.target.value })}\n                                    className=\"w-full bg-zinc-50 border border-zinc-200 rounded-xl px-3 py-2 text-sm font-bold text-zinc-800\"\n                                />\n                            </div>\n                            <div>\n                                <label className=\"text-xs font-bold text-zinc-500 mb-1 block\">学科・専攻</label>\n                                <input\n                                    type=\"text\"\n                                    value={formData.department || ''}\n                                    onChange={e => setFormData({ ...formData, department: e.target.value })}\n                                    className=\"w-full bg-zinc-50 border border-zinc-200 rounded-xl px-3 py-2 text-sm font-bold text-zinc-800\"\n                                />\n                            </div>\n                            <div>\n                                <label className=\"text-xs font-bold text-zinc-500 mb-1 block\">卒業年</label>\n                                <input\n                                    type=\"text\"\n                                    value={formData.graduationYear || ''}\n                                    onChange={e => setFormData({ ...formData, graduationYear: e.target.value })}\n                                    className=\"w-full bg-zinc-50 border border-zinc-200 rounded-xl px-3 py-2 text-sm font-bold text-zinc-800\"\n                                    placeholder=\"202X年\"\n                                />\n                            </div>\n                        </div>\n                    </section>\n\n                    {/* Work History */}\n                    <section className=\"space-y-4\">\n                        <h4 className=\"font-black text-zinc-700 border-b pb-2\">職歴</h4>\n                        <div className=\"bg-zinc-50 p-4 rounded-xl border border-zinc-100 space-y-3\">\n                            <input\n                                placeholder=\"会社名\"\n                                className=\"w-full p-2 rounded-lg border border-zinc-200 text-sm\"\n                                value={newWork.company}\n                                onChange={e => setNewWork({ ...newWork, company: e.target.value })}\n                            />\n                            <div className=\"flex gap-2\">\n                                <input placeholder=\"役職\" className=\"flex-1 p-2 rounded-lg border border-zinc-200 text-sm\" value={newWork.role} onChange={e => setNewWork({ ...newWork, role: e.target.value })} />\n                                <input placeholder=\"期間\" className=\"flex-1 p-2 rounded-lg border border-zinc-200 text-sm\" value={newWork.duration} onChange={e => setNewWork({ ...newWork, duration: e.target.value })} />\n                            </div>\n                            <textarea placeholder=\"詳細\" className=\"w-full p-2 rounded-lg border border-zinc-200 text-sm\" rows={2} value={newWork.description} onChange={e => setNewWork({ ...newWork, description: e.target.value })} />\n                            <button onClick={addWork} className=\"w-full py-2 bg-zinc-800 text-white rounded-lg text-xs font-bold flex items-center justify-center gap-1\"><Plus size={14} /> 追加</button>\n                        </div>\n                        <div className=\"space-y-3\">\n                            {formData.workHistory?.map((work, idx) => (\n                                <div key={idx} className=\"relative p-3 bg-white border border-zinc-200 rounded-xl\">\n                                    <button onClick={() => removeWork(idx)} className=\"absolute top-2 right-2 text-zinc-300 hover:text-red-500\"><X size={16} /></button>\n                                    <h5 className=\"font-bold text-sm\">{work.company}</h5>\n                                    <p className=\"text-xs text-zinc-500 mb-1\">{work.duration} | {work.role}</p>\n                                    <p className=\"text-xs text-zinc-600\">{work.description}</p>\n                                </div>\n                            ))}\n                        </div>\n                    </section>\n\n                    {/* Skills & Tags */}\n                    <section className=\"space-y-4\">\n                        <h4 className=\"font-black text-zinc-700 border-b pb-2\">スキル・資格</h4>\n\n                        {/* Tags */}\n                        <div>\n                            <label className=\"text-xs font-bold text-zinc-500 mb-1 block\">アピールタグ</label>\n                            <div className=\"flex gap-2 mb-2\">\n                                <input\n                                    type=\"text\"\n                                    value={newTag}\n                                    onChange={e => setNewTag(e.target.value)}\n                                    onKeyDown={e => e.key === 'Enter' && addTag()}\n                                    className=\"flex-1 bg-zinc-50 border border-zinc-200 rounded-xl px-3 py-2 text-sm font-bold text-zinc-800 focus:outline-none focus:border-eis-navy\"\n                                    placeholder=\"新しいタグ...\"\n                                />\n                                <button onClick={addTag} className=\"p-2 bg-zinc-100 hover:bg-zinc-200 rounded-xl text-zinc-600 transition-colors\">\n                                    <Plus size={20} />\n                                </button>\n                            </div>\n                            <div className=\"flex flex-wrap gap-2\">\n                                {formData.tags.map(tag => (\n                                    <span key={tag} className=\"inline-flex items-center gap-1 bg-blue-50 text-blue-600 px-2 py-1 rounded-lg border border-blue-100 text-xs font-bold\">\n                                        {tag}\n                                        <button onClick={() => removeTag(tag)} className=\"hover:text-blue-800\"><X size={12} /></button>\n                                    </span>\n                                ))}\n                            </div>\n                        </div>\n\n                        {/* Qualifications */}\n                        <div>\n                            <label className=\"text-xs font-bold text-zinc-500 mb-1 block\">資格</label>\n                            <div className=\"flex gap-2 mb-2\">\n                                <input\n                                    type=\"text\"\n                                    value={newQual}\n                                    onChange={e => setNewQual(e.target.value)}\n                                    className=\"flex-1 bg-zinc-50 border border-zinc-200 rounded-xl px-3 py-2 text-sm font-bold text-zinc-800 focus:outline-none focus:border-eis-navy\"\n                                    placeholder=\"資格名...\"\n                                />\n                                <button onClick={addQual} className=\"p-2 bg-zinc-100 hover:bg-zinc-200 rounded-xl text-zinc-600 transition-colors\">\n                                    <Plus size={20} />\n                                </button>\n                            </div>\n                            <div className=\"flex flex-wrap gap-2\">\n                                {formData.qualifications?.map(q => (\n                                    <span key={q} className=\"inline-flex items-center gap-1 bg-emerald-50 text-emerald-600 px-2 py-1 rounded-lg border border-emerald-100 text-xs font-bold\">\n                                        {q}\n                                        <button onClick={() => removeQual(q)} className=\"hover:text-emerald-800\"><X size={12} /></button>\n                                    </span>\n                                ))}\n                            </div>\n                        </div>\n\n                        {/* Skills */}\n                        <div>\n                            <label className=\"text-xs font-bold text-zinc-500 mb-1 block\">スキル</label>\n                            <div className=\"flex gap-2 mb-2\">\n                                <input\n                                    type=\"text\"\n                                    value={newSkillName}\n                                    onChange={e => setNewSkillName(e.target.value)}\n                                    className=\"flex-1 bg-zinc-50 border border-zinc-200 rounded-xl px-3 py-2 text-sm font-bold text-zinc-800\"\n                                    placeholder=\"スキル名...\"\n                                />\n                                <select\n                                    value={newSkillLevel}\n                                    onChange={e => setNewSkillLevel(e.target.value as any)}\n                                    className=\"border border-zinc-200 rounded-xl px-2 text-xs\"\n                                >\n                                    <option value=\"beginner\">初級</option>\n                                    <option value=\"intermediate\">中級</option>\n                                    <option value=\"advanced\">上級</option>\n                                </select>\n                                <button onClick={addSkill} className=\"p-2 bg-zinc-100 hover:bg-zinc-200 rounded-xl text-zinc-600 transition-colors\">\n                                    <Plus size={20} />\n                                </button>\n                            </div>\n                            <div className=\"flex flex-wrap gap-2\">\n                                {formData.skills?.map((s, i) => (\n                                    <span key={i} className=\"inline-flex items-center gap-1 bg-orange-50 text-orange-600 px-2 py-1 rounded-lg border border-orange-100 text-xs font-bold\">\n                                        {s.name} ({s.level === 'beginner' ? '初級' : s.level === 'intermediate' ? '中級' : '上級'})\n                                        <button onClick={() => removeSkill(i)} className=\"hover:text-orange-800\"><X size={12} /></button>\n                                    </span>\n                                ))}\n                            </div>\n                        </div>\n                    </section>\n                </div>\n\n                <div className=\"p-4 border-t border-zinc-100 bg-zinc-50 shrink-0\">\n                    <button\n                        onClick={handleSave}\n                        className=\"w-full py-3 bg-eis-navy text-white rounded-xl font-bold hover:bg-zinc-800 transition-colors flex items-center justify-center gap-2 shadow-lg shadow-zinc-200\"\n                    >\n                        <Save size={18} />\n                        保存して閉じる\n                    </button>\n                </div>\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/money-simulation/DifferenceCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/money-simulation/MoneyInput.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'step' is defined but never used.","line":11,"column":84,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":88},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/money-simulation/MoneyInput.tsx:22:13\n  20 |         const numLocal = Number(localValue.replace(/,/g, ''));\n  21 |         if (numLocal !== value && localValue !== '') {\n> 22 |             setLocalValue(value === 0 ? '' : formatValue(value));\n     |             ^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  23 |         }\n  24 |     }, [value]);\n  25 |","line":22,"column":13,"nodeType":null,"endLine":22,"endColumn":26},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'localValue'. Either include it or remove the dependency array.","line":24,"column":8,"nodeType":"ArrayExpression","endLine":24,"endColumn":15,"suggestions":[{"desc":"Update the dependencies array to be: [localValue, value]","fix":{"range":[798,805],"text":"[localValue, value]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\n\ninterface Props {\n    value: number;\n    onChange: (value: number) => void;\n    className?: string; // To allow passing the existing Tailwind classes\n    placeholder?: string;\n    step?: number;\n}\n\nexport default function MoneyInput({ value, onChange, className = \"\", placeholder, step }: Props) {\n    const formatValue = (num: number) => {\n        return new Intl.NumberFormat('en-US').format(num);\n    };\n\n    const [localValue, setLocalValue] = useState(value === 0 ? '' : formatValue(value));\n\n    // Sync from parent\n    useEffect(() => {\n        const numLocal = Number(localValue.replace(/,/g, ''));\n        if (numLocal !== value && localValue !== '') {\n            setLocalValue(value === 0 ? '' : formatValue(value));\n        }\n    }, [value]);\n\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const raw = e.target.value;\n        setLocalValue(raw);\n\n        if (raw === '') {\n            return;\n        }\n\n        const rawNumber = raw.replace(/,/g, '');\n        const numValue = Number(rawNumber);\n\n        if (!isNaN(numValue)) {\n            onChange(numValue);\n        }\n    };\n\n    const handleBlur = () => {\n        if (localValue === '') {\n            // If empty, revert to parent value (unless parent value is 0, which we show as empty?)\n            // Actually, if parent is 0, we show empty. If parent is 500, we show 500.\n            // If user cleared it, we want it to revert to previous valid value (parent value).\n            // But if parent value was 0, it stays empty.\n            if (value !== 0) {\n                setLocalValue(formatValue(value));\n            }\n        } else {\n            // Format on blur\n            const rawNumber = localValue.replace(/,/g, '');\n            const num = Number(rawNumber);\n            if (!isNaN(num)) {\n                setLocalValue(num === 0 ? '' : formatValue(num));\n            }\n        }\n    };\n\n    return (\n        <div className=\"relative w-full\">\n            <input\n                type=\"text\"\n                className={`${className} pr-8`}\n                value={localValue}\n                onChange={handleChange}\n                onBlur={handleBlur}\n                placeholder={placeholder}\n                inputMode=\"numeric\"\n            />\n            <span className=\"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 text-sm font-bold pointer-events-none\">\n                円\n            </span>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/money-simulation/NumberInput.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/money-simulation/NumberInput.tsx:18:13\n  16 |         // Sync with parent only if valid and different\n  17 |         if (Number(localValue) !== value && localValue !== '') {\n> 18 |             setLocalValue(value.toString());\n     |             ^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  19 |         }\n  20 |     }, [value]);\n  21 |","line":18,"column":13,"nodeType":null,"endLine":18,"endColumn":26},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'localValue'. Either include it or remove the dependency array.","line":20,"column":8,"nodeType":"ArrayExpression","endLine":20,"endColumn":15,"suggestions":[{"desc":"Update the dependencies array to be: [localValue, value]","fix":{"range":[605,612],"text":"[localValue, value]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\n\ninterface Props {\n    value: number;\n    onChange: (value: number) => void;\n    placeholder?: string;\n    step?: number;\n    className?: string;\n    unit?: string;\n}\n\nexport default function NumberInput({ value, onChange, placeholder, step = 1, className = \"\", unit }: Props) {\n    const [localValue, setLocalValue] = useState(value.toString());\n\n    useEffect(() => {\n        // Sync with parent only if valid and different\n        if (Number(localValue) !== value && localValue !== '') {\n            setLocalValue(value.toString());\n        }\n    }, [value]);\n\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const raw = e.target.value;\n        setLocalValue(raw);\n\n        if (raw === '') {\n            return;\n        }\n\n        const num = Number(raw);\n        if (!isNaN(num)) {\n            onChange(num);\n        }\n    };\n\n    const handleBlur = () => {\n        if (localValue === '') {\n            setLocalValue(value.toString());\n        }\n    };\n\n    return (\n        <div className={`relative ${className.includes('w-') ? '' : 'w-full'}`}>\n            <input\n                type=\"number\"\n                step={step}\n                className={`${className} ${unit ? 'pr-8' : ''}`}\n                value={localValue}\n                onChange={handleChange}\n                onBlur={handleBlur}\n                placeholder={placeholder}\n            />\n            {unit && (\n                <span className=\"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 text-sm font-bold pointer-events-none\">\n                    {unit}\n                </span>\n            )}\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/money-simulation/PercentageInput.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/money-simulation/PercentageInput.tsx:22:13\n  20 |         // But here we just have simple numbers.\n  21 |         if (Number(localValue) !== value && localValue !== '') {\n> 22 |             setLocalValue(value.toString());\n     |             ^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  23 |         }\n  24 |     }, [value]);\n  25 |","line":22,"column":13,"nodeType":null,"endLine":22,"endColumn":26},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'localValue'. Either include it or remove the dependency array.","line":24,"column":8,"nodeType":"ArrayExpression","endLine":24,"endColumn":15,"suggestions":[{"desc":"Update the dependencies array to be: [localValue, value]","fix":{"range":[1092,1099],"text":"[localValue, value]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\n\ninterface Props {\n    value: number;\n    onChange: (value: number) => void;\n    placeholder?: string;\n    step?: number;\n    className?: string;\n}\n\nexport default function PercentageInput({ value, onChange, placeholder, step = 0.1, className = \"\" }: Props) {\n    const [localValue, setLocalValue] = useState(value.toString());\n\n    // Sync from parent only if the value is meaningfully different and we are not currently editing to an empty string effectively\n    // But basic sync is safer to ensure external updates are reflected.\n    // We'll trust the parent value primarily, but we need to handle the case where parent value hasn't changed (because we didn't call onChange)\n    // but we want to show empty.\n    useEffect(() => {\n        // If the parent value matches what we parsed from our local value, don't override (keeps cursor stable-ish/formatting)\n        // But here we just have simple numbers.\n        if (Number(localValue) !== value && localValue !== '') {\n            setLocalValue(value.toString());\n        }\n    }, [value]);\n\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const raw = e.target.value;\n        setLocalValue(raw);\n\n        if (raw === '') {\n            // User cleared input. Do NOT update parent to 0.\n            // Parent keeps previous value.\n            return;\n        }\n\n        const num = Number(raw);\n        if (!isNaN(num)) {\n            onChange(num);\n        }\n    };\n\n    const handleBlur = () => {\n        if (localValue === '') {\n            // On blur, if empty, revert to the current valid parent value\n            setLocalValue(value.toString());\n        } else {\n            // Optional: Format standard (e.g. 5. -> 5)\n            const num = Number(localValue);\n            if (!isNaN(num)) {\n                setLocalValue(num.toString());\n            }\n        }\n    };\n\n    return (\n        <div className={`flex items-center bg-white border border-purple-200 rounded-lg px-3 py-2 ${className}`}>\n            <input\n                type=\"number\"\n                step={step}\n                className=\"w-full text-sm text-slate-900 font-medium outline-none bg-transparent\"\n                value={localValue}\n                onChange={handleChange}\n                onBlur={handleBlur}\n                placeholder={placeholder}\n            />\n            <span className=\"text-slate-500 text-sm font-bold ml-1\">%</span>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/money-simulation/ResultsGraph.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'maxVal' is assigned a value but never used.","line":14,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":17},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":49,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":49,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2540,2543],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2540,2543],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\n\"use client\";\n\nimport React from 'react';\nimport { AreaChart, Area, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, Legend } from 'recharts';\nimport { YearlyResult, formatCurrency } from '@/lib/money-simulation/calculations';\n\ninterface Props {\n    data: YearlyResult[];\n}\n\nexport default function ResultsGraph({ data }: Props) {\n    // Determine max value for Y-axis domain to make it look nice\n    const maxVal = Math.max(...data.map(d => d.invested));\n\n    return (\n        <div className=\"bg-white/80 backdrop-blur-xl rounded-3xl p-6 shadow-xl border border-white/50 h-[400px] flex flex-col\">\n            <h3 className=\"text-lg font-bold text-slate-700 mb-4\">資産推移シミュレーション</h3>\n            <div className=\"flex-1 w-full min-h-0\">\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\n                    <AreaChart data={data} margin={{ top: 10, right: 10, left: 0, bottom: 0 }}>\n                        <defs>\n                            <linearGradient id=\"colorInvested\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                                <stop offset=\"5%\" stopColor=\"#3b82f6\" stopOpacity={0.3} />\n                                <stop offset=\"95%\" stopColor=\"#3b82f6\" stopOpacity={0} />\n                            </linearGradient>\n                            <linearGradient id=\"colorBank\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                                <stop offset=\"5%\" stopColor=\"#64748b\" stopOpacity={0.3} />\n                                <stop offset=\"95%\" stopColor=\"#64748b\" stopOpacity={0} />\n                            </linearGradient>\n                        </defs>\n                        <CartesianGrid strokeDasharray=\"3 3\" vertical={false} stroke=\"#e2e8f0\" />\n                        <XAxis\n                            dataKey=\"age\"\n                            tick={{ fill: '#94a3b8', fontSize: 12 }}\n                            tickLine={false}\n                            axisLine={false}\n                            unit=\"歳\"\n                        />\n                        <YAxis\n                            tickFormatter={(value) => (value / 10000) + '万'}\n                            tick={{ fill: '#94a3b8', fontSize: 12 }}\n                            tickLine={false}\n                            axisLine={false}\n                            width={50}\n                        />\n                        <Tooltip\n                            contentStyle={{ borderRadius: '12px', border: 'none', boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1)' }}\n                            formatter={(value: any) => [formatCurrency(value), '']}\n                            labelFormatter={(label) => `${label}歳時点`}\n                        />\n                        <Legend verticalAlign=\"top\" height={36} iconType=\"circle\" />\n                        <Area\n                            type=\"monotone\"\n                            dataKey=\"bank\"\n                            name=\"預金のみ(0.001%)\"\n                            stroke=\"#64748b\"\n                            fillOpacity={1}\n                            fill=\"url(#colorBank)\"\n                            strokeWidth={2}\n                        />\n                        <Area\n                            type=\"monotone\"\n                            dataKey=\"invested\"\n                            name=\"投資運用\"\n                            stroke=\"#3b82f6\"\n                            fillOpacity={1}\n                            fill=\"url(#colorInvested)\"\n                            strokeWidth={3}\n                        />\n                    </AreaChart>\n                </ResponsiveContainer>\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/money-simulation/SimulationForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/money-simulation/SliderMoneyInput.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/money-simulation/SliderMoneyInput.tsx:23:13\n  21 |         const numLocal = Number(localValue.replace(/,/g, ''));\n  22 |         if (numLocal !== value) {\n> 23 |             setLocalValue(value === 0 ? '' : formatValue(value));\n     |             ^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  24 |         }\n  25 |     }, [value]);\n  26 |","line":23,"column":13,"nodeType":null,"endLine":23,"endColumn":26},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'localValue'. Either include it or remove the dependency array.","line":25,"column":8,"nodeType":"ArrayExpression","endLine":25,"endColumn":15,"suggestions":[{"desc":"Update the dependencies array to be: [localValue, value]","fix":{"range":[817,824],"text":"[localValue, value]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\n\ninterface Props {\n    value: number;\n    onChange: (value: number) => void;\n    className?: string; // To allow passing the existing Tailwind classes\n    placeholder?: string;\n    min?: number;\n    max?: number;\n}\n\nexport default function SliderMoneyInput({ value, onChange, className = \"\", placeholder, min = 0, max = 100000 }: Props) {\n    const formatValue = (num: number) => {\n        return new Intl.NumberFormat('en-US').format(num);\n    };\n\n    const [localValue, setLocalValue] = useState(value === 0 ? '' : formatValue(value));\n\n    // Sync from parent\n    useEffect(() => {\n        const numLocal = Number(localValue.replace(/,/g, ''));\n        if (numLocal !== value) {\n            setLocalValue(value === 0 ? '' : formatValue(value));\n        }\n    }, [value]);\n\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const raw = e.target.value;\n        setLocalValue(raw);\n\n        if (raw === '') {\n            onChange(0);\n            return;\n        }\n\n        const rawNumber = raw.replace(/,/g, '');\n        const numValue = Number(rawNumber);\n\n        if (!isNaN(numValue)) {\n            onChange(numValue);\n        }\n    };\n\n    const handleBlur = () => {\n        const rawNumber = localValue.replace(/,/g, '');\n        const num = Number(rawNumber);\n        if (!isNaN(num)) {\n            setLocalValue(num === 0 ? '' : formatValue(num));\n        } else {\n            // Revert if NaN\n            setLocalValue(value === 0 ? '' : formatValue(value));\n        }\n    };\n\n    const handleSliderChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const val = Number(e.target.value);\n        onChange(val);\n        setLocalValue(formatValue(val));\n    };\n\n    return (\n        <div className=\"w-full\">\n            <div className=\"relative w-full mb-2\">\n                <input\n                    type=\"text\"\n                    className={`${className} pr-8`}\n                    value={localValue}\n                    onChange={handleChange}\n                    onBlur={handleBlur}\n                    placeholder={placeholder}\n                    inputMode=\"numeric\"\n                />\n                <span className=\"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 text-sm font-bold pointer-events-none\">\n                    円\n                </span>\n            </div>\n            <input\n                type=\"range\"\n                min={min}\n                max={max}\n                step={1000} // Reasonable step\n                value={value}\n                onChange={handleSliderChange}\n                className=\"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-blue-600\"\n            />\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/money-simulation/forms/AssetsConfigForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[590,593],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[590,593],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":17,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[691,694],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[691,694],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Assets, Config } from '@/lib/money-simulation/types';\nimport { Landmark, Settings, TrendingUp } from 'lucide-react';\nimport MoneyInput from '../MoneyInput';\nimport SliderMoneyInput from '../SliderMoneyInput';\nimport PercentageInput from '../PercentageInput';\n\ninterface Props {\n    assets: Assets;\n    config: Config;\n    onAssetsChange: (a: Assets) => void;\n    onConfigChange: (c: Config) => void;\n}\n\nexport default function AssetsConfigForm({ assets, config, onAssetsChange, onConfigChange }: Props) {\n    const handleAsset = (key: keyof Assets, val: any) => onAssetsChange({ ...assets, [key]: val });\n    const handleConfig = (key: keyof Config, val: any) => onConfigChange({ ...config, [key]: val });\n\n    return (\n        <div className=\"space-y-6\">\n            {/* Assets */}\n            <div className=\"space-y-3\">\n                <h3 className=\"font-bold text-slate-700 flex items-center gap-2\">\n                    <Landmark className=\"text-blue-600\" /> 現在の資産・積立\n                </h3>\n\n                {/* Tsumitate (Moved to Top) */}\n                <div className=\"bg-blue-50/50 p-4 rounded-xl border border-blue-100 mb-4\">\n                    <label className=\"text-xs font-bold text-slate-700 mb-2 block flex items-center gap-1\">\n                        <TrendingUp size={14} className=\"text-blue-500\" />\n                        毎月の積立投資・利回り (NISA等)\n                    </label>\n                    <div className=\"grid grid-cols-3 gap-3\">\n                        <div>\n                            <label className=\"text-[10px] text-slate-500 mb-1 block\">積立額 (月額)</label>\n                            <SliderMoneyInput\n                                className=\"w-full p-2 rounded border border-blue-200 text-sm text-slate-900 font-medium bg-white\"\n                                value={assets.monthlyInvestment?.amount || 0}\n                                onChange={(val) => onAssetsChange({ ...assets, monthlyInvestment: { ...assets.monthlyInvestment || { expectedReturn: 5, durationYears: 20, amount: 0 }, amount: val } })}\n                                max={300000} // Up to 300k\n                            />\n                        </div>\n                        <div>\n                            <label className=\"text-[10px] text-slate-500 mb-1 block\">想定利回り (年率)</label>\n                            <PercentageInput\n                                value={assets.monthlyInvestment?.expectedReturn || 5}\n                                onChange={(val) => onAssetsChange({ ...assets, monthlyInvestment: { ...assets.monthlyInvestment || { amount: 0, durationYears: 20, expectedReturn: 5 }, expectedReturn: val } })}\n                            />\n                        </div>\n                        <div>\n                            <label className=\"text-[10px] text-slate-500 mb-1 block\">積立期間 (年)</label>\n                            <div className=\"relative\">\n                                <input\n                                    type=\"number\"\n                                    className=\"w-full p-2 rounded border border-blue-200 text-sm text-slate-900 font-medium bg-white pr-8\"\n                                    value={assets.monthlyInvestment?.durationYears || 20}\n                                    onChange={(e) => onAssetsChange({ ...assets, monthlyInvestment: { ...assets.monthlyInvestment || { amount: 0, expectedReturn: 5, durationYears: 20 }, durationYears: Number(e.target.value) } })}\n                                />\n                                <span className=\"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 text-xs text font-bold\">年</span>\n                            </div>\n                        </div>\n                    </div>\n                    <p className=\"text-[10px] text-slate-400 mt-2\">※ ここで設定した「想定利回り」が、既存の投資資産にも適用されます。</p>\n                </div>\n\n                <div className=\"bg-blue-50 p-4 rounded-xl border border-blue-100 grid grid-cols-2 gap-4\">\n                    <div>\n                        <label className=\"text-xs font-bold text-slate-700\">預金 (キャッシュ)</label>\n                        <MoneyInput\n                            className=\"w-full p-2 rounded border border-blue-200 text-sm text-slate-900 font-medium\"\n                            value={assets.cashSavings}\n                            onChange={(val) => handleAsset('cashSavings', val)}\n                        />\n                    </div>\n                    <div>\n                        <label className=\"text-xs font-bold text-slate-700\">投資済み資産 (時価)</label>\n                        <MoneyInput\n                            className=\"w-full p-2 rounded border border-blue-200 text-sm text-slate-900 font-medium\"\n                            value={assets.investmentAssets}\n                            onChange={(val) => handleAsset('investmentAssets', val)}\n                        />\n                    </div>\n                </div>\n\n                <div className=\"bg-slate-50 p-4 rounded-xl border border-slate-200\">\n                    <label className=\"text-xs font-bold text-slate-700 mb-2 block\">その他のローン返済 (奨学金など)</label>\n                    <div className=\"grid grid-cols-2 gap-4\">\n                        <div>\n                            <label className=\"text-[10px] text-slate-500\">毎月の返済額</label>\n                            <MoneyInput\n                                className=\"w-full p-2 rounded border border-slate-200 text-sm text-slate-900 font-medium\"\n                                value={assets.otherMonthlyPayment}\n                                onChange={(val) => handleAsset('otherMonthlyPayment', val)}\n                            />\n                        </div>\n                        <div>\n                            <label className=\"text-[10px] text-slate-500\">残高 (概算)</label>\n                            <MoneyInput\n                                className=\"w-full p-2 rounded border border-slate-200 text-sm text-slate-900 font-medium\"\n                                value={assets.otherLoansRemaining}\n                                onChange={(val) => handleAsset('otherLoansRemaining', val)}\n                            />\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            {/* Config */}\n            <div className=\"space-y-3\">\n                <h3 className=\"font-bold text-slate-700 flex items-center gap-2\">\n                    <Settings className=\"text-purple-600\" /> シミュレーション前提\n                </h3>\n                <div className=\"bg-purple-50 p-4 rounded-xl border border-purple-100\">\n                    <div className=\"space-y-4\">\n                        <div>\n                            <label className=\"text-xs font-bold text-slate-700 mb-1 block\">インフレ率 (年率)</label>\n                            <PercentageInput\n                                value={config.inflationRate}\n                                onChange={(val) => handleConfig('inflationRate', val)}\n                            />\n                            <p className=\"text-[10px] text-slate-400 mt-1\">※ 全ての生活費と教育費がこの率で上昇すると仮定します。</p>\n                        </div>\n\n                        <div className=\"pt-4 border-t border-purple-100 grid grid-cols-2 gap-4\">\n                            <label className=\"flex items-center gap-2 cursor-pointer\">\n                                <input\n                                    type=\"checkbox\"\n                                    className=\"accent-blue-600 w-4 h-4\"\n                                    checked={config.enableExpenses ?? true}\n                                    onChange={(e) => handleConfig('enableExpenses', e.target.checked)}\n                                />\n                                <span className=\"text-xs font-bold text-slate-700\">生活費・支出を含める</span>\n                            </label>\n\n                            <label className=\"flex items-center gap-2 cursor-pointer\">\n                                <input\n                                    type=\"checkbox\"\n                                    className=\"accent-blue-600 w-4 h-4\"\n                                    checked={config.enableRetirement ?? true}\n                                    onChange={(e) => handleConfig('enableRetirement', e.target.checked)}\n                                />\n                                <span className=\"text-xs font-bold text-slate-700\">引退・老後生活を考慮</span>\n                            </label>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/money-simulation/forms/ExpensesForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":17,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[567,570],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[567,570],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[673,676],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[673,676],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Housing, Expenses } from '@/lib/money-simulation/types';\nimport { Home, Coffee, AlertCircle, Car } from 'lucide-react';\nimport MoneyInput from '../MoneyInput';\nimport NumberInput from '../NumberInput';\n\ninterface Props {\n    housing: Housing;\n    expenses: Expenses;\n    onHousingChange: (h: Housing) => void;\n    onExpensesChange: (e: Expenses) => void;\n}\n\nexport default function ExpensesForm({ housing, expenses, onHousingChange, onExpensesChange }: Props) {\n\n    // Handlers\n    const handleHousing = (key: keyof Housing, val: any) => onHousingChange({ ...housing, [key]: val });\n    const handleExpense = (key: keyof Expenses, val: any) => onExpensesChange({ ...expenses, [key]: val });\n\n    const handleCar = (index: number, key: 'intervalYears' | 'cost', val: number) => {\n        const newCars = [...expenses.vehicleReplacements];\n        newCars[index] = { ...newCars[index], [key]: val };\n        onExpensesChange({ ...expenses, vehicleReplacements: newCars });\n    };\n\n    const addCar = () => {\n        onExpensesChange({\n            ...expenses,\n            vehicleReplacements: [...expenses.vehicleReplacements, { intervalYears: 7, cost: 2000000 }]\n        });\n    };\n\n    const removeCar = (index: number) => {\n        const newCars = expenses.vehicleReplacements.filter((_, i) => i !== index);\n        onExpensesChange({ ...expenses, vehicleReplacements: newCars });\n    };\n\n    return (\n        <div className=\"space-y-6\">\n\n            {/* Housing Section */}\n            <div className=\"space-y-3\">\n                <h3 className=\"font-bold text-slate-700 flex items-center gap-2\">\n                    <Home className=\"text-orange-500\" /> 住まい\n                </h3>\n                <div className=\"bg-orange-50 p-4 rounded-xl border border-orange-100 space-y-3\">\n                    <div>\n                        <label className=\"text-xs font-bold text-slate-700\">現在の住居タイプ</label>\n                        <select\n                            className=\"w-full p-2 rounded border border-orange-200 text-sm text-slate-900 font-medium\"\n                            value={housing.type}\n                            onChange={(e) => handleHousing('type', e.target.value)}\n                        >\n                            <option value=\"rent\">賃貸</option>\n                            <option value=\"own_with_loan\">持ち家 (住宅ローンあり)</option>\n                            <option value=\"own_paid_off\">持ち家 (完済)</option>\n                        </select>\n                    </div>\n\n                    <div className=\"grid grid-cols-2 gap-3\">\n                        <div>\n                            <label className=\"text-xs font-bold text-slate-700\">\n                                {housing.type === 'rent' ? '毎月の家賃' : '毎月のローン返済額'}\n                            </label>\n                            <MoneyInput\n                                className=\"w-full p-2 rounded border border-orange-200 text-sm text-slate-900 font-medium\"\n                                value={housing.monthlyCost}\n                                onChange={(val) => handleHousing('monthlyCost', val)}\n                            />\n                        </div>\n                        {housing.type === 'own_with_loan' && (\n                            <div>\n                                <label className=\"text-xs font-bold text-slate-700\">ローンの残り年数</label>\n                                <NumberInput\n                                    className=\"w-full p-2 rounded border border-orange-200 text-sm text-slate-900 font-medium\"\n                                    value={housing.remainingLoanYears}\n                                    onChange={(val) => handleHousing('remainingLoanYears', val)}\n                                    unit=\"年\"\n                                />\n                            </div>\n                        )}\n                    </div>\n\n                    {housing.type.includes('own') && (\n                        <div>\n                            <label className=\"text-xs font-bold text-slate-700\">年間の固定資産税・修繕費</label>\n                            <MoneyInput\n                                className=\"w-full p-2 rounded border border-orange-200 text-sm text-slate-900 font-medium\"\n                                value={housing.maintenanceCostPerYear}\n                                onChange={(val) => handleHousing('maintenanceCostPerYear', val)}\n                            />\n                        </div>\n                    )}\n                </div>\n            </div>\n\n            {/* Living Expenses */}\n            <div className=\"space-y-3\">\n                <h3 className=\"font-bold text-slate-700 flex items-center gap-2\">\n                    <Coffee className=\"text-emerald-500\" /> 生活費・その他\n                </h3>\n                <div className=\"bg-emerald-50 p-4 rounded-xl border border-emerald-100 space-y-3\">\n                    <div>\n                        <label className=\"text-xs font-bold text-slate-700\">毎月の基本生活費 (内訳)</label>\n                        <p className=\"text-[10px] text-slate-400 mb-2\">※ 住居費・教育費は除いてください</p>\n\n                        <div className=\"grid grid-cols-2 gap-3 mb-2\">\n                            <div>\n                                <label className=\"text-[10px] text-slate-500 block mb-1\">食費</label>\n                                <MoneyInput\n                                    className=\"w-full p-2 rounded border border-emerald-200 text-sm text-slate-900 font-medium bg-white\"\n                                    value={expenses.food}\n                                    onChange={(val) => handleExpense('food', val)}\n                                />\n                            </div>\n                            <div>\n                                <label className=\"text-[10px] text-slate-500 block mb-1\">水道光熱費</label>\n                                <MoneyInput\n                                    className=\"w-full p-2 rounded border border-emerald-200 text-sm text-slate-900 font-medium bg-white\"\n                                    value={expenses.utilities}\n                                    onChange={(val) => handleExpense('utilities', val)}\n                                />\n                            </div>\n                            <div>\n                                <label className=\"text-[10px] text-slate-500 block mb-1\">通信費</label>\n                                <MoneyInput\n                                    className=\"w-full p-2 rounded border border-emerald-200 text-sm text-slate-900 font-medium bg-white\"\n                                    value={expenses.communication}\n                                    onChange={(val) => handleExpense('communication', val)}\n                                />\n                            </div>\n                            <div>\n                                <label className=\"text-[10px] text-slate-500 block mb-1\">日用品</label>\n                                <MoneyInput\n                                    className=\"w-full p-2 rounded border border-emerald-200 text-sm text-slate-900 font-medium bg-white\"\n                                    value={expenses.dailyGoods}\n                                    onChange={(val) => handleExpense('dailyGoods', val)}\n                                />\n                            </div>\n                            <div>\n                                <label className=\"text-[10px] text-slate-500 block mb-1\">被服・美容費</label>\n                                <MoneyInput\n                                    className=\"w-full p-2 rounded border border-emerald-200 text-sm text-slate-900 font-medium bg-white\"\n                                    value={expenses.clothingBeauty}\n                                    onChange={(val) => handleExpense('clothingBeauty', val)}\n                                />\n                            </div>\n                            <div>\n                                <label className=\"text-[10px] text-slate-500 block mb-1\">趣味・娯楽・交際</label>\n                                <MoneyInput\n                                    className=\"w-full p-2 rounded border border-emerald-200 text-sm text-slate-900 font-medium bg-white\"\n                                    value={expenses.entertainment}\n                                    onChange={(val) => handleExpense('entertainment', val)}\n                                />\n                            </div>\n                            <div>\n                                <label className=\"text-[10px] text-slate-500 block mb-1\">医療・保険</label>\n                                <MoneyInput\n                                    className=\"w-full p-2 rounded border border-emerald-200 text-sm text-slate-900 font-medium bg-white\"\n                                    value={expenses.medicalInsurance}\n                                    onChange={(val) => handleExpense('medicalInsurance', val)}\n                                />\n                            </div>\n                            <div>\n                                <label className=\"text-[10px] text-slate-500 block mb-1\">その他</label>\n                                <MoneyInput\n                                    className=\"w-full p-2 rounded border border-emerald-200 text-sm text-slate-900 font-medium bg-white\"\n                                    value={expenses.otherBasic}\n                                    onChange={(val) => handleExpense('otherBasic', val)}\n                                />\n                            </div>\n                        </div>\n                        <div className=\"text-right text-xs font-bold text-emerald-700 bg-emerald-100/50 p-2 rounded-lg\">\n                            合計: {(\n                                (expenses.food || 0) +\n                                (expenses.utilities || 0) +\n                                (expenses.communication || 0) +\n                                (expenses.dailyGoods || 0) +\n                                (expenses.clothingBeauty || 0) +\n                                (expenses.entertainment || 0) +\n                                (expenses.medicalInsurance || 0) +\n                                (expenses.otherBasic || 0)\n                            ).toLocaleString()}円 / 月\n                        </div>\n                    </div>\n                    <div>\n                        <label className=\"text-xs font-bold text-slate-700\">年間の特別支出 (旅行・帰省・家具家電など)</label>\n                        <MoneyInput\n                            className=\"w-full p-2 rounded border border-emerald-200 text-sm text-slate-900 font-medium\"\n                            value={expenses.yearlySpecialExpenses}\n                            onChange={(val) => handleExpense('yearlySpecialExpenses', val)}\n                        />\n                    </div>\n\n                    {/* Vehicles */}\n                    <div className=\"pt-2 border-t border-emerald-200\">\n                        <div className=\"flex justify-between items-center mb-2\">\n                            <label className=\"text-xs font-bold text-slate-700 flex items-center gap-1\">\n                                <Car size={14} /> 車の買い替え\n                            </label>\n                            <button onClick={addCar} className=\"text-xs bg-emerald-200 text-emerald-800 px-2 py-0.5 rounded\">追加</button>\n                        </div>\n                        {expenses.vehicleReplacements.map((car, idx) => (\n                            <div key={idx} className=\"flex gap-2 items-center mb-2\">\n                                <span className=\"text-xs\">間隔:</span>\n                                <NumberInput\n                                    className=\"w-16 p-1 rounded text-xs text-slate-900 font-medium\"\n                                    value={car.intervalYears}\n                                    onChange={(val) => handleCar(idx, 'intervalYears', val)}\n                                    unit=\"年\"\n                                />\n                                <span className=\"text-xs\">/ 予算:</span>\n                                <MoneyInput\n                                    className=\"w-24 p-1 rounded text-xs text-slate-900 font-medium\"\n                                    value={car.cost}\n                                    onChange={(val) => handleCar(idx, 'cost', val)}\n                                />\n                                <button onClick={() => removeCar(idx)} className=\"text-slate-400 hover:text-red-500\"><AlertCircle size={14} /></button>\n                            </div>\n                        ))}\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/money-simulation/forms/FamilyForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":28,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":28,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[906,909],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[906,909],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":80,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":83,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1133,1136],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1133,1136],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Child } from '@/lib/money-simulation/types';\nimport { Baby, GraduationCap, Plus, Trash2 } from 'lucide-react';\nimport NumberInput from '../NumberInput';\n\ninterface Props {\n    childrenData: Child[];\n    onChange: (c: Child[]) => void;\n}\n\nexport default function FamilyForm({ childrenData, onChange }: Props) {\n    const addChild = () => {\n        const newChild: Child = {\n            id: Math.random().toString(36).substr(2, 9),\n            name: `子供 ${childrenData.length + 1}`,\n            age: 0,\n            educationPlan: {\n                kindergarten: 'public',\n                elementary: 'public',\n                juniorHigh: 'public',\n                highSchool: 'public',\n                university: 'private_arts'\n            }\n        };\n        onChange([...childrenData, newChild]);\n    };\n\n    const updateChild = (index: number, key: keyof Child, val: any) => {\n        const updated = [...childrenData];\n        updated[index] = { ...updated[index], [key]: val };\n        onChange(updated);\n    };\n\n    const updatePlan = (index: number, key: keyof Child['educationPlan'], val: any) => {\n        const updated = [...childrenData];\n        updated[index].educationPlan = { ...updated[index].educationPlan, [key]: val };\n        onChange(updated);\n    };\n\n    const removeChild = (index: number) => {\n        onChange(childrenData.filter((_, i) => i !== index));\n    };\n\n    return (\n        <div className=\"space-y-4\">\n            <div className=\"flex justify-between items-center\">\n                <h3 className=\"font-bold text-slate-700 flex items-center gap-2\">\n                    <Baby className=\"text-pink-500\" /> お子様の情報\n                </h3>\n                <button\n                    onClick={addChild}\n                    className=\"flex items-center gap-1 text-sm bg-pink-100 text-pink-600 px-3 py-1 rounded-full hover:bg-pink-200 transition\"\n                >\n                    <Plus size={14} /> 追加\n                </button>\n            </div>\n\n            {childrenData.map((child, index) => (\n                <div key={child.id} className=\"p-4 bg-pink-50 rounded-xl border border-pink-100 relative\">\n                    <button\n                        onClick={() => removeChild(index)}\n                        className=\"absolute top-2 right-2 text-slate-400 hover:text-red-500 p-2\"\n                    >\n                        <Trash2 size={16} />\n                    </button>\n\n                    <div className=\"grid grid-cols-2 gap-4 mb-3\">\n                        <div>\n                            <label className=\"text-xs font-bold text-slate-700\">お名前</label>\n                            <input\n                                className=\"w-full text-sm p-1 bg-white rounded border border-pink-200 text-slate-900 font-medium\"\n                                value={child.name}\n                                onChange={(e) => updateChild(index, 'name', e.target.value)}\n                            />\n                        </div>\n                        <div>\n                            <label className=\"text-xs font-bold text-slate-700\">現在の年齢</label>\n                            <NumberInput\n                                className=\"w-full text-sm p-1 bg-white rounded border border-pink-200 text-slate-900 font-medium\"\n                                value={child.age}\n                                onChange={(val) => updateChild(index, 'age', val)}\n                                unit=\"歳\"\n                            />\n                        </div>\n                    </div>\n\n                    <div className=\"space-y-2\">\n                        <label className=\"flex items-center gap-1 text-xs font-bold text-slate-800\">\n                            <GraduationCap size={14} /> 進路プラン\n                        </label>\n                        <div className=\"grid grid-cols-2 md:grid-cols-5 gap-2 text-xs\">\n                            <select\n                                value={child.educationPlan.kindergarten}\n                                onChange={(e) => updatePlan(index, 'kindergarten', e.target.value)}\n                                className=\"p-1 rounded border border-slate-200 text-slate-900 font-medium\"\n                            >\n                                <option value=\"public\">公立 幼稚園</option>\n                                <option value=\"private\">私立 幼稚園</option>\n                            </select>\n                            <select\n                                value={child.educationPlan.elementary}\n                                onChange={(e) => updatePlan(index, 'elementary', e.target.value)}\n                                className=\"p-1 rounded border border-slate-200 text-slate-900 font-medium\"\n                            >\n                                <option value=\"public\">公立 小学校</option>\n                                <option value=\"private\">私立 小学校</option>\n                            </select>\n                            <select\n                                value={child.educationPlan.juniorHigh}\n                                onChange={(e) => updatePlan(index, 'juniorHigh', e.target.value)}\n                                className=\"p-1 rounded border border-slate-200 text-slate-900 font-medium\"\n                            >\n                                <option value=\"public\">公立 中学校</option>\n                                <option value=\"private\">私立 中学校</option>\n                            </select>\n                            <select\n                                value={child.educationPlan.highSchool}\n                                onChange={(e) => updatePlan(index, 'highSchool', e.target.value)}\n                                className=\"p-1 rounded border border-slate-200 text-slate-900 font-medium\"\n                            >\n                                <option value=\"public\">公立 高校</option>\n                                <option value=\"private\">私立 高校</option>\n                            </select>\n                            <select\n                                value={child.educationPlan.university}\n                                onChange={(e) => updatePlan(index, 'university', e.target.value)}\n                                className=\"p-1 rounded border border-slate-200 text-slate-900 font-medium\"\n                            >\n                                <option value=\"national_arts\">国公立 (文系)</option>\n                                <option value=\"national_science\">国公立 (理系)</option>\n                                <option value=\"private_arts\">私立 (文系)</option>\n                                <option value=\"private_science\">私立 (理系)</option>\n                                <option value=\"none\">進学しない</option>\n                            </select>\n                        </div>\n                    </div>\n                </div>\n            ))}\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/money-simulation/forms/PersonInput.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Briefcase' is defined but never used.","line":3,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":25,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Briefcase"},"fix":{"range":[95,106],"text":""},"desc":"Remove unused variable \"Briefcase\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[468,471],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[468,471],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Person } from '@/lib/money-simulation/types';\nimport { User, Briefcase } from 'lucide-react';\nimport MoneyInput from '../MoneyInput';\nimport NumberInput from '../NumberInput';\n\ninterface Props {\n    title: string;\n    person: Person;\n    onChange: (p: Person) => void;\n    colorClass: string;\n}\n\nexport default function PersonInput({ title, person, onChange, colorClass }: Props) {\n    const handleChange = (key: keyof Person, val: any) => {\n        onChange({ ...person, [key]: val });\n    };\n\n    return (\n        <div className={`p-4 rounded-2xl border ${colorClass} space-y-4`}>\n            <h3 className=\"font-bold text-lg flex items-center gap-2 text-slate-700\">\n                <User size={20} /> {title}\n            </h3>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                    <label className=\"block text-xs font-bold text-slate-700 mb-1\">現在の年齢</label>\n                    <NumberInput\n                        className=\"w-full p-2 rounded-lg bg-white border border-slate-200 text-slate-900 font-medium\"\n                        value={person.currentAge}\n                        onChange={(val) => handleChange('currentAge', val)}\n                        unit=\"歳\"\n                    />\n                </div>\n                <div>\n                    <label className=\"block text-xs font-bold text-slate-700 mb-1\">引退年齢</label>\n                    <NumberInput\n                        className=\"w-full p-2 rounded-lg bg-white border border-slate-200 text-slate-900 font-medium\"\n                        value={person.targetRetirementAge}\n                        onChange={(val) => handleChange('targetRetirementAge', val)}\n                        unit=\"歳\"\n                    />\n                </div>\n            </div>\n\n            <div>\n                <label className=\"block text-xs font-bold text-slate-700 mb-1\">働き方 (年金計算用)</label>\n                <select\n                    className=\"w-full p-2 rounded-lg bg-white border border-slate-200 text-slate-900 font-medium\"\n                    value={person.employmentType}\n                    onChange={(e) => handleChange('employmentType', e.target.value)}\n                >\n                    <option value=\"employee\">会社員 (厚生年金)</option>\n                    <option value=\"self_employed\">自営業 (国民年金)</option>\n                    <option value=\"none\">扶養 / なし</option>\n                </select>\n            </div>\n\n            <div className=\"space-y-3\">\n                <div className=\"relative\">\n                    <label className=\"block text-xs font-bold text-slate-700 mb-1\">昨年の年収 (額面)</label>\n                    <MoneyInput\n                        className=\"w-full p-2 rounded-lg bg-white border border-slate-200 text-slate-900 font-medium\"\n                        value={person.annualIncome}\n                        onChange={(val) => handleChange('annualIncome', val)}\n                    />\n                </div>\n                <div className=\"relative\">\n                    <label className=\"block text-xs font-bold text-slate-700 mb-1\">年間ボーナス (手取り)</label>\n                    <MoneyInput\n                        className=\"w-full p-2 rounded-lg bg-white border border-slate-200 text-slate-900 font-medium\"\n                        value={person.annualBonus}\n                        onChange={(val) => handleChange('annualBonus', val)}\n                    />\n                </div>\n                <div className=\"relative\">\n                    <label className=\"block text-xs font-bold text-slate-700 mb-1\">退職金 (見込み)</label>\n                    <MoneyInput\n                        className=\"w-full p-2 rounded-lg bg-white border border-slate-200 text-slate-900 font-medium\"\n                        value={person.retirementAllowance}\n                        onChange={(val) => handleChange('retirementAllowance', val)}\n                    />\n                </div>\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/money-simulation/results/AssetTransitionGraph.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/money-simulation/results/CashFlowGraph.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BarChart' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":18,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"BarChart"},"fix":{"range":[99,108],"text":""},"desc":"Remove unused variable \"BarChart\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { YearlyCashFlow } from '@/lib/money-simulation/types';\nimport { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, Line, ComposedChart } from 'recharts';\n\ninterface Props {\n    data: YearlyCashFlow[];\n}\n\nconst formatYAxis = (tick: number) => {\n    return (tick / 10000) + '万';\n};\n\nexport default function CashFlowGraph({ data }: Props) {\n    return (\n        <div className=\"h-80 w-full bg-white p-4 rounded-xl border border-slate-100 shadow-sm\">\n            <h4 className=\"text-sm font-bold text-slate-500 mb-4 text-center\">年間収支の推移</h4>\n            <ResponsiveContainer width=\"100%\" height=\"100%\">\n                <ComposedChart data={data} margin={{ top: 10, right: 10, left: 0, bottom: 30 }}>\n                    <CartesianGrid strokeDasharray=\"3 3\" vertical={false} stroke=\"#E2E8F0\" />\n                    <XAxis dataKey=\"age\" tick={{ fontSize: 10 }} name=\"年齢\" />\n                    <YAxis tickFormatter={formatYAxis} tick={{ fontSize: 10 }} />\n                    <Tooltip\n                        formatter={(value: number | undefined) => value !== undefined ? new Intl.NumberFormat('ja-JP', { style: 'currency', currency: 'JPY' }).format(value) : ''}\n                        labelFormatter={(v) => `${v}歳`}\n                    />\n                    <Legend iconSize={8} wrapperStyle={{ fontSize: '10px' }} />\n\n                    {/* Expenses Stack */}\n                    <Bar dataKey=\"basicLiving\" name=\"生活費\" stackId=\"expense\" fill=\"#34D399\" />\n                    <Bar dataKey=\"housing\" name=\"住居費\" stackId=\"expense\" fill=\"#F97316\" />\n                    <Bar dataKey=\"education\" name=\"教育費\" stackId=\"expense\" fill=\"#EC4899\" />\n                    <Bar dataKey=\"events\" name=\"一時支出\" stackId=\"expense\" fill=\"#A855F7\" />\n\n                    {/* Income Line */}\n                    <Line type=\"monotone\" dataKey=\"totalIncome\" name=\"手取り収入\" stroke=\"#3B82F6\" strokeWidth={3} dot={false} />\n                </ComposedChart>\n            </ResponsiveContainer>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/money-simulation/tools/ComparisonManager.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useState' is defined but never used.","line":1,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":25,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useState"},"fix":{"range":[12,26],"text":""},"desc":"Remove unused variable \"useState\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'baseInput' is defined but never used.","line":15,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":54}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { LifePlanInput, YearlyCashFlow } from '@/lib/money-simulation/types';\nimport { Copy, RefreshCw } from 'lucide-react';\nimport { AreaChart, Area, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } from 'recharts';\n\ninterface Props {\n    baseInput: LifePlanInput;\n    baseResults: YearlyCashFlow[];\n    compareInput: LifePlanInput | null;\n    compareResults: YearlyCashFlow[] | null;\n    onStartComparison: () => void;\n    onStopComparison: () => void;\n}\n\nexport default function ComparisonManager({ baseInput, baseResults, compareInput, compareResults, onStartComparison, onStopComparison }: Props) {\n    if (!compareInput || !compareResults) {\n        return (\n            <div className=\"bg-white p-6 rounded-2xl shadow-sm border border-slate-200 text-center\">\n                <h3 className=\"font-bold text-slate-700 mb-2\">シミュレーション比較</h3>\n                <p className=\"text-sm text-slate-500 mb-4\">\n                    現在のプランを複製して、別のシナリオ（例：家を買った場合、転職した場合）と比較できます。\n                </p>\n                <button\n                    onClick={onStartComparison}\n                    className=\"px-6 py-2 bg-slate-800 text-white rounded-lg font-bold hover:bg-slate-700 transition flex items-center justify-center gap-2 mx-auto\"\n                >\n                    <Copy size={16} /> 比較プランを作成する\n                </button>\n            </div>\n        );\n    }\n\n    // Prepare merged data for graph\n    const mergedData = baseResults.map((r, i) => {\n        const comp = compareResults[i];\n        return {\n            age: r.age,\n            baseAssets: r.totalAssets,\n            compAssets: comp ? comp.totalAssets : 0\n        };\n    });\n\n    return (\n        <div className=\"bg-slate-900 text-white p-6 rounded-2xl shadow-xl space-y-6\">\n            <div className=\"flex justify-between items-center\">\n                <h3 className=\"font-bold text-lg flex items-center gap-2\">\n                    <RefreshCw size={20} className=\"text-green-400\" />\n                    シナリオ比較モード\n                </h3>\n                <button\n                    onClick={onStopComparison}\n                    className=\"text-xs text-slate-400 hover:text-white border border-slate-600 px-3 py-1 rounded\"\n                >\n                    比較を終了\n                </button>\n            </div>\n\n            <div className=\"h-64 w-full\">\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\n                    <AreaChart data={mergedData} margin={{ top: 5, right: 10, left: 0, bottom: 5 }}>\n                        <CartesianGrid strokeDasharray=\"3 3\" vertical={false} stroke=\"#334155\" />\n                        <XAxis dataKey=\"age\" tick={{ fontSize: 10, fill: '#94a3b8' }} />\n                        <YAxis tickFormatter={(v) => (v / 10000) + '万'} tick={{ fontSize: 10, fill: '#94a3b8' }} />\n                        <Tooltip\n                            contentStyle={{ backgroundColor: '#1e293b', border: 'none', color: 'white' }}\n                            formatter={(value: number | undefined) => value !== undefined ? new Intl.NumberFormat('ja-JP', { style: 'currency', currency: 'JPY' }).format(value) : ''}\n                            labelFormatter={(v) => `${v}歳`}\n                        />\n                        <Legend iconSize={8} wrapperStyle={{ fontSize: '10px' }} />\n                        <Area type=\"monotone\" dataKey=\"baseAssets\" name=\"プランA (青)\" stroke=\"#3B82F6\" strokeWidth={2} fillOpacity={0.1} fill=\"#3B82F6\" />\n                        <Area type=\"monotone\" dataKey=\"compAssets\" name=\"プランB (赤)\" stroke=\"#F43F5E\" strokeWidth={2} fillOpacity={0.1} fill=\"#F43F5E\" />\n                    </AreaChart>\n                </ResponsiveContainer>\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4 text-center\">\n                <div className=\"p-3 rounded-lg bg-blue-500/10 border border-blue-500/30\">\n                    <p className=\"text-xs text-blue-300 mb-1\">プランA (編集中)</p>\n                    <p className=\"text-xl font-bold text-blue-400\">\n                        {mergedData[mergedData.length - 1].baseAssets.toLocaleString()}円\n                    </p>\n                </div>\n                <div className=\"p-3 rounded-lg bg-rose-500/10 border border-rose-500/30\">\n                    <p className=\"text-xs text-rose-300 mb-1\">プランB (比較対象)</p>\n                    <p className=\"text-xl font-bold text-rose-400\">\n                        {mergedData[mergedData.length - 1].compAssets.toLocaleString()}円\n                    </p>\n                </div>\n            </div>\n\n            <p className=\"text-center text-xs text-slate-400\">\n                ※ 現在、左側のフォームで編集しているのは「プランA」です。比較対象の「プランB」を編集するには、一度比較を終了して値を変更し、再度比較を作成してください。\n            </p>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/money-simulation/tools/TargetCalculator.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowRight' is defined but never used.","line":4,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":32,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowRight"},"fix":{"range":[193,205],"text":""},"desc":"Remove unused variable \"ArrowRight\"."}]},{"ruleId":"prefer-const","severity":2,"message":"'found' is never reassigned. Use 'const' instead.","line":22,"column":17,"nodeType":"Identifier","messageId":"useConst","endLine":22,"endColumn":22,"fix":{"range":[852,870],"text":"const found = false;"}},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'found' is assigned a value but never used.","line":22,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":22}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { calculateLifePlan } from '@/lib/money-simulation/simulation';\nimport { LifePlanInput } from '@/lib/money-simulation/types';\nimport { Calculator, ArrowRight, Target } from 'lucide-react';\n\ninterface Props {\n    currentInput: LifePlanInput;\n}\n\nexport default function TargetCalculator({ currentInput }: Props) {\n    const [targetAge, setTargetAge] = useState(65);\n    const [targetAmount, setTargetAmount] = useState(20000000); // 20M JPY\n    const [result, setResult] = useState<number | null>(null);\n    const [isCalculating, setIsCalculating] = useState(false);\n\n    const calculateRequiredSavings = () => {\n        setIsCalculating(true);\n        setTimeout(() => {\n            // Binary search for monthly savings\n            let low = 0;\n            let high = 1000000; // Max 1M/month\n            let found = false;\n            let bestGuess = 0;\n\n            // Deep clone input to avoid mutating state\n            const tempInput: LifePlanInput = JSON.parse(JSON.stringify(currentInput));\n\n            // Identify where to add this \"extra savings\". \n            // We'll treat it as an increase in \"headOfHousehold.annualIncome\" (saving from income)\n            // OR strictly as \"Expense reduction\"? \n            // Actually, the prompt is \"Required Monthly Savings\".\n            // In our logic, `surplus = Income - Expenses`.\n            // We want to find a `delta` such that `surplus + delta` results in Target.\n            // But `surplus` goes to Investment.\n            // So essentially we are solving for an increase in Income (or decrease in Expense).\n            // Let's call it \"Additional Monthly Saving\" which mathematically acts like extra Tax-free Income dedicated to investment.\n\n            for (let i = 0; i < 20; i++) { // 20 iterations is enough precision\n                const mid = (low + high) / 2;\n\n                // Modify input: Add 'mid * 12' to annual income (simplified way to inject cash flow)\n                tempInput.headOfHousehold.annualIncome = currentInput.headOfHousehold.annualIncome + (mid * 12);\n\n                const res = calculateLifePlan(tempInput);\n\n                // Find asset at target age\n                const targetYearResults = res.find(r => r.age === targetAge);\n                const achieved = targetYearResults ? targetYearResults.totalAssets : 0;\n\n                if (achieved > targetAmount) {\n                    high = mid;\n                    bestGuess = mid;\n                } else {\n                    low = mid;\n                }\n            }\n\n            setResult(Math.round(bestGuess));\n            setIsCalculating(false);\n        }, 100);\n    };\n\n    return (\n        <div className=\"bg-gradient-to-br from-indigo-50 to-blue-50 p-6 rounded-2xl border border-indigo-100 shadow-sm\">\n            <h3 className=\"font-bold text-indigo-800 flex items-center gap-2 mb-4\">\n                <Target size={20} /> 目標達成シミュレーター\n            </h3>\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4\">\n                <div>\n                    <label className=\"text-xs font-bold text-slate-500 mb-1\">何歳時点で？</label>\n                    <input\n                        type=\"number\"\n                        className=\"w-full p-2 rounded border border-indigo-200\"\n                        value={targetAge}\n                        onChange={(e) => setTargetAge(Number(e.target.value))}\n                    />\n                </div>\n                <div>\n                    <label className=\"text-xs font-bold text-slate-500 mb-1\">目標資産額 (円)</label>\n                    <input\n                        type=\"number\"\n                        step={1000000}\n                        className=\"w-full p-2 rounded border border-indigo-200\"\n                        value={targetAmount}\n                        onChange={(e) => setTargetAmount(Number(e.target.value))}\n                    />\n                    <div className=\"flex justify-between text-[10px] text-slate-400 mt-1\">\n                        <button onClick={() => setTargetAmount(10000000)}>1,000万</button>\n                        <button onClick={() => setTargetAmount(20000000)}>2,000万</button>\n                        <button onClick={() => setTargetAmount(50000000)}>5,000万</button>\n                        <button onClick={() => setTargetAmount(100000000)}>1億</button>\n                    </div>\n                </div>\n            </div>\n\n            <button\n                onClick={calculateRequiredSavings}\n                disabled={isCalculating}\n                className=\"w-full py-3 bg-indigo-600 text-white rounded-xl font-bold hover:bg-indigo-700 transition flex justify-center items-center gap-2\"\n            >\n                {isCalculating ? '計算中...' : '必要な毎月の積立額を計算'}\n                <Calculator size={18} />\n            </button>\n\n            {result !== null && (\n                <div className=\"mt-6 text-center animate-in fade-in slide-in-from-bottom-4 duration-500\">\n                    <p className=\"text-sm font-bold text-slate-500 mb-2\">目標達成に必要な追加積立額</p>\n                    <div className=\"text-3xl font-black text-indigo-600 flex items-center justify-center gap-2\">\n                        <span>月額</span>\n                        {result.toLocaleString()}\n                        <span className=\"text-lg text-slate-600\">円</span>\n                    </div>\n                    <p className=\"text-xs text-slate-400 mt-2\">\n                        ※ 現在の収支に加えて、これだけ収入を増やすか節約する必要があります。\n                    </p>\n                </div>\n            )}\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/reels/ReelIcon.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":43,"column":29,"nodeType":"JSXOpeningElement","endLine":43,"endColumn":112},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":45,"column":29,"nodeType":"JSXOpeningElement","endLine":45,"endColumn":126}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Play } from 'lucide-react';\nimport { Reel } from '@/lib/dummyData';\n\ninterface ReelIconProps {\n    reels: Reel[];\n    onClick: () => void;\n    fallbackImage?: string;\n}\n\nexport const ReelIcon: React.FC<ReelIconProps> = ({ reels, onClick, fallbackImage }) => {\n    const [isHovered, setIsHovered] = useState(false);\n\n    if (!reels || reels.length === 0) return null;\n\n    const firstReel = reels[0];\n\n    return (\n        <button\n            onClick={(e) => {\n                e.preventDefault();\n                e.stopPropagation();\n                onClick();\n            }}\n            onMouseEnter={() => setIsHovered(true)}\n            onMouseLeave={() => setIsHovered(false)}\n            className=\"relative group mr-2\"\n        >\n            <div className=\"w-32 h-32 rounded-full p-[5px] bg-gradient-to-tr from-yellow-400 via-orange-500 to-purple-600 animate-pulse-slow active:scale-95 transition-transform shadow-2xl\">\n                <div className=\"w-full h-full rounded-full bg-white border-2 border-transparent flex items-center justify-center relative overflow-hidden bg-black\">\n                    {/* Hover Preview Video */}\n                    <div className=\"w-full h-full relative\">\n                        {firstReel.type === 'file' ? (\n                            <video\n                                src={`${firstReel.url}${!isHovered ? '#t=0.01' : ''}`}\n                                className=\"w-full h-full object-cover\"\n                                autoPlay={isHovered}\n                                muted\n                                loop={isHovered}\n                                playsInline\n                            />\n                        ) : firstReel.thumbnail ? (\n                            <img src={firstReel.thumbnail} alt=\"Reel\" className=\"w-full h-full object-cover\" />\n                        ) : fallbackImage ? (\n                            <img src={fallbackImage} alt=\"Reel Fallback\" className=\"w-full h-full object-cover opacity-60\" />\n                        ) : (\n                            <div className=\"w-full h-full bg-slate-800\" />\n                        )}\n                        <div className={`absolute inset-0 flex items-center justify-center bg-black/20 group-hover:bg-black/10 transition-all pointer-events-none ${isHovered ? 'opacity-0' : 'opacity-100'}`}>\n                            <Play size={48} className=\"text-white fill-white ml-2 drop-shadow-xl\" />\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div className=\"absolute bottom-1 -right-2 bg-black text-white text-[12px] px-3 py-1 rounded-sm font-black border border-white/20 tracking-tighter shadow-xl\">\n                REEL\n            </div>\n        </button>\n    );\n};\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/components/reels/ReelModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'companyId' is defined but never used.","line":27,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useEffect, useState, useRef } from 'react';\nimport { X, Heart, Share2, ArrowRight } from 'lucide-react';\nimport { Reel } from '@/lib/dummyData';\nimport Link from 'next/link';\n\ninterface ReelModalProps {\n    reels: Reel[];\n    initialReelIndex?: number;\n    isOpen: boolean;\n    onClose: () => void;\n    entityName: string; // Company Name or Job Title\n    entityId: string;\n    entityType: 'company' | 'job';\n    companyId?: string; // For navigation\n}\n\nexport const ReelModal: React.FC<ReelModalProps> = ({\n    reels,\n    initialReelIndex = 0,\n    isOpen,\n    onClose,\n    entityName,\n    entityId,\n    entityType,\n    companyId\n}) => {\n    const [currentIndex, setCurrentIndex] = useState(initialReelIndex);\n    const [isLiked, setIsLiked] = useState(false);\n    const touchStartY = useRef<number | null>(null);\n\n    useEffect(() => {\n        if (isOpen) {\n            document.body.style.overflow = 'hidden';\n        } else {\n            document.body.style.overflow = 'auto';\n        }\n        return () => {\n            document.body.style.overflow = 'auto';\n        };\n    }, [isOpen]);\n\n    useEffect(() => {\n        setCurrentIndex(initialReelIndex);\n    }, [initialReelIndex]);\n\n    if (!isOpen || !reels || reels.length === 0) return null;\n\n    const currentReel = reels[currentIndex];\n\n    const handleNext = () => {\n        if (currentIndex < reels.length - 1) {\n            setCurrentIndex(prev => prev + 1);\n        }\n    };\n\n    const handlePrev = () => {\n        if (currentIndex > 0) {\n            setCurrentIndex(prev => prev - 1);\n        }\n    };\n\n    const handleTouchStart = (e: React.TouchEvent) => {\n        touchStartY.current = e.touches[0].clientY;\n    };\n\n    const handleTouchEnd = (e: React.TouchEvent) => {\n        if (touchStartY.current === null) return;\n        const diff = touchStartY.current - e.changedTouches[0].clientY;\n\n        if (Math.abs(diff) > 50) { // Threshold\n            if (diff > 0) { // Swipe Up\n                handleNext();\n            } else { // Swipe Down\n                handlePrev();\n            }\n        }\n        touchStartY.current = null;\n    };\n\n    return (\n        <div className=\"fixed inset-0 z-50 bg-black flex items-center justify-center\">\n            {/* Close Button */}\n            <button\n                onClick={onClose}\n                className=\"absolute top-4 right-4 z-50 text-white p-2 bg-black/50 rounded-full hover:bg-black/70 transition-colors\"\n            >\n                <X size={24} />\n            </button>\n\n            {/* Main Container */}\n            <div\n                className=\"relative w-full h-full md:max-w-md md:max-h-[80vh] md:rounded-2xl overflow-hidden bg-zinc-900 shadow-2xl\"\n                onTouchStart={handleTouchStart}\n                onTouchEnd={handleTouchEnd}\n            >\n                {/* Video Player */}\n                <div className=\"w-full h-full flex items-center justify-center bg-black relative\">\n                    {currentReel.type === 'file' ? (\n                        <video\n                            src={currentReel.url}\n                            className=\"w-full h-full object-cover\"\n                            autoPlay\n                            loop\n                            playsInline\n                        />\n                    ) : (\n                        <iframe\n                            src={`${currentReel.url}?autoplay=1&mute=0&controls=0&loop=1&playlist=${currentReel.url.split('embed/')[1]}`} // simplistic playlist hack for loop\n                            className=\"w-full h-full pointer-events-none\" // Disable interaction to keep swipe working? might break volume control\n                            allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"\n                            allowFullScreen\n                            style={{ pointerEvents: 'auto' }} // Re-enable for YouTube controls if needed, but might interfere with swipe\n                        />\n                    )}\n\n                    {/* Gradient Overlay */}\n                    <div className=\"absolute inset-0 bg-gradient-to-b from-black/30 via-transparent to-black/60 pointer-events-none\" />\n                </div>\n\n                {/* Right Side Actions */}\n                <div className=\"absolute bottom-20 right-4 flex flex-col gap-6 items-center z-10\">\n                    <button\n                        onClick={() => setIsLiked(!isLiked)}\n                        className=\"flex flex-col items-center gap-1 group\"\n                    >\n                        <div className={`p-3 rounded-full bg-black/40 backdrop-blur-sm transition-transform group-active:scale-95 ${isLiked ? 'text-red-500' : 'text-white'}`}>\n                            <Heart size={28} fill={isLiked ? \"currentColor\" : \"none\"} />\n                        </div>\n                        <span className=\"text-white text-xs font-bold drop-shadow-md\">\n                            {currentReel.likes + (isLiked ? 1 : 0)}\n                        </span>\n                    </button>\n\n                    <button className=\"flex flex-col items-center gap-1 group\">\n                        <div className=\"p-3 rounded-full bg-black/40 backdrop-blur-sm text-white transition-transform group-active:scale-95\">\n                            <Share2 size={24} />\n                        </div>\n                        <span className=\"text-white text-xs font-bold drop-shadow-md\">Share</span>\n                    </button>\n                </div>\n\n                {/* Bottom Info Area */}\n                <div className=\"absolute bottom-0 left-0 right-0 p-4 pb-8 z-10 text-white\">\n                    <div className=\"flex items-center gap-2 mb-2\">\n                        <h3 className=\"font-bold text-lg drop-shadow-md line-clamp-1\">{entityName}</h3>\n                        <Link\n                            href={entityType === 'company' ? `/companies/${entityId}` : `/jobs/${entityId}`}\n                            className=\"bg-white/20 backdrop-blur-md px-3 py-1 rounded-full text-xs font-bold border border-white/30 hover:bg-white/30 transition-colors flex items-center gap-1\"\n                        >\n                            詳細へ <ArrowRight size={12} />\n                        </Link>\n                    </div>\n\n                    <p className=\"text-sm font-medium mb-1 drop-shadow-md line-clamp-2\">\n                        {currentReel.title}\n                    </p>\n                    {currentReel.description && (\n                        <p className=\"text-xs text-slate-200 drop-shadow-md line-clamp-2 opacity-90\">\n                            {currentReel.description}\n                        </p>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n};\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/context/AuthContext.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/context/AuthContext.tsx:23:13\n  21 |         const savedRole = localStorage.getItem('ehime-base-debug-role') as UserRole;\n  22 |         if (savedRole) {\n> 23 |             setRoleState(savedRole);\n     |             ^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  24 |         }\n  25 |         setIsLoading(false);\n  26 |     }, []);","line":23,"column":13,"nodeType":null,"endLine":23,"endColumn":25}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { createContext, useContext, useState, useEffect } from 'react';\n\ntype UserRole = 'seeker' | 'company';\n\ninterface AuthContextType {\n    role: UserRole;\n    setRole: (role: UserRole) => void;\n    isLoading: boolean;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport function AuthProvider({ children }: { children: React.ReactNode }) {\n    const [role, setRoleState] = useState<UserRole>('seeker');\n    const [isLoading, setIsLoading] = useState(true);\n\n    // 初回読み込み時にlocalStorageから取得\n    useEffect(() => {\n        const savedRole = localStorage.getItem('ehime-base-debug-role') as UserRole;\n        if (savedRole) {\n            setRoleState(savedRole);\n        }\n        setIsLoading(false);\n    }, []);\n\n    const setRole = (newRole: UserRole) => {\n        setRoleState(newRole);\n        localStorage.setItem('ehime-base-debug-role', newRole);\n    };\n\n    return (\n        <AuthContext.Provider value={{ role, setRole, isLoading }}>\n            {children}\n        </AuthContext.Provider>\n    );\n}\n\nexport function useAuth() {\n    const context = useContext(AuthContext);\n    if (context === undefined) {\n        throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/lib/appStore.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":69,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1782,1785],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1782,1785],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":116,"column":93,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":116,"endColumn":96,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3154,3157],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3154,3157],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { create } from 'zustand';\nimport { persist } from 'zustand/middleware';\nimport { Company, Job, COMPANIES, JOBS } from './dummyData';\nimport { Course } from './dummyData';\nimport { UserAnalysis } from './recommendation';\nimport { LifePlanInput } from './money-simulation/types';\nimport { useGameStore } from './gameStore';\nimport { toast } from 'sonner';\n\n// --- Types ---\n\nexport interface User {\n    id: string;\n    name: string;\n    age: number;\n    university?: string;\n    faculty?: string;\n    bio: string;\n    tags: string[];\n    image: string;\n    isOnline: boolean;\n    // New fields\n    department?: string;\n    graduationYear?: string;\n    workHistory?: { company: string, role: string, duration: string, description: string }[];\n    qualifications?: string[];\n    skills?: { name: string, level: 'beginner' | 'intermediate' | 'advanced' }[];\n    portfolioUrl?: string;\n    desiredConditions?: {\n        salary?: string;\n        location?: string[];\n        industry?: string[];\n        employmentType?: string[];\n    };\n    birthDate?: string;\n}\n\nexport interface Attachment {\n    id: string;\n    type: 'image' | 'file';\n    url: string;\n    name: string;\n    size?: string;\n}\n\nexport interface Message {\n    id: string;\n    senderId: string; // 'u_yuji' or 'c_eis' etc.\n    text: string;\n    timestamp: number;\n    isRead: boolean;\n    attachment?: Attachment;\n    replyToId?: string;\n}\n\nexport interface ChatThread {\n    id: string;\n    companyId: string;\n    userId: string;\n    messages: Message[];\n    updatedAt: number;\n}\n\nexport interface Interaction {\n    type: 'like_company' | 'like_job' | 'like_user' | 'apply' | 'scout';\n    fromId: string; // userId or companyId\n    toId: string; // companyId, jobId, or userId\n    timestamp: number;\n    metadata?: any; // e.g., scout message\n}\n\nexport interface ChatSettings {\n    ownerId: string; // userId or companyId\n    chatId: string;\n    isPinned: boolean;\n    isBlocked: boolean;\n    isUnreadManual: boolean;\n    priority: 'high' | 'medium' | 'low' | null;\n    memo: string;\n    alias: string;\n}\n\ninterface AppState {\n    // Current Session Mode\n    authStatus: 'guest' | 'authenticated';\n    activeRole: 'seeker' | 'company' | 'admin';\n    currentUserId: string;\n    currentCompanyId: string;\n\n    // Data Registry\n    users: User[];\n    companies: Company[];\n    jobs: Job[];\n    courses: Course[];\n\n    // Self-Analysis results\n    userAnalysis: UserAnalysis;\n    chats: ChatThread[];\n    interactions: Interaction[];\n    chatSettings: ChatSettings[];\n    completedLessonIds: string[];\n    lastViewedLessonIds: string[];\n\n    // Chat Preferences\n    chatSortBy: 'date' | 'priority';\n    chatFilterPriority: ('high' | 'medium' | 'low')[];\n    isCompactMode: boolean;\n    isLessonSidebarOpen: boolean;\n    lastMoneySimulationInput: LifePlanInput | null;\n\n    // Actions\n    loginAs: (role: 'seeker' | 'company' | 'admin') => void;\n    logout: () => void;\n    switchRole: (role: 'seeker' | 'company' | 'admin') => void;\n    updateUser: (userId: string, updates: Partial<User>) => void;\n    toggleInteraction: (type: Interaction['type'], fromId: string, toId: string, metadata?: any) => void;\n\n    // Chat Actions\n    sendMessage: (threadId: string, senderId: string, text: string, attachment?: Attachment, replyToId?: string) => void;\n    deleteMessage: (threadId: string, messageId: string) => void;\n    createChat: (companyId: string, userId: string, initialMessage?: string) => string; // returns threadId\n    markAsRead: (threadId: string, readerId: string) => void;\n\n    // Interaction Actions\n    addInteraction: (interaction: Omit<Interaction, 'timestamp'>) => void;\n    removeInteraction: (type: Interaction['type'], fromId: string, toId: string) => void;\n\n    // Settings Actions\n    updateChatSettings: (ownerId: string, chatId: string, settings: Partial<ChatSettings>) => void;\n\n    // Chat Preference Actions\n    setChatSortBy: (sortBy: 'date' | 'priority') => void;\n    toggleChatFilterPriority: (priority: 'high' | 'medium' | 'low') => void;\n    setCompactMode: (isCompact: boolean) => void;\n    setLessonSidebarOpen: (isOpen: boolean) => void;\n\n    // e-Learning Actions\n    completeLesson: (lessonId: string) => void;\n    updateLastViewedLesson: (lessonId: string) => void;\n    fetchCourses: () => Promise<void>;\n    addCourses: (newCourses: Partial<Course>[]) => Promise<void>;\n\n    // Analysis Actions\n    setAnalysisResults: (results: Partial<UserAnalysis>) => void;\n    setMoneySimulationInput: (input: LifePlanInput) => void;\n    getChat: (threadId: string) => ChatThread | undefined;\n    getUserChats: (userId: string) => ChatThread[];\n    getCompanyChats: (companyId: string) => ChatThread[];\n    hasInteraction: (type: Interaction['type'], fromId: string, toId: string) => boolean;\n    getChatSettingsHelper: (ownerId: string, chatId: string) => ChatSettings | undefined;\n    isLessonCompleted: (lessonId: string) => boolean;\n    getLastViewedLesson: () => string | undefined;\n}\n\n// --- Initial Data ---\nconst INITIAL_USERS: User[] = [\n    {\n        id: 'u_yuji',\n        name: '西村 裕二',\n        age: 29,\n        university: '愛媛大学',\n        faculty: '法文学部（既卒）',\n        bio: '「愛媛を面白くする」ために活動中。営業、企画、コミュニティ運営など幅広く経験。次はIT×教育の領域で、若者の可能性を広げる事業に挑戦したいと考えています。',\n        tags: ['事業開発', 'コミュニティマネジメント', '営業'],\n        image: 'https://images.unsplash.com/photo-1599566150163-29194dcaad36?q=80&w=200&auto=format&fit=crop',\n        isOnline: true,\n        birthDate: '1995-05-15'\n    },\n    {\n        id: 'u_hanako',\n        name: '松山 花子',\n        age: 24,\n        university: '東京の某IT企業',\n        faculty: '営業部',\n        bio: '東京でSaaS営業を経験。愛媛へのUターンを検討中。',\n        tags: ['法人営業', 'SaaS', 'カスタマーサクセス'],\n        image: 'https://images.unsplash.com/photo-1494790108377-be9c29b29330?q=80&w=200&auto=format&fit=crop',\n        isOnline: false,\n    },\n    {\n        id: 'u4',\n        name: '田中 健太',\n        age: 21,\n        university: '愛媛大学',\n        faculty: '法文学部',\n        bio: '【Uターン希望】東京のベンチャー企業での長期インターン経験あり。地元愛媛の企業で、営業としてバリバリ働きたいです。フットワークの軽さには自信があります！',\n        tags: ['営業志望', 'Uターン', '体育会系'],\n        image: 'https://images.unsplash.com/photo-1599566150163-29194dcaad36?auto=format&fit=crop&q=80&w=200',\n        isOnline: false,\n    },\n    {\n        id: 'u5',\n        name: '鈴木 明日香',\n        age: 22,\n        university: '松山大学',\n        faculty: '経営学部',\n        bio: 'デザイン思考を用いた課題解決に興味があります。サークルでは広報を担当し、SNS運用でフォロワーを2000人増やしました。クリエイティブな仕事に挑戦したいです。',\n        tags: ['デザイン', 'SNS運用', '広報'],\n        image: 'https://images.unsplash.com/photo-1494790108377-be9c29b29330?auto=format&fit=crop&q=80&w=200',\n        isOnline: true,\n    },\n    {\n        id: 'u6',\n        name: '佐藤 翔太',\n        age: 23,\n        university: '愛媛大学',\n        faculty: '工学部 情報工学科',\n        bio: 'AI・機械学習を研究中。Python/TensolFlow触れます。地元の製造業のDX化に技術で貢献したいと考えています。ハッカソン優勝経験あり。',\n        tags: ['エンジニア', 'Python', 'AI'],\n        image: 'https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?auto=format&fit=crop&q=80&w=200',\n        isOnline: false,\n    },\n    {\n        id: 'u7',\n        name: '高橋 美咲',\n        age: 21,\n        university: '聖カタリナ大学',\n        faculty: '人間健康福祉学部',\n        bio: '人と話すことが大好きで、接客アルバイトを3年間続けています。福祉業界だけでなく、サービス業全般に興味があります。明るさと笑顔は誰にも負けません！',\n        tags: ['接客', 'コミュニケーション', '福祉'],\n        image: 'https://images.unsplash.com/photo-1438761681033-6461ffad8d80?auto=format&fit=crop&q=80&w=200',\n        isOnline: true,\n    },\n    {\n        id: 'u8',\n        name: '伊藤 拓也',\n        age: 20,\n        university: '愛媛大学',\n        faculty: '社会共創学部',\n        bio: '地域活性化ボランティアに参加し、多世代の方と協働する楽しさを知りました。まだやりたいことは明確ではありませんが、色々な企業の話を聞いてみたいです。',\n        tags: ['地域活性化', 'ボランティア', '好奇心旺盛'],\n        image: 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?auto=format&fit=crop&q=80&w=200',\n        isOnline: false,\n    },\n    {\n        id: 'u9',\n        name: '渡辺 結衣',\n        age: 22,\n        university: '松山東雲女子大学',\n        faculty: '人文科学部',\n        bio: '英語の教員免許取得見込みです。教育業界だけでなく、グローバルに展開する愛媛の企業で、語学力を活かした仕事がしたいです。',\n        tags: ['英語', 'グローバル', '教職'],\n        image: 'https://images.unsplash.com/photo-1517841905240-472988babdf9?auto=format&fit=crop&q=80&w=200',\n        isOnline: false,\n    }\n];\n\n\nexport const useAppStore = create<AppState>()(\n    persist(\n        (set, get) => ({\n            authStatus: 'guest',\n            activeRole: 'seeker',\n            currentUserId: 'u_yuji',\n            currentCompanyId: 'c_eis',\n\n            users: INITIAL_USERS,\n            companies: COMPANIES,\n            jobs: JOBS,\n            courses: [], // Will be fetched via API\n\n            userAnalysis: {},\n\n            chats: [],\n            interactions: [],\n            chatSettings: [],\n\n            // Chat Preferences Defaults\n            chatSortBy: 'date',\n            chatFilterPriority: ['high', 'medium', 'low'],\n            isCompactMode: false,\n            completedLessonIds: [],\n            lastViewedLessonIds: [],\n            isLessonSidebarOpen: true,\n            lastMoneySimulationInput: null,\n\n            setChatSortBy: (sortBy) => set({ chatSortBy: sortBy }),\n            toggleChatFilterPriority: (priority) => set((state) => {\n                const current = state.chatFilterPriority;\n                if (current.includes(priority)) {\n                    return { chatFilterPriority: current.filter(p => p !== priority) };\n                } else {\n                    return { chatFilterPriority: [...current, priority] };\n                }\n            }),\n            setCompactMode: (isCompact) => set({ isCompactMode: isCompact }),\n            setLessonSidebarOpen: (isOpen) => set({ isLessonSidebarOpen: isOpen }),\n\n            // User Actions\n            loginAs: (role) => set({\n                authStatus: 'authenticated',\n                activeRole: role,\n                // Ensure correct ID is set when logging in (simple mock logic)\n                currentUserId: role === 'admin' ? 'u_admin' : 'u_yuji',\n                currentCompanyId: 'c_eis',\n            }),\n            logout: () => set({\n                authStatus: 'guest',\n                currentUserId: '',\n                currentCompanyId: ''\n            }),\n\n            updateUser: (userId: string, updates: Partial<User>) => {\n                set((state) => ({\n                    users: state.users.map((u) => (u.id === userId ? { ...u, ...updates } : u)),\n                }));\n            },\n            switchRole: (role) => set({ activeRole: role }),\n\n            // Generic Interaction\n            toggleInteraction: (type, fromId, toId, metadata) => {\n                set((state) => {\n                    const exists = state.interactions.find(\n                        i => i.type === type && i.fromId === fromId && i.toId === toId\n                    );\n                    if (exists) {\n                        return { interactions: state.interactions.filter(i => i !== exists) };\n                    }\n                    const newInteraction: Interaction = {\n                        type, fromId, toId, metadata, timestamp: Date.now()\n                    };\n                    return { interactions: [...state.interactions, newInteraction] };\n                });\n            },\n\n            sendMessage: (threadId, senderId, text, attachment, replyToId) => set((state) => ({\n                chats: state.chats.map(chat => {\n                    if (chat.id !== threadId) return chat;\n                    return {\n                        ...chat,\n                        messages: [...chat.messages, {\n                            id: `msg_${Date.now()} `,\n                            senderId,\n                            text,\n                            timestamp: Date.now(),\n                            isRead: false,\n                            attachment,\n                            replyToId\n                        }],\n                        updatedAt: Date.now()\n                    };\n                })\n            })),\n\n            deleteMessage: (threadId, messageId) => set((state) => ({\n                chats: state.chats.map(chat => {\n                    if (chat.id !== threadId) return chat;\n                    return {\n                        ...chat,\n                        messages: chat.messages.filter(m => m.id !== messageId),\n                        updatedAt: Date.now() // Optional: update timestamp on delete? Maybe not.\n                    };\n                })\n            })),\n\n            createChat: (companyId, userId, initialMessage) => {\n                const state = get();\n                const existing = state.chats.find(c => c.companyId === companyId && c.userId === userId);\n                if (existing) return existing.id;\n\n                const newId = `chat_${Date.now()} `;\n                const newChat: ChatThread = {\n                    id: newId,\n                    companyId,\n                    userId,\n                    messages: initialMessage ? [{\n                        id: `msg_${Date.now()} `,\n                        senderId: get().activeRole === 'company' ? companyId : userId,\n                        // simple heuristic: if created by company, sender is companyId\n                        text: initialMessage,\n                        timestamp: Date.now(),\n                        isRead: false\n                    }] : [],\n                    updatedAt: Date.now()\n                };\n\n                set(s => ({ chats: [newChat, ...s.chats] }));\n                return newId;\n            },\n\n            markAsRead: (threadId, readerId) => set(state => ({\n                chats: state.chats.map(chat => {\n                    if (chat.id !== threadId) return chat;\n                    // Mark messages NOT sent by reader as read\n                    const updatedMessages = chat.messages.map(m =>\n                        m.senderId !== readerId ? { ...m, isRead: true } : m\n                    );\n                    return { ...chat, messages: updatedMessages };\n                })\n            })),\n\n            addInteraction: (interaction) => set(state => ({\n                interactions: [...state.interactions, { ...interaction, timestamp: Date.now() }]\n            })),\n\n            removeInteraction: (type, fromId, toId) => set(state => ({\n                interactions: state.interactions.filter(i =>\n                    !(i.type === type && i.fromId === fromId && i.toId === toId)\n                )\n            })),\n\n            updateChatSettings: (ownerId, chatId, newSettings) => set(state => {\n                const existingIndex = state.chatSettings.findIndex(cs => cs.ownerId === ownerId && cs.chatId === chatId);\n                if (existingIndex > -1) {\n                    const updated = [...state.chatSettings];\n                    updated[existingIndex] = { ...updated[existingIndex], ...newSettings };\n                    return { chatSettings: updated };\n                } else {\n                    const newItem: ChatSettings = {\n                        ownerId, chatId, isPinned: false, isBlocked: false, isUnreadManual: false, priority: 'medium', memo: '', alias: '', ...newSettings\n                    };\n                    return { chatSettings: [...state.chatSettings, newItem] };\n                }\n            }),\n\n            completeLesson: (lessonId) => {\n                set(state => ({\n                    completedLessonIds: state.completedLessonIds.includes(lessonId)\n                        ? state.completedLessonIds\n                        : [...state.completedLessonIds, lessonId]\n                }));\n\n                // Bridge to Game: Grant rewards if game is initialized\n                const gameStore = useGameStore.getState();\n                if (gameStore.isInitialized) {\n                    gameStore.addExperience(50);\n                    gameStore.updateStats({ skill: useGameStore.getState().stats.skill + 2 });\n                    toast.success('e-ラーニング完了報酬！ゲームの経験値+50、技術+2を獲得しました。', {\n                        icon: '🏆',\n                        duration: 5000\n                    });\n                }\n            },\n\n            updateLastViewedLesson: (lessonId) => set(state => ({\n                lastViewedLessonIds: [lessonId, ...state.lastViewedLessonIds.filter(id => id !== lessonId)].slice(0, 10)\n            })),\n\n            fetchCourses: async () => {\n                try {\n                    const response = await fetch('/api/elearning');\n                    const data = await response.json();\n                    set({ courses: data });\n                } catch (error) {\n                    console.error('Failed to fetch courses:', error);\n                }\n            },\n\n            addCourses: async (newCourses) => {\n                try {\n                    const response = await fetch('/api/elearning', {\n                        method: 'POST',\n                        headers: { 'Content-Type': 'application/json' },\n                        body: JSON.stringify(newCourses)\n                    });\n                    const result = await response.json();\n                    if (result.success) {\n                        // Refresh courses after adding\n                        get().fetchCourses();\n                    }\n                } catch (error) {\n                    console.error('Failed to add courses:', error);\n                }\n            },\n\n            getChat: (threadId) => get().chats.find(c => c.id === threadId),\n            getUserChats: (userId) => get().chats.filter(c => c.userId === userId).sort((a, b) => b.updatedAt - a.updatedAt),\n            getCompanyChats: (companyId) => get().chats.filter(c => c.companyId === companyId).sort((a, b) => b.updatedAt - a.updatedAt),\n\n            setAnalysisResults: (results) => set(state => ({\n                userAnalysis: { ...state.userAnalysis, ...results }\n            })),\n            setMoneySimulationInput: (input) => set({ lastMoneySimulationInput: input }),\n            hasInteraction: (type, fromId, toId) => get().interactions.some(i =>\n                i.type === type && i.fromId === fromId && i.toId === toId\n            ),\n            getChatSettingsHelper: (ownerId, chatId) => get().chatSettings.find(cs => cs.ownerId === ownerId && cs.chatId === chatId),\n            isLessonCompleted: (lessonId) => get().completedLessonIds.includes(lessonId),\n            getLastViewedLesson: () => get().lastViewedLessonIds[0],\n        }),\n        {\n            name: 'eis-app-store-v3',\n        }\n    )\n);\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/lib/courseData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/lib/dummyData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/lib/fortune.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/lib/gameScenarios.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[326,329],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[326,329],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[371,374],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[371,374],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'state' is defined but never used.","line":99,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":99,"endColumn":50},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'state' is defined but never used.","line":100,"column":50,"nodeType":"Identifier","messageId":"unusedVar","endLine":100,"endColumn":55}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export interface ScenarioStep {\n    bg?: string;\n    chara?: {\n        name: string;\n        image: string;\n        side: 'left' | 'right' | 'center';\n    }[];\n    speaker?: string;\n    text: string;\n    choices?: {\n        text: string;\n        targetIndex?: number;\n        targetScenario?: string;\n        action?: (state: any) => void;\n    }[];\n    onEnter?: (state: any) => void;\n}\n\nexport const SCENARIOS: Record<string, ScenarioStep[]> = {\n    intro: [\n        {\n            bg: '/game/bg/campus.png',\n            text: '桜が舞う、4月のキャンパス。'\n        },\n        {\n            text: '今日から僕は大学3年生だ。'\n        },\n        {\n            text: '……その前に、僕の性別は……',\n            choices: [\n                {\n                    text: '男性',\n                    action: (state) => {\n                        state.setPlayerGender('male');\n                        state.updateStats({ charm: 20 });\n                    }\n                },\n                {\n                    text: '女性',\n                    action: (state) => {\n                        state.setPlayerGender('female');\n                        state.updateStats({ charm: 25 });\n                    }\n                }\n            ]\n        },\n        {\n            chara: [{ name: 'mc', image: 'male.png', side: 'left' }],\n            speaker: '??',\n            text: '「はぁ……就活かぁ……」'\n        },\n        {\n            text: '「愛媛で働きたいとは思ってるけど、どんな企業があるのか全然知らないし……」'\n        },\n        {\n            text: '「何から始めればいいんだろう……」'\n        },\n        {\n            chara: [\n                { name: 'mc', image: 'male.png', side: 'left' },\n                { name: 'mikan', image: 'normal.png', side: 'right' }\n            ],\n            speaker: '？？？',\n            text: '「お困りのようだね、後輩くん！」'\n        },\n        {\n            speaker: '??',\n            text: '「えっ、誰！？」'\n        },\n        {\n            speaker: 'みかん先輩',\n            text: '「ふふふ、私はみかん先輩。この大学の4年生だよ。」'\n        },\n        {\n            text: '「愛媛での就活を勝ち抜いた、いわば就活マスターさ！」'\n        },\n        {\n            speaker: '??',\n            text: '「し、就活マスター……？」'\n        },\n        {\n            speaker: 'みかん先輩',\n            text: '「君、愛媛で就職したいんでしょ？でも何をしていいかわからない顔をしてる。」'\n        },\n        {\n            text: '「そんな君のために、私が愛媛の企業や就活のノウハウを教えてあげる！」'\n        },\n        {\n            text: '「名付けて、『愛媛就活RPG』の始まりだよ！」'\n        },\n        {\n            speaker: '??',\n            text: '「RPG……？（なんか変な先輩に絡まれたな……）」'\n        },\n        {\n            speaker: 'みかん先輩',\n            text: '「さあ、準備はいい？まずは就活の基本からレクチャーするよ！」',\n            choices: [\n                { text: 'お願いします！', action: (state) => { } },\n                { text: 'ちょっと心の準備が...', action: (state) => { } }\n            ]\n        },\n        {\n            text: '「いい返事だ！その意気があれば大丈夫。」'\n        },\n        {\n            text: '「それじゃあ、まずはこの大学のキャリアセンターに行ってみよう！」'\n        },\n        {\n            text: '「そこには愛媛の企業情報がたくさん集まっているんだ。」'\n        },\n        {\n            speaker: '??',\n            text: 'こうして、僕の愛媛での就活……もとい、愛媛就活RPGが幕を開けたのだった。',\n            onEnter: (state) => {\n                state.setGameMode('strategy');\n            }\n        }\n    ]\n};\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/lib/gameStore.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'get' is defined but never used.","line":74,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":74,"endColumn":18}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { create } from 'zustand';\nimport { persist } from 'zustand/middleware';\n\nexport interface GameStats {\n    knowledge: number;\n    patience: number;\n    adaptability: number;\n    charm: number;\n    skill: number;\n    stamina: number;\n    maxStamina: number;\n    stress: number;\n    maxStress: number;\n    money: number;\n    experience: number;\n    level: number;\n}\n\nexport interface GameCalendar {\n    year: number;\n    month: number;\n    week: number;\n}\n\nexport type GameMode = 'strategy' | 'novel' | 'quiz' | 'action' | 'action_menu';\n\ninterface GameState {\n    stats: GameStats;\n    calendar: GameCalendar;\n    playerName: string;\n    isInitialized: boolean;\n    gameMode: GameMode;\n    currentActionType: string | null;\n    currentScenarioId: string | null;\n    scenarioIndex: number;\n    playerGender: 'male' | 'female';\n\n    // Actions\n    initGame: (name: string) => void;\n    updateStats: (updates: Partial<GameStats>) => void;\n    advanceWeek: () => void;\n    resetGame: () => void;\n    addExperience: (exp: number) => void;\n    setGameMode: (mode: GameMode) => void;\n    setActionType: (type: string | null) => void;\n    startScenario: (scenarioId: string) => void;\n    setScenarioIndex: (index: number) => void;\n    setPlayerGender: (gender: 'male' | 'female') => void;\n}\n\nconst INITIAL_STATS: GameStats = {\n    knowledge: 20,\n    patience: 20,\n    adaptability: 20,\n    charm: 20,\n    skill: 20,\n    stamina: 100,\n    maxStamina: 100,\n    stress: 0,\n    maxStress: 100,\n    money: 10000,\n    experience: 0,\n    level: 1\n};\n\nconst INITIAL_CALENDAR: GameCalendar = {\n    year: 3,\n    month: 4,\n    week: 1\n};\n\nexport const useGameStore = create<GameState>()(\n    persist(\n        (set, get) => ({\n            stats: INITIAL_STATS,\n            calendar: INITIAL_CALENDAR,\n            playerName: 'まさる',\n            isInitialized: false,\n            gameMode: 'strategy',\n            currentActionType: null,\n            currentScenarioId: null,\n            scenarioIndex: 0,\n            playerGender: 'male',\n\n            initGame: (name) => set({\n                playerName: name,\n                isInitialized: true,\n                stats: INITIAL_STATS,\n                calendar: INITIAL_CALENDAR,\n                gameMode: 'novel',\n                currentActionType: null,\n                currentScenarioId: 'intro',\n                scenarioIndex: 0,\n                playerGender: 'male'\n            }),\n\n            updateStats: (updates) => set((state) => {\n                const newStats = { ...state.stats, ...updates };\n\n                // Clamp values\n                newStats.stamina = Math.min(newStats.maxStamina, Math.max(0, newStats.stamina));\n                newStats.stress = Math.min(newStats.maxStress, Math.max(0, newStats.stress));\n\n                return { stats: newStats };\n            }),\n\n            addExperience: (exp) => set((state) => {\n                let newExp = state.stats.experience + exp;\n                let newLevel = state.stats.level;\n\n                // Simple level up logic: level * 100 exp needed\n                while (newExp >= newLevel * 100) {\n                    newExp -= newLevel * 100;\n                    newLevel++;\n                }\n\n                return {\n                    stats: {\n                        ...state.stats,\n                        experience: newExp,\n                        level: newLevel\n                    }\n                };\n            }),\n\n            advanceWeek: () => set((state) => {\n                let { year, month, week } = state.calendar;\n                week++;\n                if (week > 4) {\n                    week = 1;\n                    month++;\n                    if (month > 12) {\n                        month = 1;\n                        year++;\n                    }\n                }\n\n                return { calendar: { year, month, week } };\n            }),\n\n            setGameMode: (gameMode) => set({ gameMode }),\n\n            setActionType: (currentActionType) => set({ currentActionType }),\n\n            startScenario: (scenarioId) => set({\n                currentScenarioId: scenarioId,\n                scenarioIndex: 0,\n                gameMode: 'novel'\n            }),\n\n            setScenarioIndex: (scenarioIndex) => set({ scenarioIndex }),\n\n            setPlayerGender: (playerGender) => set({ playerGender }),\n\n            resetGame: () => set({\n                stats: INITIAL_STATS,\n                calendar: INITIAL_CALENDAR,\n                isInitialized: false,\n                gameMode: 'strategy',\n                currentActionType: null,\n                currentScenarioId: null,\n                scenarioIndex: 0,\n                playerGender: 'male'\n            })\n        }),\n        {\n            name: 'ehime-base-game-store',\n        }\n    )\n);\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/lib/learningData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/lib/money-simulation/calculations.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/lib/money-simulation/constants.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'EducationLevel' is defined but never used.","line":1,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":24,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"EducationLevel"},"fix":{"range":[0,41],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { EducationLevel } from \"./types\";\n\n// Source: MEXT (Ministry of Education, Culture, Sports, Science and Technology) 2021 Survey\n// Annual costs in JPY\nexport const EDUCATION_COSTS = {\n    kindergarten: {\n        public: 165000,\n        private: 309000\n    },\n    elementary: {\n        public: 353000,\n        private: 1667000\n    },\n    juniorHigh: {\n        public: 539000,\n        private: 1436000\n    },\n    highSchool: {\n        public: 513000,\n        private: 1054000\n    },\n    university: { // First year often higher, but averaging for simplicity or separating entrance fees could be better.\n        // Approx annual tuition + facilities. \n        national_arts: 820000,\n        national_science: 820000,\n        private_arts: 1180000,\n        private_science: 1550000\n    }\n};\n\nexport const DEFAULT_PENSION = {\n    employee: 120000 * 12, // Reduced from 145000 (Conservative estimate)\n    self_employed: 55000 * 12, // Reduced from 65000\n    dependent: 55000 * 12, // Reduced from 65000\n    none: 0\n};\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/lib/money-simulation/simulation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/lib/money-simulation/types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/lib/recommendation.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'companies' is defined but never used.","line":20,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Course, Job, Company } from './dummyData';\n\nexport interface UserAnalysis {\n    strengths?: Record<string, number>;\n    fortune?: {\n        dayMaster: string;\n        traits: string[];\n    };\n}\n\nexport interface RecommendationResult {\n    jobs: Job[];\n    courses: Course[];\n}\n\nexport const getRecommendations = (\n    analysis: UserAnalysis,\n    jobs: Job[],\n    courses: Course[],\n    companies: Company[]\n): RecommendationResult => {\n    if (!analysis.strengths && !analysis.fortune) {\n        return { jobs: [], courses: [] };\n    }\n\n    // Logic for Strengths-based matching\n    const topStrengths = analysis.strengths\n        ? Object.entries(analysis.strengths)\n            .sort(([, a], [, b]) => b - a)\n            .map(([key]) => key)\n        : [];\n\n    const matchedJobs = jobs.filter(job => {\n        // Simple logic: mapping categories to job types\n        if (topStrengths.includes('executing')) {\n            return job.type === 'job' || job.title.includes('エンジニア');\n        }\n        if (topStrengths.includes('relationship')) {\n            return job.type === 'quest' || job.title.includes('営業') || job.title.includes('広報');\n        }\n        if (topStrengths.includes('strategic')) {\n            return job.title.includes('企画') || job.title.includes('マーケティング');\n        }\n        if (topStrengths.includes('influencing')) {\n            return job.title.includes('リーダー') || job.title.includes('マネージャー');\n        }\n        return false;\n    }).slice(0, 3);\n\n    const matchedCourses = courses.filter(course => {\n        if (topStrengths.includes('strategic')) {\n            return course.category === 'ビジネス' || course.category === 'IT技能';\n        }\n        if (topStrengths.includes('executing')) {\n            return course.category === 'IT技能' || course.level === '中級';\n        }\n        return true;\n    }).slice(0, 3);\n\n    // Logic for Fortune-based matching (Day Master)\n    if (analysis.fortune) {\n        const dm = analysis.fortune.dayMaster;\n\n        // 木 (甲, 乙) -> 成長、教育、企画\n        if (dm.includes('甲') || dm.includes('乙')) {\n            matchedJobs.push(...jobs.filter(j => j.title.includes('教育') || j.title.includes('企画') || j.category === '新卒').slice(0, 2));\n            matchedCourses.push(...courses.filter(c => c.category === 'ビジネス' || c.category === '資格').slice(0, 1));\n        }\n        // 火 (丙, 丁) -> 営業、広報、クリエイティブ\n        else if (dm.includes('丙') || dm.includes('丁')) {\n            matchedJobs.push(...jobs.filter(j => j.title.includes('営業') || j.title.includes('広報') || j.id === 'j5').slice(0, 2));\n            matchedCourses.push(...courses.filter(c => c.category === 'デザイン').slice(0, 1));\n        }\n        // 土 (戊, 己) -> 管理、不動産、福祉\n        else if (dm.includes('戊') || dm.includes('己')) {\n            matchedJobs.push(...jobs.filter(j => j.title.includes('介護') || j.title.includes('管理') || j.location === '西条市').slice(0, 2));\n            matchedCourses.push(...courses.filter(c => c.category === '一般教養').slice(0, 1));\n        }\n        // 金 (庚, 辛) -> 製造、金融、技術\n        else if (dm.includes('庚') || dm.includes('辛')) {\n            matchedJobs.push(...jobs.filter(j => j.title.includes('メンテナンス') || j.title.includes('エンジニア') || j.id === 'j6').slice(0, 2));\n            matchedCourses.push(...courses.filter(c => c.category === 'IT技能').slice(0, 1));\n        }\n        // 水 (壬, 癸) -> 企画、海外、物流\n        else if (dm.includes('壬') || dm.includes('癸')) {\n            matchedJobs.push(...jobs.filter(j => j.title.includes('物流') || j.title.includes('DX') || j.title.includes('店長')).slice(0, 2));\n            matchedCourses.push(...courses.filter(c => c.category === 'ビジネス').slice(0, 1));\n        }\n    }\n\n    // De-duplicate and slice\n    const uniqueJobs = Array.from(new Set(matchedJobs)).slice(0, 4);\n    const uniqueCourses = Array.from(new Set(matchedCourses)).slice(0, 4);\n\n    return {\n        jobs: uniqueJobs.length > 0 ? uniqueJobs : jobs.slice(0, 2),\n        courses: uniqueCourses.length > 0 ? uniqueCourses : courses.slice(0, 2)\n    };\n};\n","usedDeprecatedRules":[]},{"filePath":"/Users/yuyu24/2ndBrain/Ehime Base app/ehime-base-app/src/lib/store.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
